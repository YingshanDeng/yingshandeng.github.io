<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Deng&#39;s Blog</title>
  <subtitle>Work Smart, Enjoy Life!</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://objcer.com/"/>
  <updated>2017-08-14T11:41:13.000Z</updated>
  <id>http://objcer.com/</id>
  
  <author>
    <name>å°é‚“</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Javascript DOM äº‹ä»¶æ¨¡å‹</title>
    <link href="http://objcer.com/2017/08/14/Introduction-into-Events/"/>
    <id>http://objcer.com/2017/08/14/Introduction-into-Events/</id>
    <published>2017-08-14T11:39:01.000Z</published>
    <updated>2017-08-14T11:41:13.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/js-event.jpg" alt=""><br><a id="more"></a></p>
<h2 id="Bubbling-and-capturing"><a href="#Bubbling-and-capturing" class="headerlink" title="Bubbling and capturing"></a>Bubbling and capturing</h2><p>Javascript DOM äº‹ä»¶æµå­˜åœ¨å¦‚ä¸‹ä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>äº‹ä»¶æ•è·é˜¶æ®µ Capturing phase â€“ <strong>the event goes down to the element.</strong></li>
<li>å¤„äºç›®æ ‡é˜¶æ®µ Target phase â€“ the event reached the target element.</li>
<li>äº‹ä»¶å†’æ³¡é˜¶æ®µ Bubbling phase â€“ <strong>the event bubbles up from the element.</strong></li>
</ul>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/eventflow@2x.png" alt=""></p>
<p><strong>Javascript DOM æ ‡å‡†äº‹ä»¶æµçš„è§¦å‘çš„å…ˆåé¡ºåºä¸ºï¼šå…ˆæ•è·å†å†’æ³¡ã€‚</strong>ç‚¹å‡» <code>&lt;td&gt;</code> DOM èŠ‚ç‚¹æ—¶ï¼Œäº‹ä»¶ä¼ æ’­é¡ºåºï¼šé¦–å…ˆæ˜¯äº‹ä»¶æ•è·é˜¶æ®µï¼Œä»ä¸Šå‘ä¸‹ä¼ æ’­ï¼›ç„¶ååˆ°è¾¾ç‚¹å‡»äº‹ä»¶ç›®æ ‡èŠ‚ç‚¹ï¼›æœ€åæ˜¯å†’æ³¡é˜¶æ®µï¼Œä»ä¸‹å‘ä¸Šä¼ æ’­ã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">addEventListener(<span class="string">type:</span> DOMString, <span class="string">callback:</span> EventListener, capture?: <span class="keyword">boolean</span>)</div></pre></td></tr></table></figure>
<p>DOM èŠ‚ç‚¹æ·»åŠ äº‹ä»¶ç›‘å¬æ–¹æ³• <code>addEventListener</code> ä¸­ç¬¬ä¸‰ä¸ªå‚æ•°å¯ä»¥æŒ‡å®šæ˜¯è¯¥ç›‘å¬æ˜¯æ·»åŠ åœ¨äº‹ä»¶æ•è·é˜¶æ®µæˆ–è€…æ˜¯äº‹ä»¶å†’æ³¡é˜¶æ®µï¼Œé»˜è®¤ä¸º <code>false</code>ï¼Œå³äº‹ä»¶å†’æ³¡é˜¶æ®µï¼›æ˜¾å¼æŒ‡å®šä¸º <code>true</code>ï¼Œå³äº‹ä»¶æ•è·é˜¶æ®µã€‚</p>
<p>å®é™…åº”ç”¨ä¸­ï¼Œä¸º DOM å…ƒç´ æ·»åŠ äº‹ä»¶ç›‘å¬ç»å¤§å¤šæ•°éƒ½æ˜¯æ·»åŠ åˆ°äº‹ä»¶å†’æ³¡é˜¶æ®µï¼Œå¾ˆå°‘ä¼šç”¨åˆ°äº‹ä»¶æ•è·ã€‚æˆ‘ä»¬é€šè¿‡ <code>on&lt;event&gt;-property</code> HTML å±æ€§æ·»åŠ çš„äº‹ä»¶ç›‘å¬é»˜è®¤ä¹Ÿæ˜¯æ·»åŠ åˆ°äº‹ä»¶å†’æ³¡é˜¶æ®µ</p>
<p>æ³¨æ„åˆ°äº‹ä»¶æµå¤„ç†æœ‰ä¸‰ä¸ªé˜¶æ®µï¼Œå…¶ä¸­ç¬¬äºŒä¸ªé˜¶æ®µï¼šå¤„äºç›®æ ‡é˜¶æ®µï¼Œå¹¶ä¸å•ç‹¬å¤„ç†ï¼Œäº‹ä»¶æ•è·é˜¶æ®µå’Œå†’æ³¡é˜¶æ®µçš„æ·»åŠ çš„ç›‘å¬å¤„ç†å°±åŒ…å«äº†è¿™ä¸ªé˜¶æ®µã€‚</p>
<h3 id="å¹¶éæ‰€æœ‰çš„äº‹ä»¶éƒ½æ”¯æŒå†’æ³¡"><a href="#å¹¶éæ‰€æœ‰çš„äº‹ä»¶éƒ½æ”¯æŒå†’æ³¡" class="headerlink" title="å¹¶éæ‰€æœ‰çš„äº‹ä»¶éƒ½æ”¯æŒå†’æ³¡"></a>å¹¶éæ‰€æœ‰çš„äº‹ä»¶éƒ½æ”¯æŒå†’æ³¡</h3><blockquote>
<p>â— <strong>Almost</strong> all events bubble.</p>
</blockquote>
<p>æ³¨æ„å…³é”®å­— â€œalmostâ€ï¼Œæ‰€ä»¥å¹¶ä¸æ˜¯æ‰€æœ‰çš„äº‹ä»¶éƒ½æ”¯æŒå†’æ³¡ã€‚åœ¨ wiki <a href="https://en.wikipedia.org/wiki/DOM_events#Events" target="_blank" rel="external">DOM_events</a> ä¸­æˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°ä¸€äº›ä¸æ”¯æŒå†’æ³¡çš„äº‹ä»¶ï¼Œä¾‹å¦‚ <code>focus</code>ã€<code>blur</code> ç­‰ç­‰<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">a.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(event.bubbles) <span class="regexp">//</span> &gt; <span class="literal">true</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">a.addEventListener(<span class="string">'focus'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(event.bubbles) <span class="regexp">//</span> &gt; <span class="literal">false</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>event.bubbles</code> æ¥åˆ¤æ–­æ˜¯å¦æ”¯æŒäº‹ä»¶å†’æ³¡</p>
<h3 id="ä¸‰ä¸ªå¸¸ç”¨æ–¹æ³•"><a href="#ä¸‰ä¸ªå¸¸ç”¨æ–¹æ³•" class="headerlink" title="ä¸‰ä¸ªå¸¸ç”¨æ–¹æ³•"></a>ä¸‰ä¸ªå¸¸ç”¨æ–¹æ³•</h3><ul>
<li><p><code>event.stopPropagation</code> é˜»æ­¢æ•è·å’Œå†’æ³¡é˜¶æ®µä¸­å½“å‰äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­<br>åœ¨äº‹ä»¶ç›‘å¬å›è°ƒä¸­è°ƒç”¨æ­¤æ–¹æ³•ï¼Œè‹¥æ˜¯æ•è·é˜¶æ®µï¼Œåˆ™åœæ­¢å‘ä¸‹ä¼ é€’äº‹ä»¶ï¼›è‹¥æ˜¯å†’æ³¡é˜¶æ®µï¼Œåˆ™åœæ­¢å‘ä¸Šä¼ é€’äº‹ä»¶ã€‚</p>
</li>
<li><p><code>event.stopImmediatePropagation</code> é˜»æ­¢è°ƒç”¨ç›¸åŒäº‹ä»¶çš„å…¶ä»–ä¾¦å¬å™¨<br>å¦‚æœæŸä¸ªå…ƒç´ æœ‰å¤šä¸ªç›¸åŒç±»å‹äº‹ä»¶çš„äº‹ä»¶ç›‘å¬å‡½æ•°, åˆ™å½“è¯¥ç±»å‹çš„äº‹ä»¶è§¦å‘æ—¶, å¤šä¸ªäº‹ä»¶ç›‘å¬å‡½æ•°å°†æŒ‰ç…§é¡ºåºä¾æ¬¡æ‰§è¡Œ. å¦‚æœæŸä¸ªç›‘å¬å‡½æ•°æ‰§è¡Œäº† <code>event.stopImmediatePropagation()</code> æ–¹æ³•, åˆ™é™¤äº†è¯¥äº‹ä»¶çš„å†’æ³¡è¡Œä¸ºè¢«é˜»æ­¢ä¹‹å¤–(event.stopPropagationæ–¹æ³•çš„ä½œç”¨), è¯¥å…ƒç´ ç»‘å®šçš„ååºç›¸åŒç±»å‹äº‹ä»¶çš„ç›‘å¬å‡½æ•°çš„æ‰§è¡Œä¹Ÿå°†è¢«é˜»æ­¢ã€‚ä¾‹å­ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">    <span class="built_in">document</span>.querySelector(<span class="string">"p"</span>).addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span></div><div class="line">    &#123;</div><div class="line">        alert(<span class="string">"æˆ‘æ˜¯på…ƒç´ ä¸Šè¢«ç»‘å®šçš„ç¬¬ä¸€ä¸ªç›‘å¬å‡½æ•°"</span>);</div><div class="line">    &#125;, <span class="literal">false</span>);</div><div class="line">    <span class="built_in">document</span>.querySelector(<span class="string">"p"</span>).addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span></div><div class="line">    &#123;</div><div class="line">        alert(<span class="string">"æˆ‘æ˜¯på…ƒç´ ä¸Šè¢«ç»‘å®šçš„ç¬¬äºŒä¸ªç›‘å¬å‡½æ•°"</span>);</div><div class="line">        event.stopImmediatePropagation();</div><div class="line">        <span class="comment">//æ‰§è¡ŒstopImmediatePropagationæ–¹æ³•,é˜»æ­¢clickäº‹ä»¶å†’æ³¡,å¹¶ä¸”é˜»æ­¢på…ƒç´ ä¸Šç»‘å®šçš„å…¶ä»–clickäº‹ä»¶çš„äº‹ä»¶ç›‘å¬å‡½æ•°çš„æ‰§è¡Œ.</span></div><div class="line">    &#125;, <span class="literal">false</span>);</div><div class="line">    <span class="built_in">document</span>.querySelector(<span class="string">"p"</span>).addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span></div><div class="line">    &#123;</div><div class="line">        alert(<span class="string">"æˆ‘æ˜¯på…ƒç´ ä¸Šè¢«ç»‘å®šçš„ç¬¬ä¸‰ä¸ªç›‘å¬å‡½æ•°"</span>);</div><div class="line">        <span class="comment">//è¯¥ç›‘å¬å‡½æ•°æ’åœ¨ä¸Šä¸ªå‡½æ•°åé¢,è¯¥å‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œ.</span></div><div class="line">    &#125;, <span class="literal">false</span>);</div><div class="line">    <span class="built_in">document</span>.querySelector(<span class="string">"div"</span>).addEventListener(<span class="string">"click"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>)</span></div><div class="line">    &#123;</div><div class="line">        alert(<span class="string">"æˆ‘æ˜¯divå…ƒç´ ,æˆ‘æ˜¯på…ƒç´ çš„ä¸Šå±‚å…ƒç´ "</span>);</div><div class="line">        <span class="comment">//på…ƒç´ çš„clickäº‹ä»¶æ²¡æœ‰å‘ä¸Šå†’æ³¡,è¯¥å‡½æ•°ä¸ä¼šè¢«æ‰§è¡Œ.</span></div><div class="line">    &#125;, <span class="literal">false</span>);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>event.preventDefault</code> å¦‚æœäº‹ä»¶å¯å–æ¶ˆï¼Œåˆ™å–æ¶ˆè¯¥äº‹ä»¶ï¼Œè€Œä¸åœæ­¢äº‹ä»¶çš„è¿›ä¸€æ­¥ä¼ æ’­ã€‚</p>
<ul>
<li>åœ¨äº‹ä»¶è§¦å‘åçš„ä»»ä½•é˜¶æ®µè°ƒç”¨ <code>preventDefault</code> æ–¹æ³•æ¥å–æ¶ˆè¯¥äº‹ä»¶, <strong>æ„å‘³ç€è¯¥äº‹ä»¶çš„æ‰€æœ‰é»˜è®¤åŠ¨ä½œéƒ½ä¸ä¼šå‘ç”Ÿ.</strong> ä¾‹å¦‚å¯ä»¥åˆ©ç”¨ <code>preventDefault()</code> æ–¹æ³•æ¥é˜»æ­¢ä¸€ä¸ª <code>input</code> å…ƒç´ å†…éæ³•å­—ç¬¦çš„è¾“å…¥ç­‰ç­‰</li>
<li>è°ƒç”¨äº‹ä»¶çš„ <code>preventDefault()</code> æ–¹æ³•å,ä¼šå¼•èµ·è¯¥äº‹ä»¶çš„ <code>event.defaultPrevented</code> å±æ€§å€¼å˜ä¸º <code>true</code></li>
<li>å¯ä»¥æŸ¥çœ‹ <code>event.cancelable</code> å±æ€§æ¥åˆ¤æ–­ä¸€ä¸ªäº‹ä»¶çš„é»˜è®¤åŠ¨ä½œæ˜¯å¦å¯ä»¥è¢«å–æ¶ˆ. åœ¨ <code>cancelable</code> å±æ€§ä¸º <code>false</code> çš„äº‹ä»¶ä¸Šè°ƒç”¨ <code>preventDefault</code> æ–¹æ³•æ²¡æœ‰ä»»ä½•æ•ˆæœ</li>
<li><code>preventDefault</code> æ–¹æ³•<strong>ä¸ä¼šé˜»æ­¢è¯¥äº‹ä»¶çš„è¿›ä¸€æ­¥å†’æ³¡</strong>. <code>event.stopPropagation</code> æ–¹æ³•æ‰æœ‰è¿™æ ·çš„åŠŸèƒ½</li>
</ul>
</li>
</ul>
<h3 id="event-target-å’Œ-event-currentTarget"><a href="#event-target-å’Œ-event-currentTarget" class="headerlink" title="event.target å’Œ event.currentTarget"></a><code>event.target</code> å’Œ <code>event.currentTarget</code></h3><blockquote>
<p>The most deeply nested element that caused the event is called a target element, accessible as event.target.<br>Note the differences from this (=event.currentTarget):</p>
<ul>
<li>event.target â€“ is the â€œtargetâ€ element that initiated the event, it doesnâ€™t change through the bubbling process.</li>
<li>this â€“ is the â€œcurrentâ€ element, the one that has a currently running handler on it.</li>
</ul>
</blockquote>
<ul>
<li><code>event.target</code> â€“ æŒ‡å‘è§¦å‘äº‹ä»¶çš„å…ƒç´ ï¼Œåœ¨äº‹ä»¶å†’æ³¡è¿‡ç¨‹ä¸­è¯¥å€¼ä¸å˜</li>
<li><code>event.currentTarget</code> = this â€“ äº‹ä»¶ç»‘å®šçš„å½“å‰å…ƒç´ </li>
</ul>
<p>åªæœ‰è¢«ç‚¹å‡»çš„é‚£ä¸ªç›®æ ‡å…ƒç´ çš„ <code>event.target</code> æ‰ä¼šç­‰äº <code>event.currentTarget</code>ï¼Œçœ‹å¦‚ä¸‹ä¾‹å­<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer"</span>&gt;</span></div><div class="line">  outer</div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span>&gt;</span>inner<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">  <span class="keyword">var</span> outerEl = <span class="built_in">document</span>.querySelector(<span class="string">'.outer'</span>);</div><div class="line">  <span class="keyword">var</span> innerEl = <span class="built_in">document</span>.querySelector(<span class="string">'.inner'</span>);</div><div class="line"></div><div class="line">  innerEl.addEventListener(<span class="string">'click'</span>, (event) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'inner'</span>, event.target, event.currentTarget)</div><div class="line">  &#125;);</div><div class="line">  outerEl.addEventListener(<span class="string">'click'</span>, (event) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'outer'</span>, event.target, event.currentTarget)</div><div class="line">  &#125;);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>ç‚¹å‡» inner èŠ‚ç‚¹ï¼Œæ‰§è¡Œç»“æœï¼š<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">inner &lt;<span class="keyword">div</span> <span class="built_in">class</span>=â€‹<span class="string">"inner"</span>&gt;â€‹innerâ€‹&lt;/<span class="keyword">div</span>&gt;â€‹ &lt;<span class="keyword">div</span> <span class="built_in">class</span>=â€‹<span class="string">"inner"</span>&gt;â€‹innerâ€‹&lt;/<span class="keyword">div</span>&gt;â€‹</div><div class="line">outer &lt;<span class="keyword">div</span> <span class="built_in">class</span>=â€‹<span class="string">"inner"</span>&gt;â€‹innerâ€‹&lt;/<span class="keyword">div</span>&gt;â€‹ &lt;<span class="keyword">div</span> <span class="built_in">class</span>=â€‹<span class="string">"outer"</span>&gt;â€‹â€¦â€‹&lt;/<span class="keyword">div</span>&gt;â€‹</div></pre></td></tr></table></figure></p>
<h2 id="æ‰§è¡Œé¡ºåºçš„é—®é¢˜"><a href="#æ‰§è¡Œé¡ºåºçš„é—®é¢˜" class="headerlink" title="æ‰§è¡Œé¡ºåºçš„é—®é¢˜"></a>æ‰§è¡Œé¡ºåºçš„é—®é¢˜</h2><p>æˆ‘ä»¬çŸ¥é“ï¼ŒJavascript DOM æ ‡å‡†äº‹ä»¶æµçš„è§¦å‘çš„å…ˆåé¡ºåºä¸ºï¼šå…ˆæ•è·å†å†’æ³¡ã€‚å¦‚æœ DOM èŠ‚ç‚¹åŒæ—¶ç»‘å®šä¸¤ä¸ªäº‹ä»¶ç›‘å¬ï¼Œä¸€ä¸ªç”¨äºæ•è·é˜¶æ®µï¼Œä¸€ä¸ªç”¨äºå†’æ³¡é˜¶æ®µï¼Œä¸¤ä¸ªäº‹ä»¶çš„æ‰§è¡Œé¡ºåºçœŸçš„å¦‚æ­¤ä¹ˆï¼Ÿ<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"outer"</span>&gt;</div><div class="line">  element1</div><div class="line">  &lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"inner"</span>&gt;element2&lt;/<span class="keyword">div</span>&gt;</div><div class="line">&lt;/<span class="keyword">div</span>&gt;</div></pre></td></tr></table></figure></p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">-----------------------------------</div><div class="line">|<span class="string"> element1                        </span>|</div><div class="line">|<span class="string">   -------------------------     </span>|</div><div class="line">|<span class="string">   </span>|<span class="string">element2               </span>|<span class="string">     </span>|</div><div class="line">|<span class="string">   -------------------------     </span>|</div><div class="line">|<span class="string">                                 </span>|</div><div class="line">-----------------------------------</div></pre></td></tr></table></figure>
<p>åˆ†åˆ«ä¸ºå†…å¤–ä¸¤ä¸ªå…ƒç´ æ·»åŠ ä¸¤ä¸ªç‚¹å‡»äº‹ä»¶ï¼Œä¸€ä¸ªç”¨äºæ•è·é˜¶æ®µï¼Œä¸€ä¸ªç”¨äºå†’æ³¡é˜¶æ®µ<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">  var outerEl = <span class="built_in">document</span>.querySelector(<span class="string">'.outer'</span>);</div><div class="line">  var innerEl = <span class="built_in">document</span>.querySelector(<span class="string">'.inner'</span>);</div><div class="line"></div><div class="line">  innerEl.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'child bubble'</span>)</div><div class="line">  &#125;, <span class="literal">false</span>);</div><div class="line">  innerEl.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'child capture'</span>)</div><div class="line">  &#125;, <span class="literal">true</span>);</div><div class="line"></div><div class="line">  outerEl.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'parent bubble'</span>)</div><div class="line">  &#125;, <span class="literal">false</span>);</div><div class="line">  outerEl.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'parent capture'</span>)</div><div class="line">  &#125;, <span class="literal">true</span>);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>æ ¹æ®å‰é¢çš„çŸ¥è¯†ï¼Œå½“ç‚¹å‡» element2 å…ƒç´ å’Œ element1 å…ƒç´ çš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥ä¼šå¾—åˆ°ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#ç‚¹å‡» element2 å…ƒç´ </span></div><div class="line"><span class="keyword">parent</span> capture</div><div class="line">child capture</div><div class="line">child bubble</div><div class="line"><span class="keyword">parent</span> bubble</div><div class="line"></div><div class="line"><span class="comment">#ç‚¹å‡» element1 å…ƒç´ </span></div><div class="line"><span class="keyword">parent</span> capture</div><div class="line"><span class="keyword">parent</span> bubble</div></pre></td></tr></table></figure></p>
<p><strong>â—ï¸ä½†æ˜¯ï¼Œ</strong>å®é™…ä¸Šæˆ‘ä»¬ç‚¹å‡» element2 å’Œç‚¹å‡» element1 çš„æ—¶å€™ï¼Œå¾—åˆ°çš„ç»“æœå´æ˜¯ï¼ˆå…¶ä¸­éƒ½å‡ºç°äº†å…ˆ bubble å captureï¼‰ï¼š<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># ç‚¹å‡» element2</span></div><div class="line"><span class="keyword">parent</span> capture</div><div class="line">child bubble</div><div class="line">child capture</div><div class="line"><span class="keyword">parent</span> bubble</div><div class="line"></div><div class="line"><span class="comment"># ç‚¹å‡» element1</span></div><div class="line"><span class="keyword">parent</span> bubble</div><div class="line"><span class="keyword">parent</span> capture</div></pre></td></tr></table></figure></p>
<p>è¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿè¿™è·Ÿå‰é¢çš„ç»“è®ºä¸ç¬¦å•Š ğŸ¤” é€šè¿‡è§‚å¯Ÿæˆ‘ä»¬å¯ä»¥å‘ç°ï¼š<br>â‘  DOM å…ƒç´ å…ˆæ·»åŠ äº†ç”¨äºå†’æ³¡é˜¶æ®µçš„äº‹ä»¶ç›‘å¬ï¼Œåæ·»åŠ äº†ç”¨äºæ•è·é˜¶æ®µçš„äº‹ä»¶ç›‘å¬<br>â‘¡ è¢«ç‚¹å‡»å…ƒç´ å…ˆæ‰§è¡Œäº†å†’æ³¡é˜¶æ®µçš„äº‹ä»¶ç›‘å¬ï¼Œåæ‰§è¡Œæ•è·é˜¶æ®µçš„äº‹ä»¶ç›‘å¬ï¼›è€Œç‚¹å‡»äº‹ä»¶çš„çˆ¶èŠ‚ç‚¹äº‹ä»¶ç›‘å¬æ‰§è¡Œé¡ºåºæ­£å¸¸<br>â‘¢ æˆ‘ä»¬çŒœæµ‹æ˜¯å¦è·Ÿäº‹ä»¶ç›‘å¬æ·»åŠ é¡ºåºæœ‰å…³ç³»ï¼Œæˆ‘ä»¬è°ƒæ¢ä¸€ä¸‹æ·»åŠ é¡ºåºï¼š<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&lt;script&gt;</div><div class="line">  var outerEl = <span class="built_in">document</span>.querySelector(<span class="string">'.outer'</span>);</div><div class="line">  var innerEl = <span class="built_in">document</span>.querySelector(<span class="string">'.inner'</span>);</div><div class="line"></div><div class="line">  innerEl.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'child bubble'</span>)</div><div class="line">  &#125;, <span class="literal">true</span>);</div><div class="line">  innerEl.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'child capture'</span>)</div><div class="line">  &#125;, <span class="literal">false</span>);</div><div class="line"></div><div class="line">  outerEl.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'parent bubble'</span>)</div><div class="line">  &#125;, <span class="literal">true</span>);</div><div class="line">  outerEl.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="params">(event)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'parent capture'</span>)</div><div class="line">  &#125;, <span class="literal">false</span>);</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>å‘ç°æ‰§è¡Œå¾—åˆ°çš„ç»“æœæ­£å¸¸</p>
<p><strong>â—ï¸ç»™å‡ºç»“è®ºï¼š</strong></p>
<ul>
<li>ç»‘å®šåœ¨è¢«ç‚¹å‡»å…ƒç´ çš„äº‹ä»¶æ˜¯æŒ‰ç…§ä»£ç æ·»åŠ é¡ºåºæ‰§è¡Œï¼Œå…¶ä»–å…ƒç´ å…ˆæ•è·åå†’æ³¡</li>
<li><strong>æ‰€ä»¥äº‹ä»¶çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼šçˆ¶å…ƒç´ çš„æ•è·é˜¶æ®µäº‹ä»¶ -&gt; è§¦å‘äº‹ä»¶å…ƒç´ æŒ‰ä»£ç æ·»åŠ é¡ºåºçš„äº‹ä»¶ -&gt; çˆ¶å…ƒç´ çš„å†’æ³¡é˜¶æ®µäº‹ä»¶</strong></li>
</ul>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://javascript.info/bubbling-and-capturing" target="_blank" rel="external">Bubbling and capturing</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/js-event.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="JS" scheme="http://objcer.com/categories/JS/"/>
    
    
      <category term="äº‹ä»¶æ•è·" scheme="http://objcer.com/tags/%E4%BA%8B%E4%BB%B6%E6%8D%95%E8%8E%B7/"/>
    
      <category term="äº‹ä»¶å†’æ³¡" scheme="http://objcer.com/tags/%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1/"/>
    
  </entry>
  
  <entry>
    <title>æ¢ç©¶ emoji å­—ç¬¦é•¿åº¦</title>
    <link href="http://objcer.com/2017/07/20/explore-emoji-length/"/>
    <id>http://objcer.com/2017/07/20/explore-emoji-length/</id>
    <published>2017-07-20T11:41:38.000Z</published>
    <updated>2017-07-20T11:46:24.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/C0E1DEF1-900B-4372-B8CB-B166A1ABBA57.png" alt=""><br>æˆ‘ä»¬æ³¨æ„åˆ°åœ¨ Twitterï¼Œå¾®åšï¼Œè°·æ­Œç¿»è¯‘çš„è¾“å…¥æ¡†ä¸­è¾“å…¥ emoji å­—ç¬¦ï¼Œéƒ½ä¸èƒ½æ­£ç¡®çš„åˆ¤æ–­å­—ç¬¦ä¸ªæ•°ã€‚ğŸ¤·â€<br>åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰ï¼Œéœ€è¦å…ˆå¯¹ Unicode ç¼–ç æœ‰æ‰€äº†è§£ï¼Œå‚è€ƒ: <a href="http://objcer.com/2017/05/21/JavaScript-Unicode/">JavaScript Unicode ç¼–ç é‚£äº›äº‹</a></p>
<a id="more"></a>
<h2 id="String-length-Char-count"><a href="#String-length-Char-count" class="headerlink" title="String length != Char count"></a>String length != Char count</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">'ğŸ˜‚'</span><span class="selector-class">.length</span> <span class="comment">// 2</span></div><div class="line"><span class="string">'1ï¸âƒ£'</span><span class="selector-class">.length</span> <span class="comment">// 3</span></div><div class="line"><span class="string">'ğŸ‘¨â€ğŸ‘¨â€ğŸ‘¦'</span><span class="selector-class">.length</span> <span class="comment">// 8</span></div><div class="line"><span class="string">'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦'</span><span class="selector-class">.length</span> <span class="comment">// 11</span></div></pre></td></tr></table></figure>
<h2 id="å…³äº-Unicode"><a href="#å…³äº-Unicode" class="headerlink" title="å…³äº Unicode"></a>å…³äº Unicode</h2><p>Unicode ç¼–ç èŒƒå›´æ˜¯ä» U+0000 åˆ° U+10FFFFï¼Œæ¯ä¸€ä¸ªç¼–ç ï¼ˆä¹Ÿç§°ä¹‹ä¸ºç ä½ code pointï¼‰è¡¨ç¤ºä¸€ä¸ª Unicode å­—ç¬¦ï¼›è€Œè¿™ä¹ˆå¤šç ä½æœ‰åˆ’åˆ†æˆ 17 ä¸ªå¹³é¢ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå¹³é¢(U+0000 ~ U+FFFF): åŸºæœ¬å¹³é¢(Basic Multilingual Plane - <em>BMP</em>)</li>
<li>å…¶ä»– 16 ä¸ªå¹³é¢(U+100000 ~ U+10FFFF): è¡¥å……å¹³é¢(Supplementary Planes)</li>
</ul>
<p>å…¶ä¸­ emoji ä½œä¸ºä¸€ç§ç‰¹æ®Šç¼–ç åœ¨è¡¥å……å¹³é¢ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">'ğŸ˜€'<span class="string">.codePointAt</span><span class="params">(0)</span><span class="string">.toString</span><span class="params">(16)</span> <span class="string">//</span> 0x1f600</div><div class="line">'ğŸ˜‚'<span class="string">.codePointAt</span><span class="params">(0)</span><span class="string">.toString</span><span class="params">(16)</span> <span class="string">//</span> 0x1f602</div></pre></td></tr></table></figure></p>
<h2 id="å…³äº-emoji"><a href="#å…³äº-emoji" class="headerlink" title="å…³äº emoji"></a>å…³äº emoji</h2><blockquote>
<p>An Emoji as we know it today <strong>is defined by at least one code point</strong> in the Unicode range. This means that there are also several Emoji out there being a combination of several different Emoji and code points. These combinations are called <strong>sequences</strong>.</p>
</blockquote>
<p>ä¸€ä¸ª emoji å­—ç¬¦è‡³å°‘ç”±ä¸€ä¸ªç ä½è¡¨ç¤ºï¼Œä¸€ä¸ª emoji æœ‰å¤šä¸ªç ä½è¡¨ç¤ºçš„æˆ‘ä»¬ç§°ä¹‹ä¸ºåºåˆ—(sequences)ã€‚å¯ä»¥åœ¨ <a href="http://unicode.org/emoji/charts/full-emoji-list.html" target="_blank" rel="external">Full Emoji List</a> é¡µé¢æŸ¥çœ‹åˆ°æ‰€æœ‰ emoji çš„ç¼–ç ä¿¡æ¯<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/5E88BF15-66B7-4A32-9125-B3E019C52E9C.png" alt=""></p>
<p>åœ¨ JavaScript ä¸­ <code>String.length</code> è®¡ç®—å­—ç¬¦é•¿åº¦æ—¶ï¼Œè®¤ä¸ºä¸¤ä¸ªå­—èŠ‚ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ä¸€ä¸ªåŸºæœ¬å¹³é¢ä¸Šçš„å­—ç¬¦é•¿åº¦éƒ½ä¸º 1ï¼›è€Œä¸€ä¸ªè¡¥å……å¹³é¢ä¸Šçš„å­—ç¬¦ä½¿ç”¨ä»£ç†å¯¹ï¼Œç”±å››ä¸ªå­—ç¬¦è¡¨ç¤ºï¼Œæ‰€ä»¥é•¿åº¦ä¸º 2ï¼›<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// a: 0x61</span></div><div class="line"><span class="string">'a'</span><span class="selector-class">.lenght</span> <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="comment">//ğŸ’©: U+d83d U+dca9</span></div><div class="line"><span class="string">'ğŸ’©'</span><span class="selector-class">.length</span> <span class="comment">// 2</span></div><div class="line"></div><div class="line"><span class="comment">// '1ï¸âƒ£': U+0031 U+FE0F U+20E3</span></div><div class="line"><span class="string">'1ï¸âƒ£'</span><span class="selector-class">.length</span> <span class="comment">// 3</span></div></pre></td></tr></table></figure></p>
<h3 id="Modifier-sequences"><a href="#Modifier-sequences" class="headerlink" title="Modifier sequences"></a>Modifier sequences</h3><p><img src="http://7vikhl.com1.z0.glb.clouddn.com/480D3F20-0262-40E4-B7C6-E068A9958692.png" alt=""><br>æˆ‘ä»¬æ³¨æ„éƒ¨åˆ†äººç±»ç›¸å…³çš„ <strong>Human emoji</strong> å¯ä»¥é€‰æ‹©å…¶ä»– 5 ç§ä¸åŒçš„è‚¤è‰²(<strong>Skin color</strong>)ï¼Œé»˜è®¤é¢œè‰²çš„ emoji ç§°ä¹‹ä¸º <strong>neutral emoji</strong>ï¼Œä¸åŒè‚¤è‰²ç§°ä¹‹ä¸º <strong>modifier</strong>ï¼Œè¿™äº›ä¸åŒè‚¤è‰²çš„ emoji æˆ‘ä»¬ç§°ä¹‹ä¸º <strong>Modifier sequences</strong>ã€‚</p>
<blockquote>
<p>These modifiers are called EMOJI MODIFIER FITZPATRICK TYPE-1-2, -3, -4, -5, and -6 (U+1F3FBâ€“U+1F3FF): ğŸ» ğŸ¼ ğŸ½ ğŸ¾ ğŸ¿</p>
</blockquote>
<table>
<thead>
<tr>
<th>Code point</th>
<th>default</th>
<th>FITZ-1-2(U+1F3FB)</th>
<th>FITZ-3(U+1F3FC)</th>
<th>FITZ-4(U+1F3FD)</th>
<th>FITZ-5(U+1F3FE)</th>
<th>FITZ-6(U+1F3FF)</th>
</tr>
</thead>
<tbody>
<tr>
<td>U+1F466: BOY</td>
<td>ğŸ‘¦</td>
<td>ğŸ‘¦ğŸ»</td>
<td>ğŸ‘¦ğŸ¼</td>
<td>ğŸ‘¦ğŸ½</td>
<td>ğŸ‘¦ğŸ¾</td>
<td>ğŸ‘¦ğŸ¿</td>
</tr>
<tr>
<td>U+1F467: GIRL</td>
<td>ğŸ‘§</td>
<td>ğŸ‘§ğŸ»</td>
<td>ğŸ‘§ğŸ¼</td>
<td>ğŸ‘§ğŸ½</td>
<td>ğŸ‘§ğŸ¾</td>
<td>ğŸ‘§ğŸ¿</td>
</tr>
<tr>
<td>U+1F468: MAN</td>
<td>ğŸ‘¨</td>
<td>ğŸ‘¨ğŸ»</td>
<td>ğŸ‘¨ğŸ¼</td>
<td>ğŸ‘¨ğŸ½</td>
<td>ğŸ‘¨ğŸ¾</td>
<td>ğŸ‘¨ğŸ¿</td>
</tr>
<tr>
<td>U+1F469: WOMAN</td>
<td>ğŸ‘©</td>
<td>ğŸ‘©ğŸ»</td>
<td>ğŸ‘©ğŸ¼</td>
<td>ğŸ‘©ğŸ½</td>
<td>ğŸ‘©ğŸ¾</td>
<td>ğŸ‘©ğŸ¿</td>
</tr>
</tbody>
</table>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// U+1F467 + U+1F3FD</div><div class="line">ğŸ‘§ + ğŸ½</div><div class="line"><span class="meta">&gt;</span><span class="bash"> ğŸ‘§ğŸ½</span></div></pre></td></tr></table></figure>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/E3F5C223-E3E9-4ECC-AD67-DF09D6D62DD6.png" alt=""></p>
<p>æ˜æ˜¾çš„ï¼Œè¿™ç±» emoji çš„é€šè¿‡ <code>String.length</code> è·å–é•¿åº¦ä¸º <strong>4</strong></p>
<h3 id="ZWJ-sequences"><a href="#ZWJ-sequences" class="headerlink" title="ZWJ sequences"></a>ZWJ sequences</h3><p>æ¥ä¸‹æ¥é‡Œäº†è§£ä¸€ä¸‹ <strong>family emoji</strong>ï¼Œè­¬å¦‚æˆ‘ä»¬å¸¸è§çš„ï¼šä¸‰å£ä¹‹å®¶ï¼šğŸ‘ªï¼Œå››å£ä¹‹å®¶ï¼šğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ï¼Œç­‰ç­‰ï¼›å…¶ä¸­å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š</p>
<ul>
<li>æœ‰ä¸€ä¸ª neutral family emoji (U+1F46A - â€ğŸ‘ª) ç”±ä¸€ä¸ªç ä½è¡¨ç¤º</li>
<li>è€Œå…¶ä»– family emoji éƒ½æ˜¯ <strong>Zero-Width-Joiner sequence</strong>ï¼›å®ƒä»¬ç”±å¤šä¸ª emoji å’Œ zero-width-joiner (U+200D) ç»„åˆè€Œæˆ</li>
</ul>
<p>æ³¨ï¼šzero-width-joiner (U+200D) è¿™ä¸ªç ä½å°±å¦‚åŒèƒ¶æ°´ä¸€èˆ¬å°†ä¸åŒçš„ emoji ç»„åˆæˆä¸€ä¸ª emojiï¼›zero-width-joiner (U+200D) åªå ä¸€ä¸ªé•¿åº¦<br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">// neutral family</div><div class="line">// U<span class="string">+1</span>F46A</div><div class="line">// length: 2</div><div class="line">&gt; ğŸ‘ª</div><div class="line"></div><div class="line">// ZWJ sequence: family (man, woman, boy)</div><div class="line">// U<span class="string">+1</span>F468 + U<span class="string">+200</span>D + U<span class="string">+1</span>F469 + U<span class="string">+200</span>D + U<span class="string">+1</span>F466</div><div class="line">// ğŸ‘¨â€ + U<span class="string">+200</span>D + ğŸ‘©â€ + U<span class="string">+200</span>D + ğŸ‘¦</div><div class="line">// length: 8</div><div class="line">&gt; â€ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦</div><div class="line"></div><div class="line">// ZWJ sequence: family (woman, woman, girl)</div><div class="line">// U<span class="string">+1</span>F469 + U<span class="string">+200</span>D + U<span class="string">+1</span>F469 + U<span class="string">+200</span>D + U<span class="string">+1</span>F467</div><div class="line">// ğŸ‘©â€ + U<span class="string">+200</span>D + ğŸ‘©â€ U<span class="string">+200</span>D + ğŸ‘§</div><div class="line">// length: 8</div><div class="line">&gt; â€ğŸ‘©â€ğŸ‘©â€ğŸ‘§</div><div class="line"></div><div class="line">// ZWJ sequence: family (woman, woman, girl, girl)</div><div class="line">// U<span class="string">+1</span>F469 + U<span class="string">+200</span>D + U<span class="string">+1</span>F469 + U<span class="string">+200</span>D + U<span class="string">+1</span>F467 + U<span class="string">+200</span>D + U<span class="string">+1</span>F467</div><div class="line">// ğŸ‘©â€ + U<span class="string">+200</span>D + ğŸ‘©â€ + U<span class="string">+200</span>D + ğŸ‘§â€ + U<span class="string">+200</span>D + ğŸ‘§</div><div class="line">// length: 11</div><div class="line">&gt; â€ğŸ‘©â€ğŸ‘©â€ğŸ‘§â€ğŸ‘§</div></pre></td></tr></table></figure></p>
<p>æ‹†åˆ†ï¼Œç»„åˆ family emojiï¼š<br><figure class="highlight prolog"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[...<span class="string">'ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦'</span>]</div><div class="line">&gt;  [<span class="string">"ğŸ‘¨"</span>, <span class="string">"â€"</span>, <span class="string">"ğŸ‘©"</span>, <span class="string">"â€"</span>, <span class="string">"ğŸ‘¦"</span>]</div><div class="line"></div><div class="line">var family =  [<span class="string">"ğŸ‘¨"</span>, <span class="string">"â€"</span>, <span class="string">"ğŸ‘©"</span>, <span class="string">"â€"</span>, <span class="string">"ğŸ‘¦"</span>]</div><div class="line">console.log(family.join(<span class="string">''</span>))</div><div class="line">&gt; <span class="string">"ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦"</span></div></pre></td></tr></table></figure></p>
<h2 id="è§£å†³å­—ç¬¦é•¿åº¦ç»ˆæè§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³å­—ç¬¦é•¿åº¦ç»ˆæè§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³å­—ç¬¦é•¿åº¦ç»ˆæè§£å†³æ–¹æ¡ˆ"></a>è§£å†³å­—ç¬¦é•¿åº¦ç»ˆæè§£å†³æ–¹æ¡ˆ</h2><p>æˆ‘ä»¬æ‰¾åˆ°ä¸€æ®µæ­£åˆ™è¡¨è¾¾å¼ï¼Œå¯ä»¥ç”¨äºåŒ¹é… Unicode å­—ç¬¦ï¼›ç„¶åå°è£…æˆ <a href="https://github.com/YingshanDeng/EmojiCharString" target="_blank" rel="external">EmojiCharString</a> ç±»åº“ï¼Œè¯¦ç»†ä»‹ç»å‚è€ƒè¯¥ä»“åº“ README ğŸ‘‰</p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://mathiasbynens.be/notes/javascript-unicode" target="_blank" rel="external">JavaScript has a Unicode problem</a><br><a href="https://www.contentful.com/blog/2016/12/06/unicode-javascript-and-the-emoji-family/" target="_blank" rel="external">Emoji.prototype.length â€” a tale of characters in Unicode</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/C0E1DEF1-900B-4372-B8CB-B166A1ABBA57.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;æˆ‘ä»¬æ³¨æ„åˆ°åœ¨ Twitterï¼Œå¾®åšï¼Œè°·æ­Œç¿»è¯‘çš„è¾“å…¥æ¡†ä¸­è¾“å…¥ emoji å­—ç¬¦ï¼Œéƒ½ä¸èƒ½æ­£ç¡®çš„åˆ¤æ–­å­—ç¬¦ä¸ªæ•°ã€‚ğŸ¤·â€&lt;br&gt;åœ¨é˜…è¯»æœ¬æ–‡ä¹‹å‰ï¼Œéœ€è¦å…ˆå¯¹ Unicode ç¼–ç æœ‰æ‰€äº†è§£ï¼Œå‚è€ƒ: &lt;a href=&quot;http://objcer.com/2017/05/21/JavaScript-Unicode/&quot;&gt;JavaScript Unicode ç¼–ç é‚£äº›äº‹&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Unicode" scheme="http://objcer.com/categories/Unicode/"/>
    
    
      <category term="unicode-emoji" scheme="http://objcer.com/tags/unicode-emoji/"/>
    
  </entry>
  
  <entry>
    <title>Cordova å¼€å‘ç¯å¢ƒ - Android ç¯‡</title>
    <link href="http://objcer.com/2017/07/03/cordova-android-development-environment/"/>
    <id>http://objcer.com/2017/07/03/cordova-android-development-environment/</id>
    <published>2017-07-03T14:14:19.000Z</published>
    <updated>2017-07-20T11:46:24.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/android-banner.jpg" alt=""><br><a id="more"></a></p>
<h2 id="å®‰è£…-IDE-Android-Studio"><a href="#å®‰è£…-IDE-Android-Studio" class="headerlink" title="å®‰è£… IDE (Android Studio)"></a>å®‰è£… IDE (Android Studio)</h2><p>å®‰è£… Android Studio, SDK, Android Virtual Device (AVDï¼Œå®‰å“æ¨¡æ‹Ÿå™¨)</p>
<ul>
<li>ä¸‹è½½é“¾æ¥ï¼š<a href="https://developer.android.com/studio/index.html?hl=zh-cn" target="_blank" rel="external">Android Studio</a></li>
<li>ä¸‹è½½å®‰è£…å…¨ç¨‹éœ€è¦<strong>ç¿»å¢™</strong></li>
<li>å®‰è£… Android Studio å®Œæˆåï¼Œåˆ›å»ºä¸€ä¸ª HelloWorld ç¨‹åºåˆ°æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒæŒ‰ç…§æç¤ºè¿›è¡Œä¸‹è½½å®‰è£…å³å¯</li>
</ul>
<h2 id="çœŸæœºè¿è¡Œ"><a href="#çœŸæœºè¿è¡Œ" class="headerlink" title="çœŸæœºè¿è¡Œ"></a>çœŸæœºè¿è¡Œ</h2><p>æ‰‹æœºé€šè¿‡ USB è¿æ¥ç”µè„‘åï¼Œè¿è¡Œæ—¶ï¼Œé€‰æ‹©å¯¹åº”çš„è®¾å¤‡å³å¯è¿è¡Œï¼Œä»¥ä¸‹ç½—åˆ—å‡ ç‚¹çœŸæœºè¿è¡Œä¸­é‡åˆ°çš„é—®é¢˜å’ŒæŠ€å·§</p>
<h3 id="è§£å†³ï¼šDELETE-FAILED-INTERNAL-ERROR-Error-while-Installing-APK"><a href="#è§£å†³ï¼šDELETE-FAILED-INTERNAL-ERROR-Error-while-Installing-APK" class="headerlink" title="è§£å†³ï¼šDELETE_FAILED_INTERNAL_ERROR Error while Installing APK"></a>è§£å†³ï¼š<em>DELETE_FAILED_INTERNAL_ERROR Error while Installing APK</em></h3><p>å®‰å“çœŸæœºï¼ˆå°ç±³4Cï¼‰é€šè¿‡ USB è¿æ¥ç”µè„‘åï¼Œè¿è¡Œï¼Œå¯èƒ½ä¼šå‡ºç°å¦‚ä¸‹é—®é¢˜ï¼š<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/3B19ED97-CE3F-45A9-8518-C08D779F7FA3.png" alt=""><br>ç‚¹å‡» OK ç»§ç»­ï¼Œä¼šå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š<br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">DELETE_FAILED_INTERNAL_ERROR</div><div class="line"><span class="keyword">Error </span>while Installing APKs</div></pre></td></tr></table></figure></p>
<p>å‚è€ƒé“¾æ¥ï¼š<a href="https://stackoverflow.com/questions/38892270/delete-failed-internal-error-error-while-installing-apk" target="_blank" rel="external">DELETE_FAILED_INTERNAL_ERROR Error while Installing APK</a> å¤§è‡´æœ‰ä¸¤ç§è§£å†³æ–¹æ¡ˆï¼š</p>
<ul>
<li>æ“ä½œæ­¥éª¤ï¼šAndroid Studio &gt; Preferences &gt;  Build, Execution, Deployment &gt; Instant Run &gt; <strong>Uncheck : Enable Instant Run</strong>ï¼ˆæ­¤å¤„ç†æ–¹å¼ä¼šç¦ç”¨ Instant Run åŠŸèƒ½ï¼‰<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/03E0830C-F5BB-4EC5-AC41-50A604A3E532.png" alt=""></li>
<li>ç”±äºè°ƒè¯•è®¾å¤‡æ˜¯å°ç±³ï¼Œæ‰€ä»¥è¿˜å¯ä»¥ï¼šè®¾ç½® &gt; æ›´å¤šè®¾ç½® &gt; å¼€å‘è€…é€‰é¡¹ &gt; <strong>å»æ‰ï¼šå¯åŠ¨ MIUI ä¼˜åŒ–</strong> &gt; å…³é—­å¹¶é‡å¯</li>
</ul>
<h3 id="ADB-æ— çº¿è°ƒè¯•"><a href="#ADB-æ— çº¿è°ƒè¯•" class="headerlink" title="ADB æ— çº¿è°ƒè¯•"></a>ADB æ— çº¿è°ƒè¯•</h3><p>Android ADB æä¾›äº†æ— çº¿è°ƒè¯•çš„åŠŸèƒ½</p>
<blockquote>
<p><a href="https://developer.android.com/studio/command-line/adb.html?hl=zh-cn#Enabling" target="_blank" rel="external">Android è°ƒè¯•æ¡¥</a></p>
</blockquote>
<h4 id="è§£å†³ï¼šzsh-command-not-found-adb"><a href="#è§£å†³ï¼šzsh-command-not-found-adb" class="headerlink" title="è§£å†³ï¼šzsh: command not found: adb"></a>è§£å†³ï¼š<code>zsh: command not found: adb</code></h4><p>è§£å†³æ­¥éª¤ï¼š<br>1ï¸âƒ£ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¾€ .bash_profile æ·»åŠ ä¸¤ä¸ªè·¯å¾„<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> <span class="string">"export PATH=\$PATH:/Users/<span class="variable">$&#123;USER&#125;</span>/Library/Android/sdk/platform-tools/"</span> &gt;&gt; ~/.bash_profile</div><div class="line"><span class="built_in">echo</span> <span class="string">"export PATH=\$PATH:/Users/<span class="variable">$&#123;USER&#125;</span>/Library/Android/sdk/tools/"</span> &gt;&gt; ~/.bash_profile</div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œå <code>.bash_profile</code> æ–‡ä»¶ï¼š<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">export PATH=<span class="variable">$PATH</span><span class="symbol">:/Users/YingshanDeng/Library/Android/sdk/platform-tools/</span></div><div class="line">export PATH=<span class="variable">$PATH</span><span class="symbol">:/Users/YingshanDeng/Library/Android/sdk/tools/</span></div></pre></td></tr></table></figure></p>
<p>2ï¸âƒ£ æ‰§è¡Œ <code>source .bash_profile</code> ä½¿å…¶ç”Ÿæ•ˆï¼Œæ­¤æ—¶æˆ‘ä»¬åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>adb</code> ä¼šå‘ç°è¯¥å‘½ä»¤ç”Ÿæ•ˆäº†<br>3ï¸âƒ£ ç”±äºæˆ‘çš„ç»ˆç«¯ä½¿ç”¨çš„æ˜¯ zshï¼Œæ‰€ä»¥éœ€è¦å†å¤„ç†ä¸€ä¸‹ï¼š<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> æ‰“å¼€ .zshrc</span></div><div class="line">open .zshrc</div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash"> åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ </span></div><div class="line">source ~/.bash_profile</div><div class="line"><span class="meta"></span></div><div class="line">#<span class="bash"> ä¿å­˜ï¼Œé‡å¯ç»ˆç«¯å³å¯</span></div></pre></td></tr></table></figure></p>
<h4 id="AndroidWiFiADB-æ’ä»¶"><a href="#AndroidWiFiADB-æ’ä»¶" class="headerlink" title="AndroidWiFiADB æ’ä»¶"></a>AndroidWiFiADB æ’ä»¶</h4><p>ç›´æ¥ä½¿ç”¨è¿˜æ˜¯ä¸å¤Ÿæ–¹ä¾¿ï¼Œæ¨èä½¿ç”¨ <strong>AndroidWiFiADB æ’ä»¶</strong>ï¼Œé¡¹ç›®åœ°å€ï¼š<a href="https://github.com/pedrovgs/AndroidWiFiADB" target="_blank" rel="external">AndroidWiFiADB</a></p>
<p>å®‰è£…æ–¹å¼ï¼š</p>
<ul>
<li>Preferences -&gt; Settings -&gt; Plugins-&gt; Browse Repositories</li>
<li>è¾“å…¥: Android WiFi ADB è¿›è¡Œæœç´¢ï¼Œå®‰è£…åé‡å¯</li>
</ul>
<p>å¦‚ä½•ä½¿ç”¨ï¼š</p>
<ul>
<li>å…ˆå°†æ‰‹æœºé€šè¿‡ USB è¿æ¥ç”µè„‘ï¼Œè€Œä¸”ä¿è¯æ‰‹æœºå’Œç”µè„‘è¿æ¥åŒä¸€ WiFiï¼Œç‚¹å‡» AndroidWiFiADB æ’ä»¶æŒ‰é”®ï¼Œä¼šåœ¨å³ä¸‹è§’å¼¹æ°”æ³¡æç¤ºæ˜¯å¦è¿æ¥æˆåŠŸï¼Œè¿æ¥æˆåŠŸåå³å¯æ–­å¼€ USB è¿æ¥çº¿ï¼Œäº«å—æ— çº¿æç¤º</li>
<li>åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œè¦ç¡®ä¿æ‰‹æœºå’Œç”µè„‘è¿æ¥çš„åŒä¸€ WiFi</li>
<li>å¯ä»¥é€šè¿‡ AndroidWiFiADB è®¾å¤‡é¢æ¿æŸ¥çœ‹è®¾å¤‡åŠè®¾ç½®è¿æ¥çŠ¶æ€</li>
</ul>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/36CDAE13-BEBC-42D2-9226-A53DF0CEE4B1.png" alt=""></p>
<h2 id="Chrome-è¿œç¨‹è°ƒè¯•æ¨¡æ‹Ÿå™¨-çœŸæœº"><a href="#Chrome-è¿œç¨‹è°ƒè¯•æ¨¡æ‹Ÿå™¨-çœŸæœº" class="headerlink" title="Chrome è¿œç¨‹è°ƒè¯•æ¨¡æ‹Ÿå™¨/çœŸæœº"></a>Chrome è¿œç¨‹è°ƒè¯•æ¨¡æ‹Ÿå™¨/çœŸæœº</h2><blockquote>
<p><a href="https://developers.google.com/web/tools/chrome-devtools/remote-debugging/?hl=zh-cn" target="_blank" rel="external">è¿œç¨‹è°ƒè¯• Android è®¾å¤‡ä½¿ç”¨å…¥é—¨</a></p>
</blockquote>
<p>æ“ä½œæ­¥éª¤ï¼š</p>
<ul>
<li>éšä¾¿åœ¨æŸä¸ªé¡µé¢æ‰“å¼€è°ƒè¯•é¡µé¢ï¼Œå¦‚ä¸‹å›¾æ‰¾åˆ° <strong>Remote devices</strong><br><img src="http://7vikhl.com1.z0.glb.clouddn.com/8FA1EB72-12AE-4984-AA64-2C7022B1F00E.png" alt=""></li>
<li>ç¡®ä¿å·²å‹¾é€‰ <strong>Discover USB devices</strong><br><img src="http://7vikhl.com1.z0.glb.clouddn.com/B378E60C-01E5-43AE-8EA1-02999501F241.png" alt=""></li>
<li>å¦‚ä¸‹å›¾æ‰¾åˆ°å¯¹åº”çš„æ¨¡æ‹Ÿå™¨æˆ–è€…çœŸæœºï¼Œç‚¹å‡» <strong>Inspect</strong> æŒ‰é”®å°±å¯ä»¥æ‰“å¼€è°ƒè¯•ç•Œé¢<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/917006D3-5881-4A6F-814F-0B3BB54383D7.png" alt=""></li>
</ul>
<h2 id="å…¶ä»–é—®é¢˜è®°å½•"><a href="#å…¶ä»–é—®é¢˜è®°å½•" class="headerlink" title="å…¶ä»–é—®é¢˜è®°å½•"></a>å…¶ä»–é—®é¢˜è®°å½•</h2><p>1ã€Android Studio å¯¼å…¥é¡¹ç›®å¡åœ¨ <em>Building gradle project info</em> çš„è§£å†³æ–¹æ³•ï¼š</p>
<ul>
<li><a href="http://www.jianshu.com/p/1311562bbfd4" target="_blank" rel="external">ä¿®æ”¹é¡¹ç›®ä¸­gradle-wrapper.propertiesæ–‡ä»¶ä¸­çš„distributionUrl</a></li>
<li>ä»ä¸€ä¸ªèƒ½æ‰“å¼€é¡¹ç›®æ ¹ç›®å½•æ‹·è´ <code>gradle</code> æ–‡ä»¶å¤¹è¦†ç›–å½“å‰é¡¹ç›®æ ¹ç›®å½•ä¸­çš„ <code>gradle</code> æ–‡ä»¶å¤¹</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/android-banner.jpg&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Cordova" scheme="http://objcer.com/categories/Cordova/"/>
    
    
  </entry>
  
  <entry>
    <title>é«˜æ¸…å±ä¸€åƒç´ è¾¹æ¡†é—®é¢˜</title>
    <link href="http://objcer.com/2017/06/19/one-pixel-border/"/>
    <id>http://objcer.com/2017/06/19/one-pixel-border/</id>
    <published>2017-06-19T13:24:02.000Z</published>
    <updated>2017-06-19T13:27:12.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/retinaDisplayMagnified_1159x285@2x.png" alt=""><br><a id="more"></a></p>
<h2 id="å‘ç°é—®é¢˜"><a href="#å‘ç°é—®é¢˜" class="headerlink" title="å‘ç°é—®é¢˜"></a>å‘ç°é—®é¢˜</h2><p>åœ¨ iPhone è®¾å¤‡ï¼ˆRetinaå±ï¼‰ä¸Šä¸€åƒç´ è¾¹æ¡†è®¾ç½®æœ‰é—®é¢˜</p>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/F115E87F-990C-4957-B007-26F8B844287D.png" alt=""></p>
<p>å¦‚ä¸Šå›¾å³æ‰€ç¤ºï¼ŒUI è¦æ±‚æ•ˆæœçš„è¾¹æ¡†æ˜¯ 1pxï¼›å¦‚ä¸Šå›¾å·¦æ‰€ç¤ºï¼Œå¼€å‘å‡ºæ¥çš„æ•ˆæœè¾¹æ¡†ä¸º 2pxï¼ˆè†œæ‹œä¸€ä¸‹UIçš„åƒç´ çœ¼ ğŸ‘ğŸ¿ï¼‰ã€‚è®¾ç½®è¾¹æ¡†çš„ä»£ç å¾ˆç®€å•ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#e1e0e0</span>;</div></pre></td></tr></table></figure></p>
<p>é‚£é—®é¢˜è¯¥å¦‚ä½•è§£å†³å‘¢ ğŸ¤”</p>
<h2 id="åŸºæœ¬æ¦‚å¿µ-æœ¯è¯­"><a href="#åŸºæœ¬æ¦‚å¿µ-æœ¯è¯­" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ(æœ¯è¯­)"></a>åŸºæœ¬æ¦‚å¿µ(æœ¯è¯­)</h2><h3 id="device-pixel-physical-pixel"><a href="#device-pixel-physical-pixel" class="headerlink" title="device pixel / physical pixel"></a>device pixel / physical pixel</h3><p>è®¾å¤‡åƒç´ ï¼ˆæˆ–ç‰©ç†åƒç´ ï¼‰æ˜¯<strong>æ˜¾ç¤ºå±ä¸­æœ€å°çš„ç‰©ç†å•å…ƒ</strong>ã€‚ æ¯ä¸ªåƒç´ ç‚¹æ ¹æ®æ“ä½œç³»ç»Ÿçš„æŒ‡ç¤ºè®¾ç½®è‡ªå·±çš„é¢œè‰²å’Œäº®åº¦ã€‚</p>
<h3 id="density-independent-pixel-DIP"><a href="#density-independent-pixel-DIP" class="headerlink" title="density-independent pixel(DIP)"></a>density-independent pixel(DIP)</h3><p>è®¾å¤‡æ— å…³åƒç´ (ä¹Ÿå«å¯†åº¦æ— å…³åƒç´ )ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯<strong>è®¡ç®—æœºåæ ‡ç³»ç»Ÿä¸­å¾—ä¸€ä¸ªç‚¹</strong>ï¼Œè¿™ä¸ªç‚¹ä»£è¡¨ä¸€ä¸ªå¯ä»¥ç”±ç¨‹åºä½¿ç”¨çš„è™šæ‹Ÿåƒç´ ï¼Œç„¶åç”±ç›¸å…³ç³»ç»Ÿè½¬æ¢ä¸ºç‰©ç†åƒç´ ã€‚</p>
<h3 id="CSS-pixel"><a href="#CSS-pixel" class="headerlink" title="CSS pixel"></a>CSS pixel</h3><p>CSS åƒç´ æ˜¯æµè§ˆå™¨ä½¿ç”¨çš„æŠ½è±¡å•å…ƒï¼Œç”¨äºç²¾ç¡®åœ°ï¼Œä¸€è‡´åœ°åœ¨ç½‘é¡µä¸Šç»˜åˆ¶å†…å®¹ã€‚ é€šå¸¸ï¼Œ<strong>CSS åƒç´ è¢«ç§°ä¸ºä¸è®¾å¤‡æ— å…³çš„åƒç´ ï¼ˆDIPï¼‰</strong>ã€‚</p>
<h3 id="devicePixelRatio"><a href="#devicePixelRatio" class="headerlink" title="devicePixelRatio"></a>devicePixelRatio</h3><p>è®¾å¤‡åƒç´ å’Œè®¾å¤‡æ— å…³åƒç´ ä¹‹é—´å­˜åœ¨ç€ä¸€å®šçš„å¯¹åº”å…³ç³»ï¼Œè¿™å°±æ˜¯ devicePixelRatioï¼ˆè®¾å¤‡åƒç´ æ¯”ï¼‰</p>
<blockquote>
<p>devicePixelRatio is the ratio between physical pixels and device-independent pixels (dips) on the device.</p>
</blockquote>
<p><strong>devicePixelRatio = device pixels / dips</strong></p>
<p><code>devicePixelRatio</code> å€¼ä¸º 1 çš„å±å¹•ç§°ä¹‹ä¸ºæ ‡å‡†å±ï¼›ç›®å‰ï¼Œå¤§éƒ¨åˆ†ç§»åŠ¨è®¾å¤‡éƒ½æ˜¯é«˜æ¸…å±ï¼Œå³ <code>devicePixelRatio</code> å€¼å¤§äº 1 çš„å±å¹•ï¼Œå¯¹äºè‹¹æœè®¾å¤‡æ¥è¯´ï¼Œæˆ‘ä»¬ç»å¸¸å¬åˆ° Retina è§†ç½‘è†œå±ï¼Œå…¶ä¸­ iPhone6/6s/7 çš„ <code>devicePixelRatio</code> å€¼ä¸º 2ï¼›è€Œ iPhone6 plus/6s plus/7 plus çš„ <code>devicePixelRatio</code> å€¼ä¸º 3ã€‚</p>
<p>é€šè¿‡ä¸€ä¸ªä¾‹å­è¿›ä¸€æ­¥ç†è§£å…¶ä¸­çš„å…³ç³»ï¼š<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/AF218F20-056F-4CB4-8A1F-2949C6913DCD.png" alt=""></p>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦ç»˜åˆ¶å¦‚ä¸‹è¿™ä¸ª <code>div</code> èŠ‚ç‚¹ï¼Œ<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div <span class="attribute">height</span>=<span class="string">"2"</span> <span class="attribute">width</span>=<span class="string">"2"</span>&gt;&lt;/div&gt;</div></pre></td></tr></table></figure></p>
<ul>
<li><code>div</code> èŠ‚ç‚¹å®½åº¦å’Œé«˜åº¦éƒ½æ˜¯ <code>2px</code>ï¼Œè¿™é‡Œçš„ <code>2px</code> æŒ‡çš„å°±æ˜¯ CSS pixelï¼Œè€Œ CSS pixel æ˜¯æŠ½è±¡çš„å•ä½ï¼Œæ‰€ä»¥ä¸ç®¡åœ¨æ ‡å‡†å±ï¼Œè¿˜æ˜¯é«˜æ¸…å±ï¼Œå…¶ CSS pixel éƒ½æ˜¯ <code>2px</code></li>
<li>1 CSS pixel ç­‰åŒäº 1 DIP</li>
<li>device pixels = devicePixelRatio * dips<ul>
<li>åœ¨æ ‡å‡†å±ï¼ˆ<code>devicePixelRatio</code> å€¼ä¸º 1ï¼‰ä¸­ç»˜åˆ¶è¿™ä¸ªèŠ‚ç‚¹æ—¶ï¼ŒèŠ‚ç‚¹çš„è®¾å¤‡åƒç´ ä¸º <code>2px * 2px</code></li>
<li>åœ¨é«˜æ¸…å±ï¼ˆ<code>devicePixelRatio</code> å€¼ä¸º 2ï¼‰ä¸­ç»˜åˆ¶è¿™ä¸ªèŠ‚ç‚¹æ—¶ï¼ŒèŠ‚ç‚¹çš„è®¾å¤‡åƒç´ ä¸º <code>4px * 4px</code></li>
</ul>
</li>
<li>é«˜æ¸…å±ä¸­èŠ‚ç‚¹çš„é¢ç§¯æ˜¯æ ‡å‡†å±ä¸­çš„ 4 å€</li>
</ul>
<p>åœ¨ç½‘é¡µä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ JS è·å– <code>devicePixelRatio</code><br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span>.devicePixelRatio)</div></pre></td></tr></table></figure></p>
<p>åœ¨ CSS åª’ä½“æŸ¥è¯¢ï¼ˆmedia queryï¼‰ä¸­ä¹Ÿå¯ä»¥ç”¨åˆ° <code>devicePixelRatio</code><br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">@media</span> only screen and (<span class="attribute">-webkit-min-device-pixel-ratio</span>: <span class="number">2</span>),</div><div class="line"><span class="variable">@media</span> only screen and (<span class="attribute">min-device-pixel-ratio</span>: <span class="number">2</span>) &#123;</div><div class="line">	<span class="comment">/* TODO ... */</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="è§£å†³ä¸€åƒç´ è¾¹æ¡†é—®é¢˜"><a href="#è§£å†³ä¸€åƒç´ è¾¹æ¡†é—®é¢˜" class="headerlink" title="è§£å†³ä¸€åƒç´ è¾¹æ¡†é—®é¢˜"></a>è§£å†³ä¸€åƒç´ è¾¹æ¡†é—®é¢˜</h2><h3 id="åˆ†æé—®é¢˜"><a href="#åˆ†æé—®é¢˜" class="headerlink" title="åˆ†æé—®é¢˜"></a>åˆ†æé—®é¢˜</h3><p>äº†è§£äº†ä»¥ä¸Šè¿™äº›åŸºæœ¬æ¦‚å¿µï¼Œæˆ‘å°±çŸ¥é“è®¾ç½®è¾¹æ¡†ä¸€åƒç´  <code>border: 1px solid #e1e0e0;</code> ï¼Œåœ¨é«˜æ¸…å±ä¸­å±•ç¤ºå¤§äºä¸€åƒç´ çš„åŸå› äº†ï¼Œå› ä¸º <code>devicePixelRatio</code> è¿™ä¸ªå®¶ä¼™å¯¼è‡´çš„ï¼Œç”±æ­¤æˆ‘ä»¬ä¼šå¿«å°±å†™å‡ºå¦‚ä¸‹è§£å†³æ–¹æ¡ˆï¼š<br><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">div</span> &#123;</div><div class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#e1e0e0</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@media</span> only screen and (<span class="attribute">-webkit-min-device-pixel-ratio</span>: <span class="number">2</span>),</div><div class="line"><span class="variable">@media</span> only screen and (<span class="attribute">min-device-pixel-ratio</span>: <span class="number">2</span>) &#123;</div><div class="line">    <span class="selector-tag">div</span> &#123;</div><div class="line">        <span class="attribute">border</span>: <span class="number">0.5px</span> solid <span class="number">#e1e0e0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">@media</span> only screen and (<span class="attribute">-webkit-min-device-pixel-ratio</span>: <span class="number">3</span>),</div><div class="line"><span class="variable">@media</span> only screen and (<span class="attribute">min-device-pixel-ratio</span>: <span class="number">3</span>) &#123;</div><div class="line">    <span class="selector-tag">div</span> &#123;</div><div class="line">        <span class="attribute">border</span>: <span class="number">0.3333px</span> solid <span class="number">#e1e0e0</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨ <code>devicePixelRatio</code> ä¸º 2 çš„æ—¶å€™ï¼Œè®¾ç½®è¾¹æ¡†ä¸º <code>0.5px</code>ï¼›åœ¨ <code>devicePixelRatio</code> ä¸º 2 çš„æ—¶å€™ï¼Œè®¾ç½®è¾¹æ¡†ä¸º <code>0.3333px</code>ã€‚ä½†æ˜¯è¦æ³¨æ„æœ‰äº› Retina å±çš„æµè§ˆå™¨å¯èƒ½ä¸è®¤è¯† <code>0.5px</code> çš„è¾¹æ¡†ï¼Œå°†ä¼šæŠŠå®ƒè§£ææˆ <code>0px</code>ï¼Œè¿™æ ·å°±æ²¡æœ‰è¾¹æ¡†äº†ã€‚</p>
<h3 id="ç»ˆæè§£å†³æ–¹æ¡ˆ"><a href="#ç»ˆæè§£å†³æ–¹æ¡ˆ" class="headerlink" title="ç»ˆæè§£å†³æ–¹æ¡ˆ"></a>ç»ˆæè§£å†³æ–¹æ¡ˆ</h3><p>åˆ©ç”¨ä¼ªå…ƒç´  <code>before/after</code>  <code>transform</code> æ¥å®ç°ï¼Œå…¶æµè§ˆå™¨å…¼å®¹æ€§éå¸¸å¥½ ğŸ‘<br><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"onePixelBorder"</span>&gt;</div><div class="line">    One Pixel Border</div><div class="line">&lt;/<span class="keyword">div</span>&gt;</div></pre></td></tr></table></figure></p>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/9C362BA4-4C66-4590-BED9-6DCE84EA2232.png" alt=""></p>
<p>å•ä¸€è¾¹æ¡†ï¼š<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.onePixelBorder</span> &#123;</div><div class="line">    <span class="attribute">position</span>: relative;</div><div class="line">    <span class="attribute">display</span>: inline-block;</div><div class="line">    <span class="attribute">font-size</span>: <span class="number">40px</span>;</div><div class="line">    <span class="attribute">color</span>: <span class="number">#2C2C2C</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="selector-class">.onePixelBorder</span><span class="selector-pseudo">:after</span> &#123;</div><div class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</div><div class="line">    <span class="attribute">position</span>: absolute;</div><div class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">1px</span>;</div><div class="line">    <span class="attribute">background-color</span>: <span class="number">#2C2C2C</span>;</div><div class="line">    <span class="attribute">-webkit-transform-origin</span>: center bottom;</div><div class="line">    <span class="attribute">transform-origin</span>: center bottom;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@<span class="keyword">media</span> only screen and (-webkit-min-device-pixel-ratio: <span class="number">2</span>),</div><div class="line">@media only screen and (min-device-pixel-ratio: <span class="number">2</span>) &#123;</div><div class="line">    <span class="selector-class">.onePixelBorder</span><span class="selector-pseudo">:after</span> &#123;</div><div class="line">        <span class="attribute">-webkit-transform</span>: <span class="built_in">scaleY</span>(.5);</div><div class="line">        <span class="attribute">transform</span>: <span class="built_in">scaleY</span>(.5);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">@<span class="keyword">media</span> only screen and (-webkit-min-device-pixel-ratio: <span class="number">3</span>),</div><div class="line">@media only screen and (min-device-pixel-ratio: <span class="number">3</span>) &#123;</div><div class="line">    <span class="selector-class">.onePixelBorder</span><span class="selector-pseudo">:after</span> &#123;</div><div class="line">        <span class="attribute">-webkit-transform</span>: <span class="built_in">scaleY</span>(.333);</div><div class="line">        <span class="attribute">transform</span>: <span class="built_in">scaleY</span>(.333);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>å››è¾¹è¾¹æ¡†ï¼š<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.onePixelBorder</span> &#123;</div><div class="line">    <span class="attribute">position</span>: relative;</div><div class="line">    <span class="attribute">display</span>: inline-block;</div><div class="line">    <span class="attribute">font-size</span>: <span class="number">40px</span>;</div><div class="line">    <span class="attribute">color</span>: <span class="number">#2C2C2C</span>;</div><div class="line"></div><div class="line">&#125;</div><div class="line"><span class="selector-class">.onePixelBorder</span><span class="selector-pseudo">:after</span> &#123;</div><div class="line">    <span class="attribute">content</span>: <span class="string">''</span>;</div><div class="line">    <span class="attribute">position</span>: absolute;</div><div class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</div><div class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#2C2C2C</span>;</div><div class="line">    <span class="attribute">-webkit-transform-origin</span>: left top;</div><div class="line">    <span class="attribute">transform-origin</span>: left top;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@<span class="keyword">media</span> only screen and (-webkit-min-device-pixel-ratio: <span class="number">2</span>),</div><div class="line">@media only screen and (min-device-pixel-ratio: <span class="number">2</span>) &#123;</div><div class="line">    <span class="selector-class">.onePixelBorder</span><span class="selector-pseudo">:after</span> &#123;</div><div class="line">        <span class="attribute">width</span>: <span class="number">200%</span>;</div><div class="line">        <span class="attribute">height</span>: <span class="number">200%</span>;</div><div class="line">        <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(.5);</div><div class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(.5);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">@<span class="keyword">media</span> only screen and (-webkit-min-device-pixel-ratio: <span class="number">3</span>),</div><div class="line">@media only screen and (min-device-pixel-ratio: <span class="number">3</span>) &#123;</div><div class="line">    <span class="selector-class">.onePixelBorder</span><span class="selector-pseudo">:after</span> &#123;</div><div class="line">        <span class="attribute">width</span>: <span class="number">300%</span>;</div><div class="line">        <span class="attribute">height</span>: <span class="number">300%</span>;</div><div class="line">        <span class="attribute">-webkit-transform</span>: <span class="built_in">scale</span>(.333);</div><div class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(.333);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ³¨æ„åˆ°ä»¥ä¸Šé€šè¿‡ CSS åª’ä½“æŸ¥è¯¢è·çŸ¥å½“å‰å±å¹•çš„ <code>devicePixelRatio</code>ï¼Œç„¶åé’ˆå¯¹ä¸åŒçš„ <code>devicePixelRatio</code> è¿›è¡Œå¤„ç†ã€‚è¿˜æœ‰ä¸€ç§å¦ä¸€ç§æ–¹å¼ï¼Œé€šè¿‡ JS åœ¨ HTML èŠ‚ç‚¹æ·»åŠ  class è¡¨å¾ä¸åŒçš„ <code>devicePixelRatio</code>ï¼Œä¾‹å¦‚åœ¨ framework7 æ¡†æ¶ä¸­ï¼Œ HTML èŠ‚ç‚¹å°±æ·»åŠ äº† <code>devicePixelRatio</code> æœ‰å…³çš„ class:</p>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/BED6EAE5-B9D5-45B2-A22E-A1B698ECFED1.png" alt=""></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://www.smashingmagazine.com/2012/08/towards-retina-web/" target="_blank" rel="external">Towards A Retina Web</a><br><a href="https://www.quirksmode.org/blog/archives/2012/07/more_about_devi.html" target="_blank" rel="external">More about devicePixelRatio</a><br><a href="https://jinlong.github.io/2015/05/24/css-retina-hairlines/" target="_blank" rel="external">Retinaå±çš„ç§»åŠ¨è®¾å¤‡å¦‚ä½•å®ç°çœŸæ­£1pxçš„çº¿ï¼Ÿ</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/retinaDisplayMagnified_1159x285@2x.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="CSS" scheme="http://objcer.com/categories/CSS/"/>
    
    
      <category term="devicePixelRatio" scheme="http://objcer.com/tags/devicePixelRatio/"/>
    
  </entry>
  
  <entry>
    <title>Cordova ä»£ç çƒ­æ›´æ–°</title>
    <link href="http://objcer.com/2017/06/18/cordova-hot-code-push/"/>
    <id>http://objcer.com/2017/06/18/cordova-hot-code-push/</id>
    <published>2017-06-17T16:30:29.000Z</published>
    <updated>2017-06-17T16:32:56.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/app-store.png" alt=""></p>
<p>åŸºäº Cordova æ¡†æ¶èƒ½å°†ç½‘é¡µåº”ç”¨ (js, html, css, å›¾ç‰‡ç­‰) æ‰“åŒ…æˆ Appã€‚å½“ App åœ¨åº”ç”¨å•†åº—ä¸Šæ¶åï¼Œå¦‚ä½•å¿«é€Ÿæ›´æ–°æ˜¯æˆ‘ä»¬éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚ğŸ¤–</p>
<ul>
<li>æœ¬åœ°æ‰“åŒ…æ–°ç‰ˆæœ¬ App å‘å¸ƒåˆ°åº”ç”¨å•†åº—ï¼Œä½†è¿™ä¸­å‘å¸ƒæµç¨‹è€—è´¹æ—¶é—´ï¼Œå°¤å…¶æ˜¯ Apple Store</li>
<li>åº”ç”¨åŠ è½½ç½‘ç»œèµ„æºï¼Œè¿™æ · App å±•ç¤ºçš„å†…å®¹å°±å¯ä»¥ä¿è¯æ˜¯æœ€æ–°çš„ï¼Œä½†å½“åº”ç”¨æ–­ç½‘æ—¶ï¼Œåº”ç”¨å°±æ— æ³•æ­£å¸¸ä½¿ç”¨</li>
</ul>
<p>æˆ‘ä»¬èƒ½æƒ³çš„è¿™ä¸¤ç§æ–¹å¼éƒ½å­˜åœ¨çš„å¾ˆå¤§çš„å¼Šç«¯ï¼Œä¸é€‚åˆå®é™…åº”ç”¨ï¼</p>
<a id="more"></a>
<h2 id="æ’ä»¶-Cordova-Hot-Code-Push-CHCP"><a href="#æ’ä»¶-Cordova-Hot-Code-Push-CHCP" class="headerlink" title="æ’ä»¶ Cordova Hot Code Push (CHCP)"></a>æ’ä»¶ Cordova Hot Code Push (CHCP)</h2><p>æ’ä»¶ <strong><a href="https://github.com/nordnet/cordova-hot-code-push" target="_blank" rel="external">Cordova Hot Code Push</a></strong> æ­£æ˜¯é’ˆå¯¹ Cordava åº”ç”¨å¦‚ä½•å¿«é€Ÿæ›´æ–°é—®é¢˜è€Œæä¾›çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥è‡ªåŠ¨æ›´æ–° web ç›¸å…³çš„é™æ€æ–‡ä»¶ã€‚</p>
<blockquote>
<p>è¯¥æ’ä»¶æä¾›äº†è¯¦ç»†çš„ wiki æ–‡æ¡£ï¼Œè¯·å‚è€ƒï¼š<a href="https://github.com/nordnet/cordova-hot-code-push/wiki" target="_blank" rel="external">wiki æ–‡æ¡£</a></p>
</blockquote>
<h2 id="App-Store-æ”¯æŒä¹ˆ"><a href="#App-Store-æ”¯æŒä¹ˆ" class="headerlink" title="App Store æ”¯æŒä¹ˆ"></a>App Store æ”¯æŒä¹ˆ</h2><blockquote>
<p>è¿‘æ—¥ï¼Œè‹¹æœApp Storeå®¡æ ¸å›¢é˜Ÿå‘ä¸€äº›å¼€å‘è€…ä¸‹æœ€åé€šç‰’ï¼š2017å¹´6æœˆ12æ—¥ä¹‹å‰ç§»é™¤æ‰€æœ‰çƒ­æ›´æ–°ç›¸å…³ä»£ç ã€æ¡†æ¶æˆ–SDKï¼Œå¹¶é‡æ–°æäº¤ç‰ˆæœ¬ã€‚å¦‚æœä¸ä½œè°ƒæ•´ï¼ŒAppå¯èƒ½ä¼šä»App Storeä¸‹æ¶ã€‚</p>
</blockquote>
<p>è‹¹æœåº”ç”¨å•†åº—å·²ç»ç¦æ­¢ä½¿ç”¨ç±»ä¼¼ JSPatch ç­‰çƒ­ä¿®å¤çš„æ¡†æ¶æˆ–è€…SDKï¼Œé‚£ä¹ˆè¿™ä¸ªæ’ä»¶æä¾›çš„ä»£ç çƒ­æ›´æ–°åŠŸèƒ½æ˜¯å¦è¿æ³•è¿™ä¸€è§„å®šå‘¢? ğŸ¤”<br>ğŸ“Œ ç­”æ¡ˆæ˜¯å¦å®šçš„ï¼æ­¤æ’ä»¶æä¾›çš„ä»£ç çƒ­æ›´æ–°æ˜¯ web é™æ€æ–‡ä»¶ï¼Œè‹¹æœæ˜¯å…è®¸è¿™ä¸€åšæ³•çš„ã€‚ä½†æœ‰ä¸¤ç‚¹å€¼å¾—æ³¨æ„ï¼š</p>
<ul>
<li>â‘  ä¸èƒ½æ˜æ˜¾å‘ŠçŸ¥ç”¨æˆ·æœ‰æ–°ç‰ˆæœ¬å¯ç”¨ï¼Œè¯¢é—®ç”¨æˆ·æ˜¯å¦éœ€è¦æ›´æ–°åˆ°æœ€æ–°ä»£ç ã€‚è¿™ä¸€åšæ³•ä¼šä½¿ç”¨æˆ·äº§ç”Ÿå›°æƒ‘ï¼Œè¿™ç§æ›´æ–°æ–¹å¼å’Œé€šè¿‡ App Store æ›´æ–°æœ‰ä½•åŒºåˆ«ã€‚æ‰€ä»¥æ­£ç¡®çš„åšæ³•æ˜¯ï¼Œåœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¸‹è½½å’Œå®‰è£…çƒ­æ›´æ–°ä»£ç ï¼›æˆ–è€…åœ¨æŸä¸ªæ—¶æœºä¸‹è½½çƒ­æ›´æ–°ä»£ç ï¼Œåœ¨åº”ç”¨ä¸‹æ¬¡æ‰“å¼€æ—¶è¿›è¡Œå®‰è£…</li>
<li>â‘¡ å¦‚æœé€šè¿‡æ­¤æ’ä»¶è¿›è¡Œä»£ç çƒ­æ›´æ–°åï¼Œåº”ç”¨åŠŸèƒ½å‘ç”Ÿå·¨å¤§å˜åŒ–ï¼Œè­¬å¦‚åŸæ¥æ˜¯ä¸€ä¸ªè®¡ç®—å™¨åº”ç”¨ï¼Œä»£ç çƒ­æ›´æ–°åï¼Œå˜æˆäº†ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨ï¼Œè¿™ç§æ¬ºéª—ç”¨æˆ·çš„åšæ³•ä¹Ÿæ˜¯ä¼šè¢«è‹¹æœæ‹’ç»çš„</li>
</ul>
<h2 id="æ·»åŠ æ’ä»¶åˆ°é¡¹ç›®ä¸­"><a href="#æ·»åŠ æ’ä»¶åˆ°é¡¹ç›®ä¸­" class="headerlink" title="æ·»åŠ æ’ä»¶åˆ°é¡¹ç›®ä¸­"></a>æ·»åŠ æ’ä»¶åˆ°é¡¹ç›®ä¸­</h2><p>1ã€ä¸‹è½½æ’ä»¶<br><em>è¦æ±‚ Cordova ç‰ˆæœ¬ 5.0+</em><br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">cordova</span> plugin <span class="keyword">add </span>cordova-hot-<span class="meta">code</span>-<span class="keyword">push-plugin </span>--save</div></pre></td></tr></table></figure></p>
<p>2ã€ä¸‹è½½æ’ä»¶çš„å‘½ä»¤è¡Œå·¥å…· <a href="https://github.com/nordnet/cordova-hot-code-push-cli" target="_blank" rel="external">cordova-hot-code-push-cli</a><br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install -g cordova-hot-code-<span class="keyword">push</span>-<span class="keyword">cli</span></div></pre></td></tr></table></figure></p>
<p>è¯¥å‘½ä»¤è¡Œå·¥å…·å¯å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ç”Ÿæˆé…ç½®æ–‡ä»¶ <code>chcp.json</code> å’Œ <code>chcp.manifest</code>ï¼ŒåŒæ—¶è¿˜æä¾›äº†ä¸€äº›å…¶ä»–åŠŸèƒ½ï¼Œè¯¦ç»†å¯å‚è€ƒå…¶ READMEã€‚</p>
<p>3ã€ä¸‹è½½æ’ä»¶åï¼Œæ‰§è¡Œ <code>cordova platform add ios</code> æ—¶å¯èƒ½ä¼šé‡åˆ°å¦‚ä¸‹æŠ¥é”™ï¼š<br><figure class="highlight subunit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Error: </span>Cannot find module 'xml2js/lib/processors'</div></pre></td></tr></table></figure></p>
<p>å‚è€ƒ <a href="https://github.com/nordnet/cordova-hot-code-push/issues/35" target="_blank" rel="external">xml2js is not installed</a> è§£å†³æ–¹æ³•å¾ˆç®€å•ï¼š<code>npm install xml2js</code></p>
<h2 id="çƒ­æ›´æ–°ç›¸å…³é…ç½®"><a href="#çƒ­æ›´æ–°ç›¸å…³é…ç½®" class="headerlink" title="çƒ­æ›´æ–°ç›¸å…³é…ç½®"></a>çƒ­æ›´æ–°ç›¸å…³é…ç½®</h2><p>Cordova Hot Code Push ä¸‹è½½å®‰è£…åˆ°é¡¹ç›®ä¸­åï¼Œéœ€è¦å¯¹å…¶è¿›è¡Œç›¸å…³çš„é…ç½®æ‰èƒ½è®©å…¶å·¥ä½œã€‚</p>
<h3 id="æ’ä»¶é…ç½®"><a href="#æ’ä»¶é…ç½®" class="headerlink" title="æ’ä»¶é…ç½®"></a>æ’ä»¶é…ç½®</h3><p>Cordova Hot Code Push çƒ­æ›´æ–°æ’ä»¶éœ€è¦ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼š</p>
<ul>
<li><strong>Application configï¼š</strong><code>chcp.json</code> åŒ…å«å‘å¸ƒç›¸å…³ä¿¡æ¯ï¼šçƒ­æ›´æ–°ä»£ç ç‰ˆæœ¬å·ï¼Œåº”ç”¨ native side ç‰ˆæœ¬å·ç­‰ç­‰</li>
<li><strong>Content manifestï¼š</strong><code>chcp.manifest</code> åŒ…å«é¡¹ç›®çƒ­æ›´æ–°ä»£ç (é™æ€)æ–‡ä»¶ä¿¡æ¯ï¼šæ–‡ä»¶åå’Œæ–‡ä»¶å“ˆå¸Œå€¼</li>
</ul>
<p>è¿™ä¸¤ä¸ªé…ç½®æ–‡ä»¶å¯¹äºæ’ä»¶çš„è¿è¡Œç¼ºä¸€ä¸å¯ï¼Œå‰è€…æè¿°äº†çƒ­æ›´æ–°ä»£ç çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œåè€…æä¾›äº†çƒ­æ›´æ–°ä»£ç æ–‡ä»¶çš„å˜æ›´ä¿¡æ¯ã€‚å€ŸåŠ© <code>cordova-hot-code-push-cli</code> è¿™ä¸ªå‘½ä»¤è¡Œå·¥å…·å¯ä»¥è¾…åŠ©æˆ‘ä»¬åˆ›å»ºè¿™ä¸¤ä¸ªé…ç½®æ–‡ä»¶ã€‚</p>
<h4 id="Application-config"><a href="#Application-config" class="headerlink" title="Application config"></a>Application config</h4><blockquote>
<p><a href="https://github.com/nordnet/cordova-hot-code-push/wiki/Application-config" target="_blank" rel="external">Application config</a> holds information about the current release of the web project.</p>
</blockquote>
<p><code>chcp.json</code> ç½®äº <code>www</code> ç›®å½•æ ¹ç›®å½•ï¼Œä¾‹å­å¦‚ä¸‹ï¼š<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"wps-*****"</span>,</div><div class="line">  <span class="attr">"content_url"</span>: <span class="string">"https://kss.ksyun.com/*****/*****/"</span>,</div><div class="line">  <span class="attr">"ios_identifier"</span>: <span class="string">"326CN*****"</span>,</div><div class="line">  <span class="attr">"android_identifier"</span>: <span class="string">"com.**********.*****.*****.*****.*****"</span>,</div><div class="line">  <span class="attr">"update"</span>: <span class="string">"resume"</span>,</div><div class="line">  <span class="attr">"release"</span>: <span class="string">"2017.06.07-16.30.20"</span>,</div><div class="line">  <span class="attr">"min_native_interface"</span>: <span class="number">1</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>1ã€é…ç½®é¡¹<br>â‘  <code>name</code> é¡¹ç›®åç§°<br>â‘¡ <code>content_url</code> web é¡¹ç›®æ–‡ä»¶åœ¨æœåŠ¡å™¨ä¸Šçš„å­˜å‚¨è·¯å¾„ï¼ˆå³ www ç›®å½•åœ¨äº‘å­˜å‚¨ä¸­çš„ç›®å½•è·¯å¾„ï¼‰ï¼Œçƒ­æ›´æ–°æ’ä»¶å°†æ­¤ URL ä½œä¸º base urlï¼Œç”¨äºä¸‹è½½é…ç½®æ–‡ä»¶å’Œé¡¹ç›®æ›´æ–°æ–‡ä»¶ï¼ˆå¿…éœ€çš„é…ç½®é¡¹ï¼‰<br>â‘¢ <code>release</code> æè¿° web é¡¹ç›®ç‰ˆæœ¬å·ï¼Œæ¯ä¸€æ¬¡å‘å¸ƒçš„ç‰ˆæœ¬å·å¿…é¡»å”¯ä¸€ï¼ˆé»˜è®¤ä½¿ç”¨æ—¶é—´æˆ³ï¼Œæ ¼å¼ä¸ºï¼šyyyy.MM.dd-HH.mm.ssï¼‰ï¼Œæ’ä»¶æ˜¯<strong>å°†ç‰ˆæœ¬å·è¿›è¡Œå­—ç¬¦ä¸²ç›¸ç­‰æ¯”è¾ƒ</strong>æ¥åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ–°ç‰ˆæœ¬ï¼ˆå¿…éœ€çš„é…ç½®é¡¹ï¼‰<br>â‘£ <code>min_native_interface</code></p>
<blockquote>
<p>Minimum version of the native side that is required to run this web content</p>
</blockquote>
<ul>
<li>cordova é¡¹ç›®ä¸»è¦åŒ…å«ä¸¤éƒ¨åˆ†ï¼šweb content å’Œ native sideã€‚å‰è€…æ˜¯ç½‘é¡µå†…å®¹ï¼Œåè€…æ˜¯ cordova æ’ä»¶ï¼Œä¸ºç½‘é¡µæä¾›åŸç”Ÿ API æ”¯æŒï¼Œweb content çš„è¿è¡Œæ˜¯åŸºäº native sideã€‚</li>
<li>è¯¥é…ç½®é¡¹æŒ‡æ˜ web content è¿è¡Œæ—¶ native side çš„æœ€ä½ç‰ˆæœ¬ã€‚åœ¨ native side ä»£ç æœ‰å˜æ›´åï¼ˆcordova æ’ä»¶æ–°å¢/åˆ é™¤ï¼Œnative side ç‰ˆæœ¬å·æ›´æ–°ï¼‰ï¼Œä¸ºäº†ç¡®ä¿ web content èƒ½æ­£å¸¸è¿è¡Œï¼Œéœ€è¦æ›´æ–° <code>min_native_interface</code> çš„å€¼</li>
</ul>
<p>åœ¨åº”ç”¨ <code>config.xml</code> é…ç½®ä¸­å¯ä»¥å®šä¹‰äº† native side çš„ç‰ˆæœ¬å·ï¼Œä¾‹å¦‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">chcp</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">native-interface</span> <span class="attr">version</span>=<span class="string">"5"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">chcp</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>ä¾‹å¦‚å½“å‰é¡¹ç›® native side çš„ç‰ˆæœ¬å·æ˜¯5ï¼š</p>
<ul>
<li>å¦‚æœæœåŠ¡å™¨ä¸Šé…ç½®æ–‡ä»¶ <code>chcp.json</code> ä¸­çš„ <code>min_native_interface</code> å€¼ä¸º 5ï¼Œé‚£ä¹ˆç¬¦åˆè¦æ±‚ï¼Œçƒ­æ›´æ–°åçš„ web content èƒ½å¤Ÿåœ¨æ­£å¸¸è¿è¡Œ</li>
<li>å¦‚æœæœåŠ¡å™¨ä¸Šé…ç½®æ–‡ä»¶ <code>chcp.json</code> ä¸­çš„ <code>min_native_interface</code> å€¼ä¸º 10ï¼Œé«˜äº <code>config.xml</code> æ–‡ä»¶ä¸­ <code>&lt;native-interface /&gt;</code>ï¼Œé‚£ä¹ˆçƒ­æ›´æ–°å°†æ— æ³•æ­£å¸¸è¿›è¡Œã€‚æ­¤æ—¶ï¼Œæ’ä»¶ä¼šæç¤ºé”™è¯¯ <code>chcp_updateLoadFailed</code>ï¼Œæç¤ºåº”ç”¨éœ€è¦æ›´æ–°å‡çº§</li>
</ul>
<p>â‘¤ <code>update</code> ä½•æ—¶è§¦å‘è¿›è¡Œå®‰è£…ï¼ˆinstallï¼‰ä»£ç çƒ­æ›´æ–°<br>ä»£ç çƒ­æ›´æ–°æ¶‰åŠä¸¤ä¸ªä¸»è¦è¿‡ç¨‹ï¼šfetch update å’Œ install updateã€‚å‰è€…è·å–çƒ­æ›´æ–°å˜æ›´æ–‡ä»¶ï¼Œåè€…å°†è·å–åˆ°çš„æ›´æ–°æ–‡ä»¶å®‰è£…åˆ° App ä¸­ç”Ÿæ•ˆã€‚æ­¤å­—æ®µæ˜¯é’ˆå¯¹åè€…ï¼Œä½•æ—¶ install updateï¼Œå¯é€‰å€¼ï¼š</p>
<ul>
<li><code>start</code>ï¼šåº”ç”¨å¯åŠ¨ï¼Œé»˜è®¤é¡¹ï¼ˆinstall update when application is launchedï¼‰</li>
<li><code>resume</code>ï¼šåº”ç”¨ä»åå°æ¢å¤ï¼ˆinstall the update when application is resumed from background stateï¼‰</li>
<li><code>now</code>ï¼šä¸‹è½½æ›´æ–°åç«‹å³æ‰§è¡Œï¼ˆinstall update as soon as it has been downloadedï¼‰</li>
</ul>
<p>å½“ç„¶ä¹Ÿå¯ä»¥ç¦ç”¨è‡ªåŠ¨ install updateï¼Œæ‰‹åŠ¨è°ƒç”¨ç›¸å…³ API è¿›è¡Œ install<br>â‘¥ <code>android_identifier</code> / <code>ios_identifier</code></p>
<ul>
<li><code>android_identifier</code>: Package name of the Android version of the application</li>
<li><code>ios_identifier</code>: Identification number of the application<br>ç”¨äºè·³è½¬åˆ° Google Play Store æˆ–è€… App Store è¯¥åº”ç”¨é¡µé¢</li>
</ul>
<p>2ã€å¦‚ä½•ç”Ÿæˆè¯¥æ–‡ä»¶ï¼š</p>
<ul>
<li>åœ¨ cordova é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ <code>cordova-hcp init</code> ï¼Œä¼šé€šè¿‡å‘½ä»¤è¡Œäº¤äº’çš„æ–¹å¼ï¼Œæç¤ºè¾“å…¥é…ç½®æœ‰å…³ä¿¡æ¯ï¼Œåˆ›å»ºè¯¥æ–‡ä»¶ï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªé»˜è®¤ Application config æ–‡ä»¶ <code>cordova-hcp.json</code></li>
<li>ç„¶ååœ¨æ¯æ¬¡åº”ç”¨æ‰“åŒ…æ—¶ï¼Œå†æ‰§è¡Œ <code>cordova-hcp build</code> å³å¯åœ¨ web é¡¹ç›® <code>www</code> æ ¹ç›®å½•ç”Ÿæˆä¸€ä¸ª <code>chcp.json</code> æ–‡ä»¶ã€‚</li>
</ul>
<h4 id="Content-manifest"><a href="#Content-manifest" class="headerlink" title="Content manifest"></a>Content manifest</h4><blockquote>
<p>Content manifest describes the state of the files inside your web project.</p>
</blockquote>
<p>é€šè¿‡æ‰§è¡Œ <code>cordova-hcp build</code> åœ¨ <code>www</code> æ ¹ç›®å½•è‡ªåŠ¨ç”Ÿæˆ <code>chcp.manifest</code> æ–‡ä»¶<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">[</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"file"</span>: <span class="string">"import.html"</span>,</div><div class="line">    <span class="attr">"hash"</span>: <span class="string">"fc9301d4bd7381ba6033aa51884ed2dd"</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"file"</span>: <span class="string">"index.html"</span>,</div><div class="line">    <span class="attr">"hash"</span>: <span class="string">"f73630f62a531ab6c41cd067eb4f9b07"</span></div><div class="line">  &#125;,</div><div class="line">  &#123;</div><div class="line">    <span class="attr">"file"</span>: <span class="string">"lib/lib.min.js"</span>,</div><div class="line">    <span class="attr">"hash"</span>: <span class="string">"6ecb0251f4c54f80586d9059dfc61de8"</span></div><div class="line">  &#125;,</div><div class="line">  ...</div><div class="line">]</div></pre></td></tr></table></figure></p>
<p><code>chcp.manifest</code> æ–‡ä»¶ä¸­åŒ…å«çš„æ˜¯ web content é™æ€æ–‡ä»¶ä¿¡æ¯ï¼Œæ¯ä¸€ä¸ªé¡¹éƒ½åŒ…æ‹¬ä¸¤ä¸ªå­—æ®µï¼š</p>
<ul>
<li><code>file</code>: ç›¸å¯¹äº <code>www</code> ç›®å½•çš„æ–‡ä»¶è·¯å¾„</li>
<li><code>hash</code>: æ–‡ä»¶çš„ MD5 å“ˆå¸Œå€¼ï¼Œç”¨äºåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å‘ç”Ÿå˜æ›´</li>
</ul>
<p>åŸºäº <code>chcp.manifest</code> æ–‡ä»¶</p>
<ul>
<li>åœ¨ fetch update é˜¶æ®µï¼Œä»æœåŠ¡å™¨ä¸Šè·å–æ–°å¢ã€ä¿®æ”¹æ–‡ä»¶</li>
<li>åœ¨ install update é˜¶æ®µï¼Œç§»é™¤è¢«åˆ é™¤æ–‡ä»¶</li>
</ul>
<h3 id="Cordova-config-xml-é…ç½®"><a href="#Cordova-config-xml-é…ç½®" class="headerlink" title="Cordova config.xml é…ç½®"></a>Cordova <code>config.xml</code> é…ç½®</h3><p>Cordova é¡¹ç›®çš„ <code>config.xml</code> æ–‡ä»¶ç”¨äºè®¾ç½®é¡¹ç›®é…ç½®é€‰é¡¹ï¼ŒCordova Hot Code Push çƒ­æ›´æ–°æ’ä»¶çš„é…ç½®é¡¹ä¹Ÿéœ€è¦åœ¨è¯¥æ–‡ä»¶ä¸­è¿›è¡Œç›¸åº”çš„é…ç½®ã€‚<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">chcp</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">config-file</span> <span class="attr">url</span>=<span class="string">"https://kss.ksyun.com/********/chcp.json"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">auto-download</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">auto-install</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">native-interface</span> <span class="attr">version</span>=<span class="string">"1"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">chcp</span>&gt;</span></div></pre></td></tr></table></figure></p>
<ul>
<li><code>config-file</code>ï¼šé…ç½®æ–‡ä»¶ <code>chcp.json</code> ä»æœåŠ¡å™¨ä¸ŠåŠ è½½çš„è·¯å¾„ï¼ˆå¿…é¡»çš„é…ç½®é¡¹ï¼‰</li>
<li><code>auto-download</code>ï¼šæ˜¯å¦è‡ªåŠ¨ä¸‹è½½çƒ­æ›´æ–°ä»£ç ï¼Œé»˜è®¤æ˜¯ true</li>
<li><code>auto-install</code>ï¼šæ˜¯å¦è‡ªåŠ¨å®‰è£…çƒ­æ›´æ–°ä»£ç ï¼Œé»˜è®¤æ˜¯ true</li>
<li><code>native-interface</code>ï¼šå½“å‰ native side çš„ç‰ˆæœ¬å·</li>
</ul>
<p>å¯ä»¥ç¦ç”¨è‡ªåŠ¨ä¸‹è½½ï¼Œå®‰è£…çƒ­æ›´æ–°ä»£ç ï¼Œé€šè¿‡æ‰‹åŠ¨è°ƒç”¨æ‰§è¡Œã€‚</p>
<h2 id="ä»£ç çƒ­æ›´æ–°åŸç†"><a href="#ä»£ç çƒ­æ›´æ–°åŸç†" class="headerlink" title="ä»£ç çƒ­æ›´æ–°åŸç†"></a>ä»£ç çƒ­æ›´æ–°åŸç†</h2><h3 id="çƒ­æ›´æ–°æµç¨‹"><a href="#çƒ­æ›´æ–°æµç¨‹" class="headerlink" title="çƒ­æ›´æ–°æµç¨‹"></a>çƒ­æ›´æ–°æµç¨‹</h3><p><img src="http://7vikhl.com1.z0.glb.clouddn.com/update-workflow.png" alt=""></p>
<ul>
<li>â‘  åº”ç”¨å¯åŠ¨</li>
<li>â‘¡ çƒ­æ›´æ–°æ’ä»¶åˆå§‹åŒ–ï¼Œå¹¶åœ¨åå°åŠ è½½æ›´æ–°æ¨¡å— (update loader)</li>
<li>â‘¢ æ›´æ–°æ¨¡å— (update loader) ä» Cordova é¡¹ç›®é…ç½® <code>config.xml</code> æ–‡ä»¶ä¸­è·å– <code>config-file</code> ï¼ˆçƒ­æ›´æ–°æ’ä»¶é…ç½®æ–‡ä»¶ <code>chcp.json</code> çš„åŠ è½½è·¯å¾„ï¼‰ï¼Œç„¶ååŠ è½½é…ç½®æ–‡ä»¶ <code>chcp.json</code>ï¼Œè·å–å…¶ä¸­çš„ <code>release</code> ç‰ˆæœ¬å·ï¼Œå¯¹æ¯”å½“å‰çš„ç‰ˆæœ¬å·ï¼Œè‹¥äºŒè€…ä¸åŒï¼Œè¯´æ˜æœ‰æ–°ç‰ˆæœ¬ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥</li>
<li>â‘£ æ›´æ–°æ¨¡å— (update loader) ä» <code>chcp.json</code> é…ç½®æ–‡ä»¶ä¸­è·å– <code>content_url</code> ä½œä¸º base urlï¼Œç„¶ååŠ è½½ <code>chcp.manifest</code> æ–‡ä»¶ï¼Œæˆ–è€…æ–°ç‰ˆæœ¬æ–‡ä»¶å˜æ›´ä¿¡æ¯</li>
<li>â‘¤ æ›´æ–°æ¨¡å— (update loader) æ ¹æ® <code>content_url</code> ä½œä¸º base urlï¼Œä¸‹è½½æ‰€æœ‰å˜æ›´ã€æ–°å¢æ–‡ä»¶</li>
<li>â‘¥ å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œ æ›´æ–°æ¨¡å— (update loader) å‘é€é€šçŸ¥ï¼Œè¯¥æ›´æ–°å·²å‡†å¤‡å¥½è¿›è¡Œå®‰è£…</li>
<li>â‘¦ å®‰è£…æ›´æ–°ï¼Œåº”ç”¨é‡å®šå‘åˆ°æ–°ç‰ˆæœ¬é¡µé¢</li>
</ul>
<h3 id="Cordova-web-project-å­˜å‚¨ä¸æ›´æ–°"><a href="#Cordova-web-project-å­˜å‚¨ä¸æ›´æ–°" class="headerlink" title="Cordova web project å­˜å‚¨ä¸æ›´æ–°"></a>Cordova web project å­˜å‚¨ä¸æ›´æ–°</h3><p>Cordova é¡¹ç›®ä¸­éƒ½åŒ…å«ä¸€ä¸ª <code>www</code> ç›®å½•ï¼Œå­˜å‚¨ç½‘é¡µé™æ€æ–‡ä»¶ï¼ŒCordova æ‰“åŒ…ç§»åŠ¨åº”ç”¨æ—¶ï¼Œä¼šå°†å…¶æ‹·è´åˆ°å„è‡ªçš„é¡¹ç›®ç›®å½•ï¼ŒåŒæ—¶ä¼šè¢«æ‰“åŒ…åˆ°åº”ç”¨ä¸­ã€‚</p>
<ul>
<li>Android: platforms/android/assets/www.</li>
<li>iOS: platforms/ios/www.</li>
</ul>
<p><code>www</code> ç›®å½•æ‰“åŒ…åˆ°åº”ç”¨ä¸­ä¹‹åï¼Œæˆ‘ä»¬å°±æ²¡åŠæ³•å¯¹å…¶è¿›è¡Œæ›´æ–°äº†ï¼Œå› ä¸ºåªæœ‰å¯è¯»æƒé™ã€‚ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œåœ¨åº”ç”¨ç¬¬ä¸€æ¬¡å¯åŠ¨çš„æ—¶å€™ï¼Œä»åº”ç”¨ bundle ä¸­åŠ è½½ç½‘é¡µå†…å®¹çš„åŒæ—¶ï¼Œå°† <code>www</code> ç›®å½•æ‹·è´åˆ°å¤–éƒ¨ç›®å½•ä¸­ï¼Œåœ¨åç»­åº”ç”¨å¯åŠ¨æ—¶ï¼Œéƒ½ä»è¿™ä¸ªå¤–éƒ¨å­˜å‚¨çš„é™æ€æ–‡ä»¶ä¸­åŠ è½½æ–‡ä»¶ï¼Œè€Œå¯¹äºå¤–éƒ¨çš„è¿™ä¸ªå­˜å‚¨ç›®å½•ï¼Œæˆ‘ä»¬å°±æœ‰è¯»å†™æƒé™ï¼Œè¿™æ ·å°±ä¸ºæˆ‘ä»¬åŠ¨æ€æ›´æ–°ç½‘é¡µä»£ç æä¾›äº†å¯èƒ½ã€‚</p>
<p>åœ¨ safari è°ƒè¯•é¡µé¢æ‰§è¡Œ <code>cordova.file.applicationStorageDirectory</code> å¯ä»¥å¾—åˆ°åº”ç”¨çš„å­˜å‚¨è·¯å¾„ï¼Œç‚¹å‡»å¯ä»¥æ‰“å¼€ Finder ç›®å½•ã€‚<br>ä» <code>Library/Application Support</code> ç›®å½•ä¸‹å°±å¯ä»¥æ‰¾åˆ°å­˜å‚¨ web content çš„å¤–éƒ¨ç›®å½•ã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/chcp-external-folder.png" alt=""><br><img src="http://7vikhl.com1.z0.glb.clouddn.com/3CA8CB1D-C26D-4F98-951C-DBE94650CA5D.png" alt=""></p>
<p>Cordova Hot Code Push æ’ä»¶ä¸ºæ¯ä¸€ä¸ªç‰ˆæœ¬å†…å®¹éƒ½åˆ›å»ºäº†ä¸€ä¸ªå¯¹åº”çš„ç›®å½•ï¼Œä»¥é…ç½®æ–‡ä»¶ <code>chcp.json</code> ä¸­ <code>release</code> å­—æ®µå€¼ä¸ºç›®å½•åï¼Œå­˜æ”¾ä¸åŒç‰ˆæœ¬ <code>www</code> ç›®å½•ä¸­çš„é™æ€æ–‡ä»¶ï¼Œè¿™ç§å¤„ç†æ–¹å¼çš„å¥½å¤„æ˜¯ï¼š</p>
<ul>
<li>é¿å…äº†æ–‡ä»¶ç¼“å­˜é—®é¢˜ã€‚ä¾‹å¦‚ iOS UIWebView ç¼“å­˜ css æ–‡ä»¶ï¼Œå³ä½¿åˆ·æ–°é¡µé¢ï¼Œä¹Ÿä¸ä¼šæ¸…é™¤ç¼“å­˜ï¼Œé™¤éé‡å¯åº”ç”¨æ‰èƒ½å¼ºåˆ¶æ¸…é™¤ç¼“å­˜ã€‚ä¸åŒç‰ˆæœ¬ç½®äºä¸åŒçš„ç›®å½•ï¼Œç”±äºåŠ è½½è·¯å¾„ä¸åŒï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³æ–‡ä»¶çš„ç¼“å­˜é—®é¢˜</li>
<li>é¿å…åœ¨æ›´æ–°ä»£ç æ–‡ä»¶æ—¶ï¼Œå’Œå½“å‰å·²æœ‰æ–‡ä»¶å‡ºç°å†²çª</li>
<li>æ–¹ä¾¿å›æ»šåˆ°å‰ä¸€ä¸ªç‰ˆæœ¬</li>
</ul>
<p>ğŸ¤– ä¸‹é¢äº†è§£ä¸€ä¸‹ï¼Œè·å–æ›´æ–°å†…å®¹å’Œå®‰è£…æ›´æ–°å†…å®¹æ—¶éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</p>
<p><strong>1ã€è·å–æ›´æ–°å†…å®¹</strong></p>
<ul>
<li>æ ¹æ® <code>release</code> ç‰ˆæœ¬å·ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•</li>
<li>åœ¨æ–°ç›®å½•ä¸­ï¼Œåˆ›å»º <code>update</code> ç›®å½•ï¼Œæ ¹æ® <code>chcp.manifest</code> æ–‡ä»¶ï¼Œå°†æ‰€æœ‰å˜æ›´ã€æ–°å¢æ–‡ä»¶ä¸‹è½½åˆ°è¯¥ç›®å½•ä¸­</li>
<li>æ–°ç‰ˆæœ¬å¯¹åº”çš„ <code>chcp.json</code> å’Œ <code>chcp.manifest</code> æ–‡ä»¶ä¹Ÿä¼šç½®äº <code>update</code> ç›®å½•ä¸­</li>
</ul>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/926064F1-2CF2-4871-90B6-791BA0059C13.png" alt=""></p>
<p><strong>2ã€å®‰è£…æ›´æ–°å†…å®¹</strong></p>
<ul>
<li>å°†å½“å‰ç‰ˆæœ¬å¯¹åº”ç›®å½•ä¸‹çš„ <code>www</code> ç›®å½•æ‹·è´åˆ°æ–°ç‰ˆæœ¬å¯¹åº”çš„ç›®å½•ä¸‹</li>
<li>åœ¨æ–°ç‰ˆæœ¬å¯¹åº”ç›®å½•ä¸‹ï¼Œå°† <code>update</code> ç›®å½•ä¸­å˜æ›´ã€æ–°å¢æ–‡ä»¶æ‹·è´åˆ° <code>www</code> ç›®å½•ä¸­ï¼ŒåŒæ—¶æ ¹æ® <code>chcp.manifest</code> ç§»é™¤è¢«åˆ é™¤æ–‡ä»¶</li>
<li>ç§»é™¤ <code>update</code> ç›®å½•</li>
<li>åº”ç”¨é‡å®šå‘åˆ°æ–°ç‰ˆæœ¬ç›®å½•ä¸‹åŠ è½½ç½‘é¡µå†…å®¹</li>
</ul>
<h2 id="æ’ä»¶-JS-æ¥å£"><a href="#æ’ä»¶-JS-æ¥å£" class="headerlink" title="æ’ä»¶ JS æ¥å£"></a>æ’ä»¶ JS æ¥å£</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCordova Hot Code Push (CHCP) æ’ä»¶ä¸éœ€è¦é¢å¤–çš„ä»£ç ï¼Œå°±å¯ä»¥è‡ªåŠ¨æ‰§è¡Œ <code>checking-&gt;downloading-&gt;installation</code> è¿™ä¸ªæ›´æ–°å¾ªç¯ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡å…¶æä¾›çš„æ¥å£æ¥æ§åˆ¶è¿™æ›´æ–°æµç¨‹ï¼Œè¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨é¡¹ç›® <code>config.xml</code> æ–‡ä»¶ä¸­é…ç½® <code>auto-download</code> å’Œ <code>auto-install</code> ä¸º <code>false</code><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">chcp</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">config-file</span> <span class="attr">url</span>=<span class="string">"https://kss.ksyun.com/******/chcp.json"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">auto-download</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">auto-install</span> <span class="attr">enabled</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">native-interface</span> <span class="attr">version</span>=<span class="string">"1"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">chcp</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="äº‹ä»¶ç›‘å¬"><a href="#äº‹ä»¶ç›‘å¬" class="headerlink" title="äº‹ä»¶ç›‘å¬"></a>äº‹ä»¶ç›‘å¬</h3><p>Cordova Hot Code Push æ’ä»¶æä¾›äº†ä¸€ç³»åˆ—äº‹ä»¶ç›‘å¬ï¼Œæ–¹ä¾¿æˆ‘ä»¬å¯¹ä¸åŒæƒ…å†µè¿›è¡Œä¸åŒçš„å¤„ç†ã€‚ä¾‹å¦‚ï¼š<code>chcp_updateInstalled</code> äº‹ä»¶ï¼Œå½“æ›´æ–°å®‰è£…å®Œæˆæ—¶ä¼šå‘å‡ºè¿™ä¸ªé€šçŸ¥ï¼›<code>chcp_updateInstallFailed</code> äº‹ä»¶ï¼Œå½“æ›´æ–°å®‰è£…å¤±è´¥æ—¶å‘å‡ºè¿™ä¸ªé€šçŸ¥ï¼Œç­‰ç­‰ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œéœ€è¦åœ¨ <code>deviceready</code> äº‹ä»¶å›è°ƒåï¼Œæ‰è¿›è¡Œ CHCP æ’ä»¶çš„äº‹ä»¶ç›‘å¬æ³¨å†Œã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = &#123;</div><div class="line"></div><div class="line">  <span class="comment">// Application Constructor</span></div><div class="line">  initialize: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.bindEvents();</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// Bind any events that are required.</span></div><div class="line">  <span class="comment">// Usually you should subscribe on 'deviceready' event to know, when you can start calling cordova modules</span></div><div class="line">  bindEvents: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">'deviceready'</span>, <span class="keyword">this</span>.onDeviceReady, <span class="literal">false</span>);</div><div class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">'chcp_updateIsReadyToInstall'</span>, <span class="keyword">this</span>.onUpdateReady, <span class="literal">false</span>);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// deviceready Event Handler</span></div><div class="line">  onDeviceReady: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Device is ready for work'</span>);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// chcp_updateIsReadyToInstall Event Handler</span></div><div class="line">  onUpdateReady: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Update is ready for installation'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">app.initialize();</div></pre></td></tr></table></figure></p>
<p>è¯¦ç»†äº‹ä»¶ç›‘å¬åˆ—è¡¨å‚è€ƒæ–‡æ¡£ï¼š<a href="https://github.com/nordnet/cordova-hot-code-push/wiki/Listen-for-update-events" target="_blank" rel="external">Listen for update events</a></p>
<h3 id="è·å–-å®‰è£…æ›´æ–°"><a href="#è·å–-å®‰è£…æ›´æ–°" class="headerlink" title="è·å–/å®‰è£…æ›´æ–°"></a>è·å–/å®‰è£…æ›´æ–°</h3><p>â‘  fetch update <code>chcp.fetchUpdate</code><br>è°ƒç”¨ API ä»æœåŠ¡å™¨ä¸­è·å–æ›´æ–°<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchUpdate</span><span class="params">(cb)</span></span> &#123;</div><div class="line">    var options = &#123;</div><div class="line">        <span class="string">'config-file'</span>: <span class="string">'https://kss.ksyun.com/******/chcp.json'</span></div><div class="line">    &#125;;</div><div class="line">    chcp.fetchUpdate(updateCallback, options);</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">updateCallback</span><span class="params">(error, data)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">error</span>) &#123;</div><div class="line">            console.<span class="built_in">log</span>(<span class="string">'--fetchUpdate error--'</span>, <span class="built_in">error</span>.code, <span class="built_in">error</span>.description);</div><div class="line">        &#125;</div><div class="line">        console.<span class="built_in">log</span>(<span class="string">'--fetchUpdate--'</span>, data, data.<span class="built_in">config</span>);</div><div class="line">        cb &amp;&amp; cb(<span class="built_in">error</span>, data);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>â‘¡ install update <code>chcp.installUpdate</code><br>è°ƒç”¨ API å®‰è£…æ›´æ–°<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">installUpdate</span><span class="params">(cb)</span></span> &#123;</div><div class="line">    chcp.installUpdate(installationCallback);</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">installationCallback</span><span class="params">(error)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">error</span>) &#123;</div><div class="line">            console.<span class="built_in">log</span>(<span class="string">'Failed to install the update with error code: '</span> + <span class="built_in">error</span>.code);</div><div class="line">            console.<span class="built_in">log</span>(<span class="built_in">error</span>.description);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            console.<span class="built_in">log</span>(<span class="string">'Update installed!'</span>);</div><div class="line">        &#125;</div><div class="line">        cb &amp;&amp; cb(<span class="built_in">error</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>åœ¨å®‰è£…æ›´æ–°ä¹‹å‰ï¼Œè¿˜éœ€è¦æ£€æµ‹æ˜¯å¦æœ‰æ›´æ–°å¯ç”¨äºå®‰è£…<br><code>chcp.isUpdateAvailableForInstallation</code><br><figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkIsUpdateAvailableForInstallation</span><span class="params">(cb)</span></span> &#123;</div><div class="line">    chcp.isUpdateAvailableForInstallation(callbackMethod);</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">callbackMethod</span><span class="params">(error, data)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">error</span>) &#123;</div><div class="line">            console.<span class="built_in">log</span>(<span class="string">'No update was loaded =&gt; nothing to install'</span>);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            console.<span class="built_in">log</span>(<span class="string">'Current content version: '</span> + data.currentVersion);</div><div class="line">            console.<span class="built_in">log</span>(<span class="string">'Ready to be installed:'</span> + data.readyToInstallVersion);</div><div class="line">        &#125;</div><div class="line">        cb &amp;&amp; cb(<span class="built_in">error</span>, data);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="è·å–ç‰ˆæœ¬ä¿¡æ¯"><a href="#è·å–ç‰ˆæœ¬ä¿¡æ¯" class="headerlink" title="è·å–ç‰ˆæœ¬ä¿¡æ¯"></a>è·å–ç‰ˆæœ¬ä¿¡æ¯</h3><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">function getVersionInfo(cb) &#123;</div><div class="line">    chcp.getVersionInfo((err, <span class="built_in">data</span>) =&gt; &#123;</div><div class="line">        console.<span class="keyword">log</span>(<span class="string">'Current web version: '</span> + <span class="built_in">data</span>.currentWebVersion);</div><div class="line">        console.<span class="keyword">log</span>(<span class="string">'Previous web version: '</span> + <span class="built_in">data</span>.previousWebVersion);</div><div class="line">        console.<span class="keyword">log</span>(<span class="string">'Loaded and ready for installation web version: '</span> + <span class="built_in">data</span>.readyToInstallWebVersion);</div><div class="line">        console.<span class="keyword">log</span>(<span class="string">'Application version name: '</span> + <span class="built_in">data</span>.appVersion);</div><div class="line">        console.<span class="keyword">log</span>(<span class="string">'Application build version: '</span> + <span class="built_in">data</span>.buildVersion);</div><div class="line"></div><div class="line">        cb &amp;&amp; cb(err, <span class="built_in">data</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="é”™è¯¯ä»£ç "><a href="#é”™è¯¯ä»£ç " class="headerlink" title="é”™è¯¯ä»£ç "></a>é”™è¯¯ä»£ç </h3><p>åœ¨ä¸‹è½½ï¼Œå®‰è£…æ›´æ–°è¿‡ç¨‹ä¸­éƒ½æœ‰å¯èƒ½å‡ºç°é”™è¯¯ï¼Œè¯¦ç»†çš„é”™è¯¯ä»£ç å‚è€ƒï¼š<a href="https://github.com/nordnet/cordova-hot-code-push/wiki/Error-codes" target="_blank" rel="external">Error codes</a></p>
<h2 id="è¯·æ±‚åˆ°åº”ç”¨å•†åº—è¿›è¡Œ-APP-å‡çº§"><a href="#è¯·æ±‚åˆ°åº”ç”¨å•†åº—è¿›è¡Œ-APP-å‡çº§" class="headerlink" title="è¯·æ±‚åˆ°åº”ç”¨å•†åº—è¿›è¡Œ APP å‡çº§"></a>è¯·æ±‚åˆ°åº”ç”¨å•†åº—è¿›è¡Œ APP å‡çº§</h2><p>æ’ä»¶é…ç½®æ–‡ä»¶ <code>chcp.json</code> ä¸­ <code>min_native_interface</code> é€‰é¡¹æ˜¯ç½‘é¡µå†…å®¹æ‰§è¡Œæ—¶è¦æ±‚ native side æœ€ä½ç‰ˆæœ¬å·ã€‚æ¯ä¸€æ¬¡çƒ­æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œéƒ½ä¼šå»æ£€æŸ¥è¿™ä¸ªé€»è¾‘ï¼Œåˆ¤æ–­å½“å‰ native side çš„ç‰ˆæœ¬æ˜¯å¦ç¬¦åˆè¦æ±‚ã€‚å¦‚æœå½“å‰ APP ä¸­çš„ native side ç‰ˆæœ¬å·ä½äº <code>chcp.json</code> ä¸­ <code>min_native_interface</code> çš„é€‰é¡¹å€¼ï¼Œé‚£ä¹ˆæ‰§è¡Œçƒ­æ›´æ–°å°±ä¼šæç¤ºé”™è¯¯ï¼š<code>chcp.error.APPLICATION_BUILD_VERSION_TOO_LOW</code>ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬åº”å½“æç¤ºç”¨æˆ·å‰å¾€åº”ç”¨å•†åº—å¯¹ APP è¿›è¡Œå‡çº§ã€‚</p>
<p>æ°å½“çš„å¤„ç†æ–¹å¼æ˜¯ï¼Œåœ¨å‡ºç° <code>chcp.error.APPLICATION_BUILD_VERSION_TOO_LOW</code> é”™è¯¯æ—¶ï¼Œå¼¹æ¡†æç¤ºç”¨æˆ·å‰å¾€åº”ç”¨å•†åº—è¿›è¡Œå‡çº§ï¼Œå¼¹æ¡†æœ‰ä¸¤ä¸ªæŒ‰é”®ï¼šä¸€ä¸ªç‚¹å‡»åè·³è½¬åˆ°åº”ç”¨å•†åº—è¯¥ APP å¯¹åº”ä¸‹è½½é¡µé¢ï¼›å¦ä¸€ä¸ªç‚¹å‡»åå…³é—­å¼¹æ¡†ã€‚æ’ä»¶ä¹Ÿæä¾›äº† API å¤„ç†è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬åªéœ€ï¼š</p>
<ul>
<li>åœ¨ <code>chcp.json</code> é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <code>android_identifier</code> å’Œ <code>ios_identifier</code></li>
<li>è°ƒç”¨ <code>chcp.requestApplicationUpdate</code> æ–¹æ³•</li>
</ul>
<p>ç›‘å¬ <code>chcp_updateLoadFailed</code> äº‹ä»¶ï¼Œåˆ¤æ–­é”™è¯¯ä»£ç ä¸º <code>chcp.error.APPLICATION_BUILD_VERSION_TOO_LOW</code> æ—¶ï¼Œè°ƒç”¨ <code>chcp.requestApplicationUpdate</code> æ–¹æ³•ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> app = &#123;</div><div class="line"></div><div class="line">  <span class="comment">// Application Constructor</span></div><div class="line">  initialize: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.bindEvents();</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// Bind any events that are required.</span></div><div class="line">  <span class="comment">// Usually you should subscribe on 'deviceready' event to know, when you can start calling cordova modules</span></div><div class="line">  bindEvents: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">'deviceready'</span>, <span class="keyword">this</span>.onDeviceReady, <span class="literal">false</span>);</div><div class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">'chcp_updateLoadFailed'</span>, <span class="keyword">this</span>.onUpdateLoadError, <span class="literal">false</span>);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="comment">// deviceready Event Handler</span></div><div class="line">  onDeviceReady: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">onUpdateLoadError</span>: <span class="function"><span class="keyword">function</span>(<span class="params">eventData</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> error = eventData.detail.error;</div><div class="line">    <span class="keyword">if</span> (error &amp;&amp; error.code == chcp.error.APPLICATION_BUILD_VERSION_TOO_LOW) &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'Native side update required'</span>);</div><div class="line">        <span class="keyword">var</span> dialogMessage = <span class="string">'New version of the application is available on the store. Please, update.'</span>;</div><div class="line">        chcp.requestApplicationUpdate(dialogMessage, <span class="keyword">this</span>.userWentToStoreCallback, <span class="keyword">this</span>.userDeclinedRedirectCallback);</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">userWentToStoreCallback</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// user went to the store from the dialog</span></div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">userDeclinedRedirectCallback</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// User didn't want to leave the app.</span></div><div class="line">    <span class="comment">// Maybe he will update later.</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">app.initialize();</div></pre></td></tr></table></figure></p>
<h2 id="Usage-Limitations"><a href="#Usage-Limitations" class="headerlink" title="Usage Limitations"></a><a href="https://github.com/nordnet/cordova-hot-code-push/wiki/Usage-Limitations" target="_blank" rel="external">Usage Limitations</a></h2><p><strong>1ã€Donâ€™t rename/delete/move your index page</strong><br>Cordova é¡¹ç›® <code>config.xml</code> æ–‡ä»¶ä¸­éƒ½ä¼šå®šä¹‰ä¸€ä¸ªå…¥å£é¡µé¢ <code>index.html</code>ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">content</span> <span class="attr">src</span>=<span class="string">"index.html"</span> /&gt;</span></div></pre></td></tr></table></figure></p>
<p>åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼Œå°±ä¼šåŠ è½½ <code>index.html</code> é¡µé¢ä½œä¸ºå…¥å£ï¼Œåœ¨ä»£ç çƒ­æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œè¿™æ˜¯å”¯ä¸€ä¸èƒ½åˆ é™¤ï¼Œç§»åŠ¨å’Œé‡å‘½åçš„æ–‡ä»¶ï¼Œå¦åˆ™ï¼Œä»£ç çƒ­æ›´æ–°åï¼Œåº”ç”¨å°±æ— æ³•æ­£å¸¸åŠ è½½åˆ° <code>index.html</code> å…¥å£é¡µé¢ï¼Œæ‰€ä»¥ä¼šå‡ºé”™ã€‚</p>
<p>è¯šç„¶ï¼Œå¦‚æœä½ éœ€è¦é‡å‘½åï¼Œæˆ–è€…ä¿®æ”¹å…¶å­˜å‚¨è·¯å¾„ï¼Œé‚£ä¹ˆéœ€è¦åœ¨ <code>config.xml</code> æ–‡ä»¶ä¸­ä¿®æ”¹ <code>content</code> é…ç½®ã€‚</p>
<p><strong>2ã€Do not clean pluginâ€™s inner preferences with cordova-plugin-nativestorage</strong><br>cordova-plugin-nativestorage æ’ä»¶æä¾›äº†è¯»å†™æœ¬åœ°å­˜å‚¨æ•°æ®çš„èƒ½åŠ›ï¼Œä¾‹å¦‚åœ¨ iOS ä¸­å¯¹åº”çš„æœ¬åœ°å­˜å‚¨æ˜¯ <code>NSUserDefault</code>ï¼ŒCHCP çƒ­æ›´æ–°æ’ä»¶åœ¨å…¶ä¸­å­˜å‚¨äº†ä¸€äº›å±æ€§ã€‚</p>
<p>è°ƒç”¨ cordova-plugin-nativestorage æ’ä»¶ä¸­çš„ <code>NativeStorage.clear()</code> æ–¹æ³•ä¼šæ¸…é™¤æœ¬åœ°å­˜å‚¨æ•°æ®ï¼Œè¿™å°±ä¼šå½±å“åˆ° CHCP æ’ä»¶çš„æ­£å¸¸è¿è¡Œï¼Œå¯¼è‡´ä¸‹ä¸€æ¬¡åº”ç”¨å¯åŠ¨æ—¶åŠ è½½çš„æ˜¯åº”ç”¨ bundle ä¸­ <code>www</code> ç›®å½•ä¸­çš„ç½‘é¡µå†…å®¹ï¼Œè€Œéå¤–éƒ¨ç›®å½•å­˜å‚¨çš„å½“å‰ç‰ˆæœ¬ç½‘é¡µå†…å®¹ã€‚</p>
<h2 id="å°†-www-ç›®å½•æ‰“åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨æˆ–è€…äº‘å­˜å‚¨ç›®å½•"><a href="#å°†-www-ç›®å½•æ‰“åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨æˆ–è€…äº‘å­˜å‚¨ç›®å½•" class="headerlink" title="å°† www ç›®å½•æ‰“åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨æˆ–è€…äº‘å­˜å‚¨ç›®å½•"></a>å°† <code>www</code> ç›®å½•æ‰“åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨æˆ–è€…äº‘å­˜å‚¨ç›®å½•</h2><p>æ–°ç‰ˆæœ¬å‘å¸ƒæ—¶ï¼Œéƒ½éœ€è¦æ‰§è¡Œå¦‚ä¸‹å¤„ç†ï¼š</p>
<ul>
<li>å¯¹ <code>www</code> ç›®å½•ä¸‹çš„é™æ€æ–‡ä»¶è¿›è¡Œæ‰“åŒ…ï¼ŒåŒ…æ‹¬ä»£ç å‹ç¼©ï¼Œåˆå¹¶ç­‰ç­‰</li>
<li>æ‰§è¡Œ <code>cordova-hcp build</code> ç”Ÿæˆ <code>chcp.json</code> å’Œ <code>chcp.manifest</code> æ–‡ä»¶</li>
<li>å°† <code>www</code> ç›®å½•ä¸‹çš„é™æ€æ–‡ä»¶ä¸Šä¼ è‡³æœåŠ¡å™¨æˆ–è€…äº‘å­˜å‚¨ç›®å½•</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/app-store.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;åŸºäº Cordova æ¡†æ¶èƒ½å°†ç½‘é¡µåº”ç”¨ (js, html, css, å›¾ç‰‡ç­‰) æ‰“åŒ…æˆ Appã€‚å½“ App åœ¨åº”ç”¨å•†åº—ä¸Šæ¶åï¼Œå¦‚ä½•å¿«é€Ÿæ›´æ–°æ˜¯æˆ‘ä»¬éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚ğŸ¤–&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ¬åœ°æ‰“åŒ…æ–°ç‰ˆæœ¬ App å‘å¸ƒåˆ°åº”ç”¨å•†åº—ï¼Œä½†è¿™ä¸­å‘å¸ƒæµç¨‹è€—è´¹æ—¶é—´ï¼Œå°¤å…¶æ˜¯ Apple Store&lt;/li&gt;
&lt;li&gt;åº”ç”¨åŠ è½½ç½‘ç»œèµ„æºï¼Œè¿™æ · App å±•ç¤ºçš„å†…å®¹å°±å¯ä»¥ä¿è¯æ˜¯æœ€æ–°çš„ï¼Œä½†å½“åº”ç”¨æ–­ç½‘æ—¶ï¼Œåº”ç”¨å°±æ— æ³•æ­£å¸¸ä½¿ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬èƒ½æƒ³çš„è¿™ä¸¤ç§æ–¹å¼éƒ½å­˜åœ¨çš„å¾ˆå¤§çš„å¼Šç«¯ï¼Œä¸é€‚åˆå®é™…åº”ç”¨ï¼&lt;/p&gt;
    
    </summary>
    
      <category term="Cordova" scheme="http://objcer.com/categories/Cordova/"/>
    
    
      <category term="Cordova Hot Code Push" scheme="http://objcer.com/tags/Cordova-Hot-Code-Push/"/>
    
  </entry>
  
  <entry>
    <title>URI, URL, URN çš„åŒºåˆ«</title>
    <link href="http://objcer.com/2017/06/04/The-Difference-Between-URLs-and-URIs/"/>
    <id>http://objcer.com/2017/06/04/The-Difference-Between-URLs-and-URIs/</id>
    <published>2017-06-04T08:43:26.000Z</published>
    <updated>2017-06-04T08:48:24.000Z</updated>
    
    <content type="html"><![CDATA[<ul>
<li>URI: Uniform Resource Identifier (ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦)</li>
<li>URL: Uniform Resource Locator (ç»Ÿä¸€èµ„æºå®šä½ç¬¦)</li>
<li>URN: Uniform Resource Name (ç»Ÿä¸€èµ„æºåç§°)</li>
</ul>
<a id="more"></a>
<h2 id="URI-URL-URN"><a href="#URI-URL-URN" class="headerlink" title="URI, URL, URN"></a>URI, URL, URN</h2><p><strong>URI, URL, URN</strong> ä¸‰è€…å…³ç³»å›¾:<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/URI-vs-URL.png" alt=""></p>
<p>ğŸ“Œ å…³ç³»ï¼š</p>
<ul>
<li>URI æ˜¯ä¸€ä¸ªç´§å‡‘çš„å­—ç¬¦ä¸²ç”¨æ¥æ ‡ç¤ºæŠ½è±¡æˆ–ç‰©ç†èµ„æº</li>
<li>URL ç›¸å¯¹äº URIï¼Œé™¤äº†ç¡®å®šä¸€ä¸ªèµ„æºï¼Œè¿˜æä¾›ä¸€ç§å®šä½è¯¥èµ„æºçš„ä¸»è¦è®¿é—®æœºåˆ¶æˆ–è€…ç½‘ç»œåœ°å€ (â€œaccess mechanismâ€ or â€œnetwork locationâ€) ä¾‹å¦‚ï¼šhttp:// or ftp://</li>
<li>URI åŒ…æ‹¬ URL å’Œ URNï¼Œæ¯ä¸€ä¸ª URL éƒ½æ˜¯ URI</li>
<li>URN æ˜¯å”¯ä¸€æ ‡è¯†çš„ä¸€éƒ¨åˆ†ï¼Œå°±æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åå­—</li>
</ul>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/800px-URI_Euler_Diagram_no_lone_URIs.svg.png" alt=""></p>
<blockquote>
<p><em>[ç»´åŸºç™¾ç§‘]:</em> URI å¯è¢«è§†ä¸ºå®šä½ç¬¦ï¼ˆURLï¼‰ï¼Œåç§°ï¼ˆURNï¼‰æˆ–ä¸¤è€…å…¼å¤‡ã€‚ç»Ÿä¸€èµ„æºåï¼ˆURNï¼‰å¦‚åŒä¸€ä¸ªäººçš„åç§°ï¼Œè€Œç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼ˆURLï¼‰ä»£è¡¨ä¸€ä¸ªäººçš„ä½å€ã€‚æ¢è¨€ä¹‹ï¼ŒURN å®šä¹‰æŸäº‹ç‰©çš„èº«ä»½ï¼Œè€Œ URL æä¾›æŸ¥æ‰¾è¯¥äº‹ç‰©çš„æ–¹æ³•ã€‚</p>
</blockquote>
<p>ä¸¾ä¾‹è¯´æ˜ï¼š</p>
<ul>
<li><a href="http://www.wikipedia.org/" target="_blank" rel="external">http://www.wikipedia.org/</a><br>  è¿™ä¸ªå°±æ˜¯ URLï¼Œæ ‡è¯†ä¸€ä¸ªç‰¹å®šçš„äº’è”ç½‘èµ„æºï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ http åè®®è®¿é—®è¯¥ç½‘ç»œèµ„æº</li>
<li>urn:isbn:0-395-36341-1<br>  è¿™ä¸ªå°±æ˜¯ URNï¼ŒæŒ‡å®šæ ‡è¯†ç³»ç»Ÿï¼ˆå³å›½é™…æ ‡å‡†ä¹¦å·ISBNï¼‰å’ŒæŸèµ„æºåœ¨è¯¥ç³»ç»Ÿä¸­çš„å”¯ä¸€è¡¨ç¤ºçš„URIã€‚å®ƒå¯ä»¥å…è®¸äººä»¬åœ¨ä¸æŒ‡å‡ºå…¶ä½ç½®å’Œè·å¾—æ–¹å¼çš„æƒ…å†µä¸‹è°ˆè®ºè¿™æœ¬ä¹¦</li>
</ul>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://danielmiessler.com/study/url-uri/#gs.taQ4gpU" target="_blank" rel="external">The Difference Between URLs and URIs</a><br><a href="https://zh.wikipedia.org/zh-cn/%E7%BB%9F%E4%B8%80%E8%B5%84%E6%BA%90%E6%A0%87%E5%BF%97%E7%AC%A6" target="_blank" rel="external">ç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;URI: Uniform Resource Identifier (ç»Ÿä¸€èµ„æºæ ‡è¯†ç¬¦)&lt;/li&gt;
&lt;li&gt;URL: Uniform Resource Locator (ç»Ÿä¸€èµ„æºå®šä½ç¬¦)&lt;/li&gt;
&lt;li&gt;URN: Uniform Resource Name (ç»Ÿä¸€èµ„æºåç§°)&lt;/li&gt;
&lt;/ul&gt;
    
    </summary>
    
      <category term="ç¼–ç¨‹" scheme="http://objcer.com/categories/%E7%BC%96%E7%A8%8B/"/>
    
    
      <category term="URI" scheme="http://objcer.com/tags/URI/"/>
    
      <category term="URL" scheme="http://objcer.com/tags/URL/"/>
    
      <category term="URN" scheme="http://objcer.com/tags/URN/"/>
    
  </entry>
  
  <entry>
    <title>Cordova è¿œç¨‹æ¨é€ - iOSç¯‡</title>
    <link href="http://objcer.com/2017/06/04/cordova-register-and-receive-push-notifications-iOS/"/>
    <id>http://objcer.com/2017/06/04/cordova-register-and-receive-push-notifications-iOS/</id>
    <published>2017-06-03T17:03:12.000Z</published>
    <updated>2017-06-03T17:05:32.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/iOS-PUsh-Notifications.png" alt=""></p>
<a id="more"></a>
<h2 id="APNs"><a href="#APNs" class="headerlink" title="APNs"></a>APNs</h2><blockquote>
<p>APNs(<em>Apple Push Notification service</em>) <a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/APNSOverview.html#//apple_ref/doc/uid/TP40008194-CH8-SW1" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£ Overview</a></p>
</blockquote>
<h3 id="æ¨é€åŸç†"><a href="#æ¨é€åŸç†" class="headerlink" title="æ¨é€åŸç†"></a>æ¨é€åŸç†</h3><p>å½“ Provider è¿œç¨‹æœåŠ¡å™¨éœ€è¦å‘ App æ¨é€ä¸€æ¡æ¶ˆæ¯æ—¶ï¼Œå¹¶ä¸æ˜¯ç›´æ¥å¾€ App æ¨é€æ¶ˆæ¯ï¼Œè€Œæ˜¯æ¨é€è‹¹æœ APNs æœåŠ¡å™¨ä¸Šï¼Œè€Œè‹¹æœçš„ APNs æœåŠ¡å™¨å†é€šè¿‡ä¸è®¾å¤‡å»ºç«‹é•¿è¿æ¥è¿›è€ŒæŠŠæ¶ˆæ¯æ¨é€åˆ°æˆ‘ä»¬çš„è®¾å¤‡ä¸Šã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/82BDFC5F-339D-4402-8719-5197D0246305.png" alt=""></p>
<p>ç”±æ­¤ï¼šAPNs æ¨é€å°±åˆ’åˆ†æˆä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li>Provider-to-APNs connection (æœåŠ¡ç«¯äº¤äº’)</li>
<li>APNs-to-device connection (å®¢æˆ·ç«¯äº¤äº’)</li>
</ul>
<h3 id="deviceToken"><a href="#deviceToken" class="headerlink" title="deviceToken"></a>deviceToken</h3><p>1ã€å½“ä¸€ä¸ª App æ³¨å†Œæ¥æ”¶è¿œç¨‹é€šçŸ¥æ—¶ï¼Œç³»ç»Ÿä¼šå‘é€è¯·æ±‚åˆ° APNs æœåŠ¡å™¨ï¼ŒAPNs æœåŠ¡å™¨æ”¶åˆ°æ­¤è¯·æ±‚ä¼šç”Ÿæˆä¸€ä¸ª<strong>ç‹¬ä¸€æ— äºŒ</strong>çš„ deviceTokenï¼Œå‘é€åˆ°å¯¹åº”è¯·æ±‚çš„ App ä¸Šã€‚ç„¶å App æŠŠæ­¤ deviceToken å‘é€ç»™æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ Providerã€‚</p>
<blockquote>
<p>â—ï¸ä¸€ä¸ª deviceToken å¯ä»¥å”¯ä¸€æ ‡è¯†æŸä¸ªè®¾å¤‡ä¸Šçš„æŸä¸ª Appï¼Œå¯ä»¥ç†è§£æˆï¼š<strong>deviceToken = device UUID + App Bundle ID</strong></p>
</blockquote>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/Managing%20the%20device%20token.png" alt=""></p>
<p>2ã€Provider ç»™æˆ‘ä»¬çš„è®¾å¤‡æ¨é€é€šçŸ¥çš„æ—¶å€™ï¼Œå¿…é¡»åŒ…å«æ­¤ deviceTokenã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/Remote%20notification%20path%20from%20provider%20to%20device.png" alt=""></p>
<h3 id="æ¨é€æ¶ˆæ¯-Payload"><a href="#æ¨é€æ¶ˆæ¯-Payload" class="headerlink" title="æ¨é€æ¶ˆæ¯ Payload"></a>æ¨é€æ¶ˆæ¯ Payload</h3><blockquote>
<p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html#//apple_ref/doc/uid/TP40008194-CH10-SW1" target="_blank" rel="external">Creating the Remote Notification Payload</a></p>
</blockquote>
<p>1ã€Payload æ¶ˆæ¯å¤§å°</p>
<ul>
<li>For regular remote notifications, the maximum size is 4KB (4096 bytes)</li>
<li>For Voice over Internet Protocol (VoIP) notifications, the maximum size is 5KB (5120 bytes)</li>
<li>If you are using the legacy APNs binary interface to send notifications instead of an HTTP/2 request, the maximum payload size is 2KB (2048 bytes)</li>
</ul>
<p>å½“ Payload è´Ÿè½½å¤§å°è¶…è¿‡è§„å®šçš„è´Ÿè½½å¤§å°æ—¶ï¼ŒAPNs ä¼šæ‹’ç»å‘é€æ­¤æ¶ˆæ¯ã€‚</p>
<p>2ã€Payload æ¶ˆæ¯æ ¼å¼<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// ä»¥ä¸‹ä¸º Payload å¸¸ç”¨å­—æ®µï¼Œè¯¦ç»†è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£</div><div class="line">&#123;</div><div class="line">    <span class="string">"aps"</span> : &#123;</div><div class="line">        <span class="string">"alert"</span>              :   &#123;   // <span class="type">string</span> <span class="keyword">or</span> dictionary</div><div class="line">            <span class="string">"title"</span>          :   "<span class="type">string</span><span class="string">",</span></div><div class="line">            "<span class="keyword">body</span><span class="string">"           :   "</span>string<span class="string">"</span></div><div class="line">        &#125;,</div><div class="line">        "badge<span class="string">"              :    number,</span></div><div class="line">        "sound<span class="string">"              :    "</span>string<span class="string">"</span></div><div class="line">    &#125;,</div><div class="line">    "acme1<span class="string">" : [ "</span>foo<span class="string">",  "</span>bar<span class="string">" ]</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>apsï¼šæ¨é€æ¶ˆæ¯å¿…é¡»æœ‰çš„ key<ul>
<li>alertï¼šæ¨é€æ¶ˆæ¯åŒ…å«æ­¤ key å€¼ï¼Œç³»ç»Ÿå°±ä¼šæ ¹æ®ç”¨æˆ·çš„è®¾ç½®å±•ç¤ºæ ‡å‡†çš„æ¨é€ä¿¡æ¯<ul>
<li>titleï¼šç®€çŸ­æè¿°æ­¤è°ƒæ¨é€æ¶ˆæ¯çš„ç›®çš„</li>
<li>bodyï¼šæ¨é€çš„å†…å®¹</li>
</ul>
</li>
<li>badgeï¼šåœ¨ app å›¾æ ‡ä¸Šæ˜¾ç¤ºæ¶ˆæ¯æ•°é‡ï¼Œç¼ºå°‘æ­¤ key ï¼Œæ¶ˆæ¯æ•°é‡å°±ä¸ä¼šæ”¹å˜ï¼Œæ¶ˆé™¤æ ‡è®°æ—¶æŠŠæ­¤ key å¯¹åº”çš„ value è®¾ç½®ä¸º0</li>
<li>soundï¼šè®¾ç½®æ¨é€å£°éŸ³çš„keyå€¼ï¼Œç³»ç»Ÿé»˜è®¤æç¤ºå£°éŸ³å¯¹åº”çš„ value å€¼ä¸º default</li>
</ul>
</li>
<li>acme: ä»¥ <code>acme</code> ä½œä¸ºå‰ç¼€ï¼Œè¡¨ç¤ºè‡ªå®šä¹‰æ•°æ®</li>
</ul>
<p>ä¾‹å¦‚ï¼š<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"aps"</span> : &#123;</div><div class="line">        <span class="attr">"alert"</span>: <span class="string">"This is a notification"</span>,</div><div class="line">        <span class="attr">"badge"</span>: <span class="number">1</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"acme-data"</span>: [ <span class="string">"foo"</span>,  <span class="string">"bar"</span> ]</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="attr">"aps"</span> : &#123;</div><div class="line">        <span class="attr">"alert"</span>: &#123;</div><div class="line">            <span class="attr">"title"</span>: <span class="string">"This is Title"</span>,</div><div class="line">            <span class="attr">"body"</span>: <span class="string">"This is Body"</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">"badge"</span>: <span class="number">1</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"acme-data"</span>: [ <span class="string">"foo"</span>,  <span class="string">"bar"</span> ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3ã€å½“è®¾å¤‡å¤„äºç¦»çº¿ offline çŠ¶æ€æ—¶ï¼ŒAPNs ä¼šä¸ºä¿ç•™ Provider æ‰€æ¨é€çš„æœ€åä¸€æ¡é€šçŸ¥ï¼Œå½“è®¾å¤‡è½¬æ¢ä¸ºè¿ç½‘çŠ¶æ€æ—¶ï¼ŒAPNsåˆ™æŠŠå…¶ä¿ç•™çš„æœ€åä¸€æ¡é€šçŸ¥æ¨é€ç»™æˆ‘ä»¬çš„è®¾å¤‡ï¼›å¦‚æœè®¾å¤‡é•¿æ—¶é—´ç¦»çº¿ï¼Œé‚£ä¹ˆæœ€åä¸€æ¡é€šçŸ¥ä¹Ÿæœ‰å¯èƒ½è¢«ä¸¢å¼ƒã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><img src="http://7vikhl.com1.z0.glb.clouddn.com/apns-app.png" alt=""></p>
<ul>
<li>â‘  App å‘ç³»ç»Ÿå‘èµ·è¯·æ±‚</li>
<li>â‘¡ ç³»ç»Ÿå‘ APNs å‘é€æ³¨å†Œè¿œç¨‹æ¨é€è¯·æ±‚</li>
<li>â‘¢ APNs ç”Ÿæˆ deviceToken å¹¶è¿”å›</li>
<li>â‘£ App å°† deviceToken å‘é€ç»™æœåŠ¡å™¨ Provider</li>
<li>â‘¤ ä»æ¨é€ç®¡ç†å¹³å°å‘ Provider å‘å‡ºæ¨é€æ¶ˆæ¯æŒ‡ä»¤</li>
<li>â‘¥ Provider æ¨é€æ¶ˆæ¯ç»™ APNs</li>
<li>â‘¦ APNs æ¨é€æ¶ˆæ¯ç»™ App</li>
</ul>
<h2 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h2><p>Cordova é¡¹ç›®è¦é›†æˆè¿œç¨‹æ¨é€åŠŸèƒ½ï¼Œéœ€è¦ç”¨åˆ° <a href="https://github.com/phonegap/phonegap-plugin-push" target="_blank" rel="external">phonegap-plugin-push</a> è¿™ä¸ªæ’ä»¶ï¼Œè¯¥æ’ä»¶æä¾›äº†å¯¹å¤šä¸ªå¹³å°çš„æ¨é€æ”¯æŒï¼Œå½“ç„¶åŒ…æ‹¬ iOS å’Œ Androidï¼Œä¸‹é¢ä»¥ iOS é¡¹ç›®ä¸ºä¾‹ï¼Œè¯¦ç»†ä»‹ç»æ•´ä¸ªå®‰è£…è¿‡ç¨‹ã€‚</p>
<blockquote>
<p>iOS å®‰è£…è¿‡ç¨‹ï¼š<a href="https://github.com/phonegap/phonegap-plugin-push/blob/master/docs/INSTALLATION.md#ios-details" target="_blank" rel="external">å‚è€ƒæ–‡æ¡£</a></p>
</blockquote>
<p>â—ï¸æ³¨æ„ï¼š</p>
<ul>
<li>ä»¥ä¸‹å®‰è£…è¿‡ç¨‹éœ€è¦<strong>ç¿»å¢™</strong></li>
<li>è¯¥æ’ä»¶è¦æ±‚ cordova ç‰ˆæœ¬è‡³å°‘ 6.1.0ï¼Œå¦åˆ™è¦ä¹ˆæ›´æ–° cordova æˆ–è€…ä¸‹è½½æ—¶æŒ‡å®šè¯¥æ’ä»¶ç‰ˆæœ¬å·ï¼š<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cordova plugin <span class="keyword">add</span> phonegap-plugin-<span class="keyword">push</span><span class="subst">@1</span><span class="number">.8</span><span class="number">.1</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>æ‰§è¡Œå®‰è£…å‘½ä»¤ï¼š<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">âœ  wps-<span class="built_in">writer</span> git:(feature/<span class="keyword">edit</span>) cordova plugin add phonegap-plugin-<span class="keyword">push</span></div><div class="line">Fetching plugin <span class="string">"phonegap-plugin-push@1.10.4"</span> via npm</div><div class="line">Installing <span class="string">"phonegap-plugin-push"</span> <span class="keyword">for</span> browser</div><div class="line">Installing <span class="string">"phonegap-plugin-push"</span> <span class="keyword">for</span> ios</div><div class="line">Failed to install 'phonegap-plugin-<span class="keyword">push</span>':undefined</div><div class="line"><span class="built_in">Error</span>: CocoaPods was <span class="keyword">not</span> found. Please install version <span class="number">1.0</span><span class="number">.1</span> <span class="keyword">or</span> greater from https:<span class="comment">//cocoapods.org/</span></div></pre></td></tr></table></figure></p>
<p>æç¤ºæˆ‘ä»¬è¦å®‰è£… CocoaPodsï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">âœ  wps-writer git:(feature/edit) âœ— sudo gem <span class="keyword">install</span> cocoapods</div><div class="line"><span class="keyword">ERROR</span>:  Could <span class="keyword">not</span> find a valid gem <span class="string">'cocoapods'</span> (&gt;= <span class="number">0</span>), here <span class="keyword">is</span> why:</div><div class="line">          Unable <span class="keyword">to</span> download <span class="keyword">data</span> <span class="keyword">from</span> https://ruby.taobao.org/ - Errno::ECONNRESET: <span class="keyword">Connection</span> <span class="keyword">reset</span> <span class="keyword">by</span> peer - SSL_connect (https://ruby.taobao.org/specs<span class="number">.4</span><span class="number">.8</span>.gz)</div></pre></td></tr></table></figure></p>
<p>æ ¹æ®é”™è¯¯æç¤ºæˆ‘ä»¬çŸ¥é“ï¼Œä»æ·˜å® Ruby çš„è½¯ä»¶æºä¸­æ‰¾ä¸åˆ° cocoapodsï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ  gem æº<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># å¢åŠ /åˆ é™¤ gem æº</span></div><div class="line">gem sources --<span class="keyword">add</span> https:<span class="comment">//rubygems.org/</span></div><div class="line">gem sources --<span class="keyword">remove</span> https:<span class="comment">//rubygems.org/</span></div><div class="line"><span class="meta"># æŸ¥çœ‹ gem æº</span></div><div class="line">gem sources -l</div></pre></td></tr></table></figure></p>
<p>å®‰è£…å®Œ CocoaPods ä¹‹åï¼Œé‡æ–°å®‰è£…æ’ä»¶ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">âœ  wps-writer git:(feature/edit) cordova plugin add phonegap-plugin-push</div><div class="line">Fetching plugin <span class="string">"phonegap-plugin-push@1.10.4"</span> via npm</div><div class="line">Installing <span class="string">"phonegap-plugin-push"</span> <span class="keyword">for</span> browser</div><div class="line">Installing <span class="string">"phonegap-plugin-push"</span> <span class="keyword">for</span> ios</div><div class="line">Failed to install <span class="string">'phonegap-plugin-push'</span>:Error: pod: Command failed with exit <span class="selector-tag">code</span> <span class="number">1</span></div><div class="line">    at ChildProcess<span class="selector-class">.whenDone</span> (/Users/YingshanDeng/Documents/WebPS/wps-writer/platforms/ios/cordova/node_modules/cordova-common/src/superspawn<span class="selector-class">.js</span>:<span class="number">169</span>:<span class="number">23</span>)</div><div class="line">    at emitTwo (events<span class="selector-class">.js</span>:<span class="number">100</span>:<span class="number">13</span>)</div><div class="line">    at ChildProcess<span class="selector-class">.emit</span> (events<span class="selector-class">.js</span>:<span class="number">185</span>:<span class="number">7</span>)</div><div class="line">    at maybeClose (internal/child_process<span class="selector-class">.js</span>:<span class="number">827</span>:<span class="number">16</span>)</div><div class="line">    at Process<span class="selector-class">.ChildProcess</span>._handle<span class="selector-class">.onexit</span> (internal/child_process<span class="selector-class">.js</span>:<span class="number">211</span>:<span class="number">5</span>)</div><div class="line">Error: pod: Command failed with exit <span class="selector-tag">code</span> <span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>å®‰è£…æ–‡æ¡£ä¸­ä¹Ÿå¯ä»¥æ‰¾åˆ° <a href="https://github.com/phonegap/phonegap-plugin-push/blob/master/docs/INSTALLATION.md#common-cocoapod-installation-issues" target="_blank" rel="external">è§£å†³è¿™ä¸ªé—®é¢˜</a> çš„ä»‹ç»ï¼š</p>
<ul>
<li>è¿›å…¥ <code>platforms/ios</code> iOS é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œ <code>pod repo update</code></li>
<li>é‡æ–°å®‰è£…è¯¥æ’ä»¶</li>
</ul>
<p>ä½†æ˜¯æ‰§è¡Œ <code>pod repo update</code> å®åœ¨æ˜¯å¤ªæ…¢äº†ğŸ’©ï¼Œä¸èƒ½å¿ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•è¿›è¡Œè§£å†³ï¼š<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo rm -fr ~/.cocoapods/repos/<span class="keyword">master</span></div><div class="line"><span class="title">pod</span> setup</div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œ <code>pod setup</code> ä¼š Specs æ•´ä¸ªä»“åº“ clone åˆ°æœ¬åœ°ï¼Œè¿™ä¸ªä»“åº“æ˜¯æ˜¯æ‰€æœ‰ Pods çš„ç´¢å¼•ï¼Œå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œæ‰€æœ‰å…¬å¼€çš„ Pods éƒ½åœ¨è¿™é‡Œé¢ã€‚æ•´ä¸ªä¸‹è½½å¤§å°çº¦ 400M æ‰€ä»¥éœ€è¦ç‚¹æ—¶é—´ ğŸ¤£</p>
<p>ä¸‹è½½å®Œæ¯•åï¼Œæˆ‘ä»¬å†è¿›å…¥ iOS é¡¹ç›®ä¸­æ‰§è¡Œ <code>pod repo update</code> å°±å¾ˆå¿«äº†ã€‚ä»¥ä¸Šæ“ä½œéƒ½é¡ºåˆ©å®Œæˆåï¼Œé‡æ–°å®‰è£…è¯¥æ’ä»¶ï¼š<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># å…ˆç§»é™¤åæ·»åŠ </div><div class="line">cordova <span class="keyword">plugin</span> <span class="keyword">rm</span> phonegap-<span class="keyword">plugin</span>-push</div><div class="line">cordova <span class="keyword">plugin</span> add phonegap-<span class="keyword">plugin</span>-push</div></pre></td></tr></table></figure></p>
<p>ä¸å‡ºæ„å¤–å°±å®‰è£…æˆåŠŸäº† âœŒï¸ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹å…¶å®å°±æ˜¯ä¸¤ç‚¹ï¼š</p>
<ul>
<li><code>sudo gem install cocoapods</code></li>
<li><code>pod setup</code></li>
</ul>
<h2 id="ä½¿ç”¨æ’ä»¶"><a href="#ä½¿ç”¨æ’ä»¶" class="headerlink" title="ä½¿ç”¨æ’ä»¶"></a>ä½¿ç”¨æ’ä»¶</h2><blockquote>
<p><a href="https://github.com/phonegap/phonegap-plugin-push/blob/master/docs/API.md#pushnotificationinitoptions" target="_blank" rel="external">API æ–‡æ¡£</a></p>
</blockquote>
<p>æ’ä»¶åœ¨å…¨å±€æ·»åŠ äº†ä¸€ä¸ª PushNotification ç±»ã€‚</p>
<h3 id="PushNotification-init-options"><a href="#PushNotification-init-options" class="headerlink" title="PushNotification.init(options)"></a><code>PushNotification.init(options)</code></h3><p>æ¨é€åˆå§‹åŒ–ï¼Œé€šè¿‡ä¼ å…¥é…ç½®ä¿¡æ¯ï¼ŒåŒ…å«å„ä¸ªå¹³å°ç›¸åº”çš„è®¾ç½®ï¼Œè¿”å› <code>PushNotification</code> å®ä¾‹<br>â—ï¸æ³¨æ„ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨ <code>deviceready</code> äº‹ä»¶å›è°ƒä¸­è°ƒç”¨ <code>PushNotification.init()</code></li>
<li>æ¯ä¸€æ¬¡ App å¯åŠ¨ï¼Œéƒ½éœ€è¦è°ƒç”¨ <code>PushNotification.init()</code>ï¼Œå› ä¸º App å¯¹åº”çš„æ¨é€æœåŠ¡ registration ID å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼ˆå¯¹äº iOS å³æ˜¯ deviceTokenï¼‰</li>
</ul>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> push = PushNotification.init(&#123;</div><div class="line">    <span class="comment">// android: &#123;</span></div><div class="line">    <span class="comment">// &#125;,</span></div><div class="line">    <span class="comment">// browser: &#123;</span></div><div class="line">    <span class="comment">// &#125;,</span></div><div class="line"><span class="symbol">    ios:</span> &#123;</div><div class="line"><span class="symbol">        alert:</span> <span class="string">"true"</span>, <span class="comment">// å¼¹å‡ºé€šçŸ¥æç¤º</span></div><div class="line"><span class="symbol">        badge:</span> <span class="string">"true"</span>, <span class="comment">// åº”ç”¨å›¾æ ‡å³ä¸Šè§’æ•°å­—æ ‡è®°</span></div><div class="line"><span class="symbol">        sound:</span> <span class="string">"true"</span>, <span class="comment">// é€šçŸ¥æç¤ºéŸ³</span></div><div class="line"><span class="symbol">        clearBadge:</span> <span class="string">"true"</span> <span class="comment">// åº”ç”¨æ‰“å¼€åæ¸…é™¤å›¾æ ‡æ ‡è®°</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="äº‹ä»¶ç›‘å¬-push-on-event-callback"><a href="#äº‹ä»¶ç›‘å¬-push-on-event-callback" class="headerlink" title="äº‹ä»¶ç›‘å¬ push.on(event, callback)"></a>äº‹ä»¶ç›‘å¬ <code>push.on(event, callback)</code></h3><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// â‘  æ³¨å†Œé€šçŸ¥æˆåŠŸå›è°ƒï¼Œè¿”å›çš„ registrationId</span></div><div class="line"><span class="comment">// å¯¹äº iOSï¼Œå‘ APNs æ³¨å†Œè¿œç¨‹æ¨é€ï¼Œè¿”å›çš„ deviceToken å³ registrationId</span></div><div class="line">push.<span class="keyword">on</span>(<span class="string">'registration'</span>, (<span class="built_in">data</span>) =&gt; &#123;</div><div class="line">    console.<span class="keyword">log</span>(<span class="string">'---registration---'</span>, <span class="built_in">data</span>.registrationId)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// â‘¡ æ¥æ”¶åˆ°è¿œç¨‹æ¨é€æ¶ˆæ¯çš„å›è°ƒ</span></div><div class="line">push.<span class="keyword">on</span>(<span class="string">'notification'</span>, (<span class="built_in">data</span>) =&gt; &#123;</div><div class="line">    <span class="comment">// data.message,</span></div><div class="line">    <span class="comment">// data.title,</span></div><div class="line">    <span class="comment">// data.count,</span></div><div class="line">    <span class="comment">// data.sound,</span></div><div class="line">    <span class="comment">// data.image,</span></div><div class="line">    <span class="comment">// data.additionalData</span></div><div class="line">    console.<span class="keyword">log</span>(<span class="string">'---notification---'</span>, <span class="built_in">data</span>)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// â‘¢ å†…éƒ¨é”™è¯¯å›è°ƒ</span></div><div class="line">push.<span class="keyword">on</span>(<span class="string">'error'</span>, (e) =&gt; &#123;</div><div class="line">    <span class="comment">// e.message</span></div><div class="line">    console.<span class="keyword">log</span>(<span class="string">'---notification error---'</span>, e.message);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="PushNotification-hasPermission"><a href="#PushNotification-hasPermission" class="headerlink" title="PushNotification.hasPermission"></a><code>PushNotification.hasPermission</code></h3><p>æ£€æŸ¥ App æ˜¯å¦æˆæƒå…è®¸æ¨é€é€šçŸ¥<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">checkPermission: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        PushNotification.hasPermission(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">            <span class="comment">// resolve(isEnabled)</span></div><div class="line">            resolve(data.isEnabled);</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="get-setApplicationIconBadgeNumber"><a href="#get-setApplicationIconBadgeNumber" class="headerlink" title="get/setApplicationIconBadgeNumber"></a><code>get/setApplicationIconBadgeNumber</code></h3><p>è·å–/è®¾ç½®åº”ç”¨å›¾æ ‡æ ‡è®°æ•°å­—<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">setIconBadgeNumber(count) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// resolve()</span></div><div class="line">        push.setApplicationIconBadgeNumber(resolve, reject, count);</div><div class="line">    &#125;);</div><div class="line">&#125;,</div><div class="line">getIconBadgeNumber() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// resolve(count)</span></div><div class="line">        push.getApplicationIconBadgeNumber(resolve, reject);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="badge-è‡ªå¢é—®é¢˜-ğŸ¤–"><a href="#badge-è‡ªå¢é—®é¢˜-ğŸ¤–" class="headerlink" title="badge è‡ªå¢é—®é¢˜ ğŸ¤–"></a>badge è‡ªå¢é—®é¢˜ ğŸ¤–</h3><p>é€šå¸¸æ¥è¯´ï¼Œåº”ç”¨åœ¨æ¥æ”¶åˆ°ä¸€æ¡æ¨é€æ¶ˆæ¯é€šçŸ¥çš„æ—¶å€™ï¼Œå›¾æ ‡æ ‡è®° badge å°±åº”è¯¥åŠ ä¸€ï¼›å½“æ‰“å¼€åº”ç”¨çš„æ—¶å€™ï¼Œbadge æ¸…é›¶ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“é€šè¿‡è®¾ç½® Payload æ¶ˆæ¯ä¸­çš„ <code>badge</code> å­—æ®µï¼Œå¯ä»¥è®¾ç½®åº”ç”¨æ¥æ”¶åˆ°æ¨é€æ¶ˆæ¯æ—¶ï¼Œå›¾æ ‡æ ‡è®°è®¾ç½®çš„æ•°å€¼ï¼ˆ<code>badge</code> å­—æ®µä¸ºé›¶å³ä¸ºæ¸…ç©ºå›¾æ ‡æ ‡è®°æ•°å­—ï¼‰ï¼›è€Œåœ¨ PushNotification æ’ä»¶åˆå§‹åŒ–æ—¶é€šè¿‡é…ç½®ä¼ å…¥ <code>clearBadge</code> å¯ä»¥è®¾ç½®æ‰“å¼€åº”ç”¨æ—¶ï¼Œå›¾æ ‡æ ‡è®°æ¸…é›¶ã€‚</p>
<p>ä½†æ˜¯èƒ½å¦åšåˆ°æ¥æ”¶åˆ°æ¨é€æ¶ˆæ¯æ—¶ï¼Œbadge æ˜¾ç¤ºæ•°å€¼è‡ªå¢ä¸€å‘¢ï¼Ÿå°±ç›®å‰ PushNotification æ’ä»¶æ¥è¯´ï¼Œå¹¶ä¸èƒ½åšåˆ°ã€‚è€Œå¯¹äºå¾®ä¿¡æˆ–è€… QQ è¿™ç±»åº”ç”¨çš„å›¾æ ‡ badge æ•°å€¼æç¤ºçš„æ˜¯æœªè¯»æ¶ˆæ¯æ•°ï¼Œå…¶è®¾ç½®é€»è¾‘åº”è¯¥æ˜¯é€šè¿‡æœåŠ¡ç«¯ç»´æŠ¤çš„ã€‚</p>
<p>å¯¹äºå›¾æ ‡æ ‡è®°çš„è®¾ç½®ï¼Œå‚è€ƒäº†ä¸€äº› App çš„åšæ³•ï¼š</p>
<ul>
<li>è®¾ç½® <code>badge</code> å­—æ®µä¸º 1</li>
<li>ä¸å±•ç¤ºå›¾æ ‡æ ‡è®°ï¼ˆè®¾ç½® <code>badge</code> å­—æ®µä¸º 0 æˆ–è€… PushNotification æ’ä»¶åˆå§‹åŒ–æ˜¯ <code>badge</code> è®¾ç½®ä¸º <code>false</code>ï¼‰</li>
</ul>
<h2 id="æ¨é€è¯ä¹¦"><a href="#æ¨é€è¯ä¹¦" class="headerlink" title="æ¨é€è¯ä¹¦"></a>æ¨é€è¯ä¹¦</h2><p>å…·å¤‡æ¥æ”¶è¿œç¨‹æ¨é€çš„åº”ç”¨æ‰“åŒ…æ—¶éœ€è¦ä½¿ç”¨æ¨é€è¯ä¹¦ï¼ŒåŒæ ·ä¹ŸåŒºåˆ†å¼€å‘è¯ä¹¦å’Œå‘å¸ƒè¯ä¹¦ã€‚</p>
<h3 id="å¯¼å‡ºæ¨é€è¯ä¹¦"><a href="#å¯¼å‡ºæ¨é€è¯ä¹¦" class="headerlink" title="å¯¼å‡ºæ¨é€è¯ä¹¦"></a>å¯¼å‡ºæ¨é€è¯ä¹¦</h3><p>ç™»å½• <a href="https://developer.apple.com" target="_blank" rel="external">è‹¹æœå¼€å‘è€…ä¸­å¿ƒ</a> åœ¨ <code>Certificates, Identifiers &amp; Profiles -&gt; Identifiers -&gt; App IDs</code>ï¼Œæ‰¾åˆ°åº”ç”¨å¯¹åº”çš„ App IDï¼Œç‚¹å‡» <code>Edit</code> å¯¹ Push Notifications è¿›è¡Œé…ç½®å¯¼å‡º certificate è¯ä¹¦ã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/CreateCertificate.png" alt=""></p>
<p>åŒå‡»å®‰è£…è¯ä¹¦å¦‚ä¸‹ï¼š<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/aps.png" alt=""></p>
<p>åŒæ—¶æˆ‘ä»¬ä¹Ÿéœ€è¦æ›´æ–°ä¸‹è½½ Provisioning Profile æ–‡ä»¶ã€‚</p>
<h3 id="Xcode-çœŸæœºè°ƒè¯•æ¨é€é…ç½®"><a href="#Xcode-çœŸæœºè°ƒè¯•æ¨é€é…ç½®" class="headerlink" title="Xcode çœŸæœºè°ƒè¯•æ¨é€é…ç½®"></a>Xcode çœŸæœºè°ƒè¯•æ¨é€é…ç½®</h3><p>1ã€target -&gt; Capabilities<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/capabilities.jpg" alt=""></p>
<p>2ã€target -&gt; Build Settings -&gt; Signings<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/build-settings.jpg" alt=""></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://www.jianshu.com/p/4b947569a548" target="_blank" rel="external">iOSæ¨é€ä¹‹è¿œç¨‹æ¨é€ï¼ˆiOS Notification Of Remote Notificationï¼‰</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/iOS-PUsh-Notifications.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Cordova" scheme="http://objcer.com/categories/Cordova/"/>
    
    
      <category term="Push Notification" scheme="http://objcer.com/tags/Push-Notification/"/>
    
  </entry>
  
  <entry>
    <title>Unicode ä¹‹ç¥å¥‡çš„ç©ºæ ¼</title>
    <link href="http://objcer.com/2017/05/22/Unicode-spaces/"/>
    <id>http://objcer.com/2017/05/22/Unicode-spaces/</id>
    <published>2017-05-22T13:37:42.000Z</published>
    <updated>2017-05-22T13:41:01.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/IMG_3319.PNG" alt=""></p>
<a id="more"></a>
<h2 id="é—®é¢˜å¼•å…¥"><a href="#é—®é¢˜å¼•å…¥" class="headerlink" title="é—®é¢˜å¼•å…¥"></a>é—®é¢˜å¼•å…¥</h2><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">var a</span> = <span class="string">"&lt;p&gt;The app&amp;nbsp;&lt;/p&gt;"</span>;</div><div class="line"><span class="attribute">var b</span> = <span class="string">"&lt;p&gt;The app &lt;/p&gt;"</span></div></pre></td></tr></table></figure>
<p>æœ‰å¦‚ä¸Šä¸¤ä¸ªä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆå…¶ä¸­å‰è€…æ˜¯ä» WYSIWYG ç¼–è¾‘å™¨ä¸­è·å–åˆ°çš„å­—ç¬¦ä¸²æ•°æ®ï¼‰ï¼Œ æˆ‘ä»¬å·²çŸ¥ä¸¤ä¸ªå­—ç¬¦ä¸²è¡¨ç¤ºçš„å†…å®¹æ˜¯ä¸€æ ·çš„ï¼Œæˆ‘ä»¬å¦‚ä½•é€šè¿‡ä»£ç æ¥åˆ¤æ–­ä»–ä»¬ç›¸ç­‰å‘¢ã€‚</p>
<p>çœ‹åˆ°è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆç®€å•çš„å˜› ğŸ¤£ <code>&amp;nbsp;</code> æ˜¯ç©ºæ ¼çš„è½¬ä¹‰å­—ç¬¦ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å…ˆæŠŠ <code>&amp;nbsp;</code> æ›¿æ¢æˆç©ºæ ¼<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">replaceNbsps</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> str.replace(<span class="regexp">/&amp;nbsp;/g</span>, <span class="string">' '</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(replaceNbsps(a)) <span class="comment">// "&lt;p&gt;The app &lt;/p&gt;"</span></div><div class="line">replaceNbsps(a) == b <span class="comment">// false</span></div></pre></td></tr></table></figure></p>
<p>æ›¿æ¢åï¼Œä¸¤ä¸ªå­—ç¬¦ä¸²çœ‹èµ·æ¥ä¸€æ¨¡ä¸€æ ·äº†ï¼Œä½†æ˜¯æ‰§è¡Œç»“æœå´æ˜¯ <code>false</code> ğŸ¤” è¿™æ˜¯ä¸ºå•¥å‘¢ï¼Ÿ</p>
<p>å…¶å®å­—ç¬¦ä¸² <code>b</code> ä¸­æš—å«ç„æœºï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">var</span> <span class="selector-tag">b</span> = <span class="string">"&lt;p&gt;The app &lt;/p&gt;"</span></div><div class="line"><span class="selector-tag">var</span> <span class="selector-tag">b</span> = <span class="string">"&lt;p&gt;The app\u00a0&lt;/p&gt;"</span></div></pre></td></tr></table></figure></p>
<p>è¿™å…¶ä¸­çš„åŒ…å«çš„ä¸€ä¸ªç©ºæ ¼å­—ç¬¦ï¼Œå…¶ Unicode ä¸º <code>U+00A0</code>ï¼Œåè¿›åˆ¶å€¼ä¸ºï¼š160ã€‚è«éè¿™ä¸¤ä¸ªç©ºæ ¼å­—ç¬¦ä¸ä¸€æ ·ï¼Ÿ</p>
<p>æ²¡é”™â—é€šè¿‡æ­£åˆ™æ›¿æ¢çš„ç©ºæ ¼å­—ç¬¦çš„ Unicode ä¸º <code>U+0020</code>ï¼Œåè¿›åˆ¶å€¼ä¸ºï¼š32</p>
<table>
<thead>
<tr>
<th>Unicode</th>
<th>åè¿›åˆ¶å€¼</th>
<th>æè¿°</th>
<th>æ‹‰ä¸å­—æ¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>U+0020</td>
<td>160</td>
<td><a href="https://zh.wikipedia.org/zh-cn/%E7%A9%BA%E6%A0%BC" target="_blank" rel="external">ç©ºæ ¼</a></td>
<td>åŸºæœ¬æ‹‰ä¸å­—æ¯</td>
</tr>
<tr>
<td>U+00A0</td>
<td>32</td>
<td><a href="https://zh.wikipedia.org/zh-cn/%E4%B8%8D%E6%8D%A2%E8%A1%8C%E7%A9%BA%E6%A0%BC" target="_blank" rel="external">ä¸æ¢è¡Œç©ºæ ¼</a></td>
<td>æ‹‰ä¸å­—æ¯-1 è¾…åŠ©</td>
</tr>
</tbody>
</table>
<h2 id="ç©ºæ ¼-U-0020"><a href="#ç©ºæ ¼-U-0020" class="headerlink" title="ç©ºæ ¼ U+0020"></a>ç©ºæ ¼ <code>U+0020</code></h2><p>æˆ‘ä»¬é€šè¿‡é”®ç›˜ç‚¹å‡»ç©ºæ ¼é”®è¾“å…¥çš„ç©ºæ ¼ï¼Œå°±æ˜¯æ­¤ç±»ç©ºæ ¼ï¼Œæ™®é€šåŠè§’ç©ºæ ¼ï¼Œæ˜¾ç¤ºä¸ºç©ºç™½å­—ç¬¦ã€‚<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> space1 = <span class="string">'\u0020'</span>;</div><div class="line"><span class="keyword">var</span> space2 = <span class="string">' '</span>;</div><div class="line">space1 == space2 <span class="comment">// true</span></div><div class="line"></div><div class="line">space1.charCodeAt(<span class="number">0</span>) <span class="comment">// 32</span></div></pre></td></tr></table></figure></p>
<h2 id="ç©ºæ ¼-U-00A0"><a href="#ç©ºæ ¼-U-00A0" class="headerlink" title="ç©ºæ ¼ U+00A0"></a>ç©ºæ ¼ <code>U+00A0</code></h2><p>è¿™ç±»ç©ºæ ¼å­—ç¬¦ç§°ä¹‹ä¸º<strong>ä¸æ¢è¡Œç©ºæ ¼</strong>ã€‚ç”¨é€”æ˜¯ç¦æ­¢æ¢è¡Œã€‚</p>
<p>åœ¨ HTML ç½‘é¡µæ˜¾ç¤ºä¸­ï¼Œä¼šè‡ªåŠ¨åˆå¹¶å¤šä¸ªè¿ç»­çš„ç©ºç™½å­—ç¬¦ï¼›ä½†æ˜¯å¦‚æœä½¿ç”¨æ­¤ç±»å­—ç¬¦ï¼Œå°±ä¼šç¦æ­¢åˆå¹¶ï¼Œå› æ­¤è¿™ç±»å­—ç¬¦ä¹Ÿç§°ä¹‹ä¸º<em>ç¡¬ç©ºæ ¼</em>ã€‚åœ¨ç½‘é¡µæ˜¾ç¤ºä¸­å…¶è½¬ä¹‰å­—ç¬¦ä¸º <code>&amp;nbsp;</code><br><figure class="highlight dart"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> dom = <span class="built_in">document</span>.<span class="built_in">querySelector</span>(<span class="string">'div'</span>); <span class="comment">// DOM å…ƒç´ </span></div><div class="line"></div><div class="line"><span class="comment">// â‘  è‡ªåŠ¨åˆå¹¶ç©ºæ ¼</span></div><div class="line">dom.innerText = <span class="string">'a  b'</span>;</div><div class="line">dom.innerText = <span class="string">'a\u0020\u0020b'</span></div><div class="line">dom.innerText.length <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="comment">// â‘¡ ç¦æ­¢åˆå¹¶</span></div><div class="line">dom.innerText = <span class="string">'a\u00a0\u00a0b'</span></div><div class="line"><span class="comment">// æˆ–è€…ä½¿ç”¨ç©ºæ ¼çš„è½¬ä¹‰å­—ç¬¦ &amp;nbsp; ï¼Œæ­¤æ—¶éœ€è¦ç”¨ innerHTML</span></div><div class="line">$<span class="number">0.</span>innerHTML = <span class="string">'a&amp;nbsp;&amp;nbsp;b'</span></div><div class="line">dom.innerText.length <span class="comment">// 4</span></div></pre></td></tr></table></figure></p>
<p>å¯¹äº â‘  æˆ‘ä»¬åœ¨é¡µé¢ä¸­ä¼šè§‚å¯Ÿåˆ°ï¼ŒDOM å…ƒç´ åªä¼šå±•ç¤ºä¸€ä¸ªç©ºæ ¼ï¼ˆä¸¤ä¸ªç©ºæ ¼åˆå¹¶æˆä¸€ä¸ªï¼‰ï¼›è€Œå¯¹äº â‘¡ å°±ä¼šæ˜¾ç¤ºä¸¤ä¸ªç©ºæ ¼ã€‚</p>
<h2 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h2><p>äº†è§£äº†åŸå› ï¼Œç°åœ¨å°±å¯ä»¥è§£å†³ç¬¬ä¸€èŠ‚ä¸­çš„é—®é¢˜äº†ã€‚<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> <span class="title">replaceNbsps</span>(str) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">str.replace(/&amp;nbsp</span>;|\u00a0/g, <span class="string">' '</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">replaceNbsps(a) == replaceNbsps(b) // <span class="literal">true</span></div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬åªéœ€è¦ç»Ÿä¸€æŠŠç©ºæ ¼éƒ½è½¬æ¢æˆ Unicode ä¸º <code>\u0020</code> çš„ç©ºæ ¼ï¼Œç„¶åå†è¿›è¡Œæ¯”è¾ƒå°±å¯ä»¥äº†ã€‚</p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://zh.wikipedia.org/zh-cn/%E7%A9%BA%E6%A0%BC" target="_blank" rel="external">ç©ºæ ¼</a><br><a href="https://zh.wikipedia.org/zh-cn/%E4%B8%8D%E6%8D%A2%E8%A1%8C%E7%A9%BA%E6%A0%BC" target="_blank" rel="external">ä¸æ¢è¡Œç©ºæ ¼</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/IMG_3319.PNG&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Unicode" scheme="http://objcer.com/categories/Unicode/"/>
    
    
      <category term="space" scheme="http://objcer.com/tags/space/"/>
    
  </entry>
  
  <entry>
    <title>Cordova æ‰“åŒ…åº”ç”¨ - iOSç¯‡</title>
    <link href="http://objcer.com/2017/05/22/cordova-build-iOS-App/"/>
    <id>http://objcer.com/2017/05/22/cordova-build-iOS-App/</id>
    <published>2017-05-22T03:53:18.000Z</published>
    <updated>2017-05-22T03:55:13.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/ios.jpg" alt=""></p>
<a id="more"></a>
<h2 id="è‹¹æœå¼€å‘çŸ¥è¯†å‚¨å¤‡"><a href="#è‹¹æœå¼€å‘çŸ¥è¯†å‚¨å¤‡" class="headerlink" title="è‹¹æœå¼€å‘çŸ¥è¯†å‚¨å¤‡"></a>è‹¹æœå¼€å‘çŸ¥è¯†å‚¨å¤‡</h2><p><img src="http://7vikhl.com1.z0.glb.clouddn.com/iOS-dev-center.jpg" alt=""></p>
<h3 id="Certificates"><a href="#Certificates" class="headerlink" title="Certificates"></a>Certificates</h3><p>Certificates è¯ä¹¦ï¼Œæ˜¯ç”¨æ¥ç»™åº”ç”¨ç¨‹åºç­¾å(code sign)ï¼Œè¯æ˜åº”ç”¨ç¨‹åºçš„åˆæ³•æ€§å’Œå®Œæ•´æ€§ã€‚å¯¹äºæƒ³è¦å®‰è£…åˆ°çœŸæœºè°ƒè¯•æˆ–è€…å‘å¸ƒåˆ°åº”ç”¨å•†åº—çš„åº”ç”¨ç¨‹åºï¼Œåªæœ‰ç»è¿‡ç­¾åï¼Œæ‰èƒ½ä¿è¯å…¶æ¥æºå¯é ï¼Œå¹¶ä¸”ä»£ç å®Œæ•´ï¼Œæœªç»ç¯¡æ”¹çš„ã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/Code%20Signing%20Identity.jpg" alt=""><br>åœ¨Xcode Build Setting çš„ Code Signing Identity ä¸­ï¼Œä½ å¯ä»¥è®¾ç½®ç”¨äºä¸ºä»£ç ç­¾åçš„è¯ä¹¦ã€‚</p>
<ul>
<li>ç”³è¯·ä¸€ä¸ª Certificate ä¹‹å‰ï¼Œéœ€è¦å…ˆç”³è¯·ä¸€ä¸ª Certificate Signing Request (CSR) æ–‡ä»¶ï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ä¸­å®é™…ä¸Šæ˜¯ç”Ÿæˆäº†ä¸€å¯¹å…¬é’¥å’Œç§é’¥ï¼Œä¿å­˜åœ¨ä½  Mac çš„ Keychain ä¸­ã€‚<strong>ä»£ç ç­¾åæ­£æ˜¯ä½¿ç”¨è¿™ç§åŸºäºéå¯¹ç§°ç§˜é’¥çš„åŠ å¯†æ–¹å¼ï¼Œç”¨ç§é’¥è¿›è¡Œç­¾åï¼Œç”¨å…¬é’¥è¿›è¡ŒéªŒè¯ã€‚</strong></li>
<li>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ä½  Mac çš„ keychain çš„ login ä¸­å­˜å‚¨ç€ç›¸å…³çš„å…¬é’¥å’Œç§é’¥ï¼Œè€Œè¯ä¹¦ä¸­åŒ…å«äº†å…¬é’¥ã€‚ç”¨ç§é’¥æ¥è¿›è¡Œç­¾åï¼Œ<strong>è‹¹æœå°±å¯ä»¥ç”¨è¯ä¹¦ä¸­çš„å…¬é’¥æ¥è¿›è¡ŒéªŒè¯</strong>ï¼Œç¡®ä¿æ˜¯ä½ å¯¹ä»£ç è¿›è¡Œäº†ç­¾åï¼Œè€Œä¸æ˜¯åˆ«äººå†’å……ä½ ï¼ŒåŒæ—¶ä¹Ÿç¡®ä¿ä»£ç çš„å®Œæ•´æ€§ç­‰ã€‚</li>
<li>å½“ä½ æƒ³ä¸å…¶ä»–äººæˆ–å…¶ä»–è®¾å¤‡å…±äº«è¯ä¹¦æ—¶ï¼Œå¯¼å‡ºè¯ä¹¦ï¼ˆ.p12ç±»å‹ï¼‰ï¼ŒæŠŠç§é’¥ä¼ ç»™å®ƒå°±å¯ä»¥äº†ã€‚</li>
</ul>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/Certificates.png" alt=""><br>è¯ä¹¦ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼šDevelopment å’Œ Productionï¼ŒDevelopment è¯ä¹¦ç”¨æ¥å¼€å‘å’Œè°ƒè¯•åº”ç”¨ç¨‹åºï¼ŒProduction ä¸»è¦ç”¨æ¥åˆ†å‘åº”ç”¨ç¨‹åºã€‚</p>
<h3 id="Identifiers"><a href="#Identifiers" class="headerlink" title="Identifiers"></a>Identifiers</h3><p>App ID ç”¨äºæ ‡è¯†ä¸€ä¸ªæˆ–è€…ä¸€ç»„ Appï¼ŒApp ID åº”è¯¥æ˜¯å’Œ Xcode ä¸­çš„ Bundle ID æ˜¯ä¸€è‡´çš„æˆ–è€…åŒ¹é…çš„ã€‚App IDä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š</p>
<ul>
<li>An Explicit App ID Matches a Single Appï¼šå”¯ä¸€çš„App IDï¼Œè¿™ç§App IDç”¨äºå”¯ä¸€æ ‡è¯†ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ <code>com.ABC.demo1</code>ï¼Œæ ‡è¯† Bundle ID ä¸º <code>com.ABC.demo1</code> çš„ç¨‹åºã€‚</li>
<li>Wildcard App IDs Match Multiple Appsï¼šé€šé…ç¬¦App IDï¼Œç”¨äºæ ‡è¯†ä¸€ç»„åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ <code>*</code> å¯ä»¥è¡¨ç¤ºæ‰€æœ‰åº”ç”¨ç¨‹åºï¼Œè€Œ <code>com.ABC.*</code> å¯ä»¥è¡¨ç¤ºä»¥ <code>com.ABC</code> å¼€å¤´çš„æ‰€æœ‰åº”ç”¨ç¨‹åºã€‚</li>
</ul>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/Bundle%20ID.jpg" alt=""></p>
<h3 id="Devices"><a href="#Devices" class="headerlink" title="Devices"></a>Devices</h3><p>Device æ˜¯æŒ‡è¿è¡Œ iOS ç³»ç»Ÿç”¨äºå¼€å‘è°ƒè¯• App çš„è®¾å¤‡ã€‚æ¯å° Apple è®¾å¤‡ä½¿ç”¨ UDID æ¥å”¯ä¸€æ ‡è¯†ã€‚è®¾å¤‡çš„ UDID å¯é€šè¿‡ <code>iTunes-&gt;Summary</code> æˆ–è€… <code>Xcode-&gt;Window-&gt;Devices</code> è·å–ã€‚</p>
<h3 id="Provisioning-Profiles"><a href="#Provisioning-Profiles" class="headerlink" title="Provisioning Profiles"></a>Provisioning Profiles</h3><p>ä¸€ä¸ª Provisioning Profile æ–‡ä»¶åŒ…å«äº†ä¸Šè¿°çš„æ‰€æœ‰å†…å®¹ï¼š<strong>è¯ä¹¦ã€App IDã€è®¾å¤‡</strong>ã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/Provisioning%20Profiles.png" alt=""></p>
<p>åœ¨æ‰“åŒ…åº”ç”¨ç¨‹åºæˆ–è€…åœ¨çœŸæœºä¸Šè¿è¡Œè°ƒè¯•ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„è¿‡ç¨‹ï¼š</p>
<ul>
<li>ä½¿ç”¨ Certificates è¯ä¹¦æ¥è¿›è¡Œç­¾åï¼Œç”¨äºæ ‡è¯†è¯¥åº”ç”¨ç¨‹åºåˆæ³•æ€§å’Œå®Œæ•´æ€§</li>
<li>æŒ‡æ˜è¯¥åº”ç”¨ç¨‹åºçš„ App IDï¼Œå¹¶ä¸”éªŒè¯ä¸ Bundle ID æ˜¯å¦ä¸€è‡´</li>
<li>åˆ°çœŸæœºä¸­è¿è¡Œè°ƒè¯•è¯¥åº”ç”¨ç¨‹åºï¼Œç¡®è®¤è¯¥è®¾å¤‡æ˜¯å¦èƒ½å¤Ÿç”¨æ¥è¿è¡Œ</li>
</ul>
<p>Provisioning Profile æŠŠè¿™äº›ä¿¡æ¯å…¨éƒ¨æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œåœ¨æ‰“åŒ…æ—¶åµŒå…¥ <code>.ipa</code> çš„åŒ…é‡Œã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œåœ¨ä¸€å°è®¾å¤‡ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºçš„è¿‡ç¨‹å¦‚ä¸‹ï¼š<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/16185213-ea355ff0690b497a80ed5fd2dd5e62cf.png" alt=""></p>
<p>ä¸ Certificates è¯ä¹¦ä¸€æ ·ï¼ŒProvisioning Profile ä¹Ÿåˆ†ä¸º Development å’Œ Distribution ä¸¤ç§ï¼š</p>
<ul>
<li>Development</li>
<li>Distribution: In Houseã€Ad Hocã€App Store</li>
</ul>
<p>æ³¨ï¼šä½¿ç”¨ Development Provisioning Profiles æ‰“åŒ…çš„åº”ç”¨ç¨‹åºåœ¨è®¾å¤‡ä¸­è¿è¡Œï¼Œè¦æ±‚è¯¥è®¾å¤‡ UDID å¿…é¡»ç»‘å®šæ·»åŠ åˆ°è¯¥ Provisioning Profiles ä¸­ï¼Œå¦åˆ™æ— æ³•åœ¨è¯¥è®¾å¤‡ä¸­è¿è¡Œã€‚è§£å†³æ–¹æ³•æ˜¯ï¼šç»‘å®šæ·»åŠ è¯¥è®¾å¤‡ UDIDï¼Œæ›´æ–° Provisioning Profilesï¼Œé‡æ–°æ‰“åŒ…ã€‚</p>
<h2 id="Xcode-è°ƒè¯•"><a href="#Xcode-è°ƒè¯•" class="headerlink" title="Xcode è°ƒè¯•"></a>Xcode è°ƒè¯•</h2><h3 id="Xcode-æ¨¡æ‹Ÿå™¨è°ƒè¯•"><a href="#Xcode-æ¨¡æ‹Ÿå™¨è°ƒè¯•" class="headerlink" title="Xcode æ¨¡æ‹Ÿå™¨è°ƒè¯•"></a>Xcode æ¨¡æ‹Ÿå™¨è°ƒè¯•</h3><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># æ·»åŠ /ç§»é™¤ iOS é¡¹ç›®</span></div><div class="line">phonegap <span class="built_in">platform</span> <span class="built_in">add</span> ios</div><div class="line">phonegap <span class="built_in">platform</span> remove ios</div><div class="line"><span class="comment"># æ›´æ–° iOS é¡¹ç›®</span></div><div class="line">phonegap <span class="built_in">prepare</span> ios</div></pre></td></tr></table></figure>
<p>åœ¨ <code>/platforms/ios</code> ç›®å½•ä¸‹åŒå‡»æ‰“å¼€ <code>.xcworkspace</code> æ–‡ä»¶ï¼ŒXcode ä¸­é€‰æ‹©å¯¹åº”çš„æ¨¡æ‹Ÿå™¨å³å¯è¿è¡Œã€‚</p>
<h3 id="Xcode-çœŸæœºè°ƒè¯•"><a href="#Xcode-çœŸæœºè°ƒè¯•" class="headerlink" title="Xcode çœŸæœºè°ƒè¯•"></a>Xcode çœŸæœºè°ƒè¯•</h3><p>Xcode çœŸæœºè°ƒè¯•éœ€è¦ç”³è¯· Certificates è¯ä¹¦ï¼Œç„¶åæ·»åŠ è°ƒè¯•è®¾å¤‡ UDIDï¼Œç”Ÿæˆ Provisioning Profilesï¼ˆDevelopment ç±»å‹ï¼‰ï¼Œä¸‹è½½åˆ°ç”µè„‘ä¸­ï¼ŒåŒå‡»å®‰è£…ã€‚<br>è‹¹æœè®¾å¤‡è¿æ¥ç”µè„‘ï¼ŒXcode -&gt; Build Settings è®¾ç½® Code Signing Identity å’Œ Provisioning Profilesï¼Œè®¾ç½®å®Œæˆåï¼Œé€‰æ‹©è¯¥è®¾å¤‡è¿è¡Œå³å¯ã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/Xcode-debug.jpg" alt=""></p>
<p>å½“ç„¶ <a href="http://www.jianshu.com/p/351be39f959e" target="_blank" rel="external">Xcode7ä»¥åï¼Œæ— è¯ä¹¦ä¹Ÿèƒ½çœŸæœºç¼–è¯‘è°ƒè¯•ï¼</a></p>
<h2 id="åº”ç”¨æ‰“åŒ…"><a href="#åº”ç”¨æ‰“åŒ…" class="headerlink" title="åº”ç”¨æ‰“åŒ…"></a>åº”ç”¨æ‰“åŒ…</h2><blockquote>
<p>cordova iOS åº”ç”¨æ‰“åŒ… <a href="https://cordova.apache.org/docs/en/latest/guide/platforms/ios/#signing-an-app" target="_blank" rel="external">å‚è€ƒæ–‡æ¡£</a></p>
</blockquote>
<p>ä½¿ç”¨ Development å’Œ Distribution çš„ Certificates å’Œ Provisioning Profiles å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œæ‰“åŒ…çš„åŒºåˆ«æ˜¯ï¼šDevelopment æ‰“å‡ºæ¥çš„åŒ…å¯ä»¥è¿›è¡Œåº”ç”¨è°ƒè¯•ï¼Œè­¬å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ Safari å¯¹ç½‘é¡µè¿›è¡Œè°ƒè¯•ã€‚</p>
<p>cordova æä¾›äº†ä¸€å¥—æ‰“åŒ…è§£å†³æ–¹æ¡ˆï¼Œåœ¨é¡¹ç›®<strong>æ ¹ç›®å½•</strong>æ·»åŠ  <code>build.json</code> æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ä¸­éœ€è¦æŒ‡å®šçš„å‚æ•°åŒ…æ‹¬ï¼š</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Code Sign Identity</td>
<td>â€“codeSignIdentity</td>
<td>Code signing identity to use for signing.</td>
</tr>
<tr>
<td>Provisioning Profile</td>
<td>â€“provisioningProfile</td>
<td>GUID of the provisioning profile to be used for signing. It is copied here on your Mac: <code>~/Library/MobileDevice/Provisioning\ Profiles/</code>.</td>
</tr>
<tr>
<td>Code Sign Resource Rules</td>
<td>â€“codesignResourceRules    (Optional)</td>
<td>Used to control which files in a bundle should be sealed by a code signature. For more details, read The OS X Code Signing In Depth article.</td>
</tr>
<tr>
<td>Development Team</td>
<td>â€“developmentTeam</td>
<td>This is new for Xcode 8. The development team (Team ID) to use for code signing. You would use this setting and a simplified Code Sign Identity (i.e. just â€˜iPhone Developerâ€™) to sign your apps, you do not need to provide a Provisioning Profile.</td>
</tr>
<tr>
<td>Packaging Type</td>
<td>â€“packageType</td>
<td>This will determine what type of build is generated by Xcode. Valid options are development (the default), enterprise, ad-hoc, and app-store.</td>
</tr>
</tbody>
</table>
<p>è§£é‡Šä¸€ä¸‹éœ€è¦ç”¨åˆ°çš„å››ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><strong>Code Sign Identity</strong>ï¼šåº”ç”¨ç¨‹åºç­¾åæ—¶ä½¿ç”¨çš„è¯ä¹¦æ ‡è¯†ã€‚å¦‚ä¸‹å›¾<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/Code%20Sign%20Identity.jpg" alt=""></li>
<li><strong>Provisioning Profile</strong>ï¼šProvisioning Profile çš„ GUIDã€‚è¿›å…¥ <code>~/Library/MobileDevice/Provisioning\ Profiles/</code> ç›®å½•ï¼Œå³å¯è·å–åˆ°å¯¹åº” Provisioning Profile çš„ GUID<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/GUID.jpg" alt=""></li>
<li><strong>Development Team</strong>ï¼šå¼€å‘å›¢é˜Ÿ ID<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/TeamID.jpg" alt=""></li>
<li><strong>Packaging Type</strong>ï¼šæ‰“åŒ…ç±»å‹ï¼ŒåŒ…æ‹¬ï¼šdevelopmentã€enterprise, ad-hoc, å’Œ app-store</li>
</ul>
<p><code>build.json</code> é…ç½®å¦‚ä¸‹ï¼š<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"ios"</span>: &#123;</div><div class="line">        <span class="attr">"debug"</span>: &#123;</div><div class="line">            <span class="attr">"codeSignIdentity"</span>: <span class="string">"iPhone Developer: Deng Yingshan (Z7********)"</span>,</div><div class="line">            <span class="attr">"provisioningProfile"</span>: <span class="string">"91840e00-****-****-****-************"</span>,</div><div class="line">            <span class="attr">"developmentTeam"</span>: <span class="string">"32********"</span>,</div><div class="line">            <span class="attr">"packageType"</span>: <span class="string">"development"</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">"release"</span>: &#123;</div><div class="line">            <span class="attr">"codeSignIdentity"</span>: <span class="string">"iPhone Distribution: Zhuhai Kingsoft Office Software Co., Ltd."</span>,</div><div class="line">            <span class="attr">"provisioningProfile"</span>: <span class="string">"ce06cf9c-****-****-****-************"</span>,</div><div class="line">            <span class="attr">"packageType"</span>: <span class="string">"enterprise"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>â—ï¸æ³¨æ„ï¼š</strong></p>
<ul>
<li>ç­¾åè¯ä¹¦ Identity ä¸€å®šè¦å’Œ Provisioning Profiles GUID å¯¹åº”ä¸Šï¼Œå¦åˆ™æ‰“åŒ…ä¸æˆåŠŸ</li>
<li>æ‰“åŒ…ç±»å‹ enterprise å³ä¸ºä½¿ç”¨ in house ç±»å‹çš„ Distribution Provisioning Profiles</li>
</ul>
<h3 id="Development"><a href="#Development" class="headerlink" title="Development"></a>Development</h3><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">cordova</span> <span class="comment">build</span> <span class="comment">ios</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">device</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">debug</span></div></pre></td></tr></table></figure>
<ul>
<li>æ‰“ Development å¿…é¡»ä½¿ç”¨ Development ç±»å‹çš„ Certificates å’Œ Provisioning Profilesã€‚</li>
<li>é…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨ <code>debug</code> å±æ€§é…ç½®å‚æ•°ï¼›æ‰“åŒ…å‘½ä»¤æŒ‡å®š <code>--debug</code>ã€‚</li>
</ul>
<h3 id="Distribution"><a href="#Distribution" class="headerlink" title="Distribution"></a>Distribution</h3><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">cordova</span> <span class="comment">build</span> <span class="comment">ios</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">device</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">release</span></div></pre></td></tr></table></figure>
<ul>
<li>æ‰“ Distribution å¿…é¡»ä½¿ç”¨ Distribution ç±»å‹çš„ Certificates å’Œ Provisioning Profilesã€‚</li>
<li>é…ç½®æ–‡ä»¶ä¸­ï¼Œåœ¨ <code>release</code> å±æ€§é…ç½®å‚æ•°ï¼›æ‰“åŒ…å‘½ä»¤æŒ‡å®š <code>--release</code>ã€‚</li>
<li>ç”±äº Distribution ç±»å‹åŒ…æ‹¬ï¼šIn Houseã€Ad Hocã€App Store ä¸‰ç§ï¼Œå¯¹åº”åœ¨é…ç½®æ–‡ä»¶ä¸­çš„ <code>packageType</code> åˆ†åˆ«ä¸ºï¼š<code>enterprise</code>, <code>ad-hoc</code>, å’Œ <code>app-store</code></li>
</ul>
<p>æœ€ç»ˆæ‰“åŒ…æˆåŠŸåï¼Œæˆ‘ä»¬åœ¨ <code>platforms/ios/build/device</code> ç›®å½•ä¸‹æ‰¾åˆ° <code>.ipa</code> æ–‡ä»¶</p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://cordova.apache.org/docs/en/latest/guide/platforms/ios/#signing-an-app" target="_blank" rel="external">Signing an App</a><br><a href="http://www.cnblogs.com/cywin888/p/3263027.html" target="_blank" rel="external">å…³äºCertificateã€Provisioning Profileã€App IDçš„ä»‹ç»åŠå…¶ä¹‹é—´çš„å…³ç³»</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/ios.jpg&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="Cordova" scheme="http://objcer.com/categories/Cordova/"/>
    
    
      <category term="cordova-build" scheme="http://objcer.com/tags/cordova-build/"/>
    
  </entry>
  
  <entry>
    <title>JS æ•°ç»„æ’åº sort æ–¹æ³•</title>
    <link href="http://objcer.com/2017/05/21/JS-Array-sort/"/>
    <id>http://objcer.com/2017/05/21/JS-Array-sort/</id>
    <published>2017-05-21T08:42:51.000Z</published>
    <updated>2017-05-21T08:45:30.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>[é—®é¢˜å¼•å…¥]:</em>åœ¨æ¨ç‰¹ä¸Šçœ‹åˆ°æœ‰äººå‘äº†è¿™æ ·ä¸€æ®µä»£ç <br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">var a = [<span class="number">0</span>, <span class="number">-1</span>, <span class="number">-2</span>, <span class="number">1</span>];</div><div class="line">var b = a.sort();</div><div class="line">console.log(b);</div></pre></td></tr></table></figure></p>
<p>è¾“å‡ºçš„ç»“æœç«Ÿç„¶æ˜¯ï¼š<code>[-1, -2, 0, 1]</code><br>æ˜¾ç„¶è¯¥æ¨å‹å¯¹ <code>Array.prototype.sort</code> ç”¨æ³•ä¸ç†Ÿæ‚‰å¯¼è‡´çš„è¯¯è§£ã€‚ğŸ¤“<br><a id="more"></a></p>
<h2 id="Array-prototype-sort"><a href="#Array-prototype-sort" class="headerlink" title="Array.prototype.sort"></a><code>Array.prototype.sort</code></h2><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">arr</span><span class="selector-class">.sort</span>()</div><div class="line"></div><div class="line"><span class="selector-tag">arr</span><span class="selector-class">.sort</span>(<span class="selector-tag">compareFunction</span>)</div></pre></td></tr></table></figure>
<p><code>sort</code> æ–¹æ³•å¯¹æ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼Œè¿”å›æ•°ç»„ï¼›å¯ä»¥æŒ‡å®šæ’åºé¡ºåºæ¯”è¾ƒå‡½æ•°ï¼Œå¦‚æœçœç•¥ï¼Œé‚£ä¹ˆé»˜è®¤æ’åºé¡ºåºæ˜¯æ ¹æ®å­—ç¬¦ä¸² Unicode ç ç‚¹<strong>å‡åºæ’åˆ—</strong>ã€‚<br>é€šè¿‡ä¸€ä¸ªä¾‹å­ç†è§£ä¸€ä¸‹ï¼š<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">var scores = [<span class="number">1</span>, <span class="number">10</span>, <span class="number">21</span>, <span class="number">8</span>];</div><div class="line">scores.sort(); <span class="comment">// [1, 10, 21, 8]</span></div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬å¯¹æ•°ç»„ <code>scores</code> è¿›è¡Œæ’åºï¼Œæ²¡æœ‰æŒ‡æ˜ <code>compareFunction</code> ï¼Œé‚£ä¹ˆå…ƒç´ ä¼šæŒ‰ç…§è½¬æ¢ä¸ºçš„å­—ç¬¦ä¸²çš„è¯¸ä¸ªå­—ç¬¦çš„ Unicode ç ç‚¹è¿›è¡Œå‡åºæ’åˆ—ã€‚ç›¸å½“äºæ˜¯<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> scores = [<span class="string">'1'</span>, <span class="string">'10'</span>, <span class="string">'21'</span>, <span class="string">'8'</span>];</div><div class="line">scores.sort();</div></pre></td></tr></table></figure></p>
<blockquote>
<p>å…³äºç ç‚¹ï¼Œå‚è€ƒæ–‡ç« ï¼š<a href="http://objcer.com/2017/05/21/JavaScript-Unicode/">JavaScript Unicode ç¼–ç é‚£äº›äº‹</a></p>
</blockquote>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">'<span class="number">1</span>'.codePointAt(<span class="number">0</span>) <span class="comment">// 49</span></div><div class="line">'<span class="number">8</span>'.codePointAt(<span class="number">0</span>) <span class="comment">// 56</span></div></pre></td></tr></table></figure>
<p>å­—ç¬¦ <code>1</code> çš„ç ç‚¹æ¯”å­—ç¬¦ <code>8</code> çš„ç ç‚¹å°ï¼Œæ‰€ä»¥ <code>10</code> æ’åœ¨ <code>8</code> å‰é¢ã€‚åŒç†ä¹Ÿå°±å¯ä»¥è§£é‡Šæ–‡ç« å¼€å¤´çš„ä¾‹å­äº†ã€‚</p>
<h2 id="compareFunction"><a href="#compareFunction" class="headerlink" title="compareFunction"></a><code>compareFunction</code></h2><p>æ¯”è¾ƒå‡½æ•°æ ¼å¼å¦‚ä¸‹ï¼š<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">function compare(a, b) &#123;</div><div class="line">    <span class="keyword">if</span> (a <span class="keyword">is</span> less than b <span class="keyword">by</span> some ordering criterion) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (a <span class="keyword">is</span> greater than b <span class="keyword">by</span> the ordering criterion) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// a must be equal to b</span></div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æœ‰ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¯”è¾ƒå‡½æ•°å¿…é¡»è¿”å› -1 æˆ–è€… 0 æˆ–è€… 1ï¼›è€Œä¸èƒ½è¿”å› true æˆ–è€… falseã€‚</p>
<p>ä¸ºäº†å®ç°å…ƒç´ ä¸ºæ•°å­—çš„æ•°ç»„æŒ‰ç…§æ•°å€¼å‡åºæ’åˆ—ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¼ å…¥ä¸€ä¸ªæ¯”è¾ƒå‡½æ•° <code>compareFunction</code>ï¼Œå¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> scores = [<span class="number">1</span>, <span class="number">10</span>, <span class="number">21</span>, <span class="number">8</span>];</div><div class="line">scores.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b) <span class="comment">// å‡åºæ’åˆ—</span></div><div class="line">scores.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> b - a) <span class="comment">// é™åºæ’åˆ—</span></div></pre></td></tr></table></figure></p>
<p>é€šè¿‡æ¯”è¾ƒå‡½æ•°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å¯¹è±¡æ•°ç»„æŒ‰ç…§æŸä¸ªå±æ€§è¿›è¡Œæ’åºï¼Œå¾ˆæ–¹ä¾¿ã€‚</p>
<h2 id="sort-æ’åºä¸ä¸€å®šæ˜¯ç¨³å®šçš„"><a href="#sort-æ’åºä¸ä¸€å®šæ˜¯ç¨³å®šçš„" class="headerlink" title="sort æ’åºä¸ä¸€å®šæ˜¯ç¨³å®šçš„"></a>sort æ’åºä¸ä¸€å®šæ˜¯ç¨³å®šçš„</h2><blockquote>
<p>Quicksort is generally considered to be efficient and fast and so is used by V8 as the implementation for Array.prototype.sort() on arrays with more than 23 items. For less than 23 items, V8 uses insertion sort[2]. Merge sort is a competitor of quicksort as it is also efficient and fast but has the added benefit of being stable. This is why Mozilla and Safari use it for their implementation of Array.prototype.sort().</p>
</blockquote>
<p>å…³äºæ’åºæ˜¯å¦ç¨³å®šï¼Œå‚è€ƒ: <a href="http://imweb.io/topic/565cf7253ad940357eb99881" target="_blank" rel="external">ç»´åŸºç™¾ç§‘</a><br>è¿™ä¸ªå›¾ä¹Ÿèƒ½å¾ˆå¥½çš„ç†è§£<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/440px-Sorting_stability_playing_cards.svg.png" alt=""></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Array/sort" target="_blank" rel="external">MDN Array.prototype.sort</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;[é—®é¢˜å¼•å…¥]:&lt;/em&gt;åœ¨æ¨ç‰¹ä¸Šçœ‹åˆ°æœ‰äººå‘äº†è¿™æ ·ä¸€æ®µä»£ç &lt;br&gt;&lt;figure class=&quot;highlight lsl&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;var a = [&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;-2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;];&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;var b = a.sort();&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;console.log(b);&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¾“å‡ºçš„ç»“æœç«Ÿç„¶æ˜¯ï¼š&lt;code&gt;[-1, -2, 0, 1]&lt;/code&gt;&lt;br&gt;æ˜¾ç„¶è¯¥æ¨å‹å¯¹ &lt;code&gt;Array.prototype.sort&lt;/code&gt; ç”¨æ³•ä¸ç†Ÿæ‚‰å¯¼è‡´çš„è¯¯è§£ã€‚ğŸ¤“&lt;br&gt;
    
    </summary>
    
      <category term="JS" scheme="http://objcer.com/categories/JS/"/>
    
    
      <category term="Array.prototype.sort" scheme="http://objcer.com/tags/Array-prototype-sort/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript Unicode ç¼–ç é‚£äº›äº‹</title>
    <link href="http://objcer.com/2017/05/21/JavaScript-Unicode/"/>
    <id>http://objcer.com/2017/05/21/JavaScript-Unicode/</id>
    <published>2017-05-21T08:36:57.000Z</published>
    <updated>2017-07-21T01:47:26.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/IMG_1915.PNG" alt=""><br><a id="more"></a></p>
<h2 id="BMP-Basic-Multilingual-Plane-å­—ç¬¦"><a href="#BMP-Basic-Multilingual-Plane-å­—ç¬¦" class="headerlink" title="BMP(Basic Multilingual Plane)å­—ç¬¦"></a>BMP(Basic Multilingual Plane)å­—ç¬¦</h2><p>Unicode æ˜¯ç›®å‰ç»å¤§å¤šæ•°ç¨‹åºä½¿ç”¨çš„å­—ç¬¦ç¼–ç ã€‚Unicode æ ‡è¯†ç¬¦é€šè¿‡ä¸€ä¸ªæ˜ç¡®çš„åå­—å’Œä¸€ä¸ªæ•´æ•°æ¥ä½œä¸ºå®ƒçš„ç ç‚¹/ç ä½ (code point)ã€‚æ¯”å¦‚ï¼Œâ€œÂ©ï¸â€ å­—ç¬¦å¯ä»¥ç”¨â€œç‰ˆæƒæ ‡å¿—â€ å’Œç ä½ U+00A9 (0xA9ï¼Œä¹Ÿå¯ä»¥å†™ä½œåè¿›åˆ¶ 169) æ¥è¡¨ç¤ºã€‚</p>
<p><strong>ç ç‚¹/ç ä½</strong>æ˜¯ä¸ºæ¯ä¸€ä¸ªå­—ç¬¦æä¾›ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œä¸€ä¸ªç ä½æ˜ å°„ä¸€ä¸ªå­—ç¬¦ï¼Œç ä½å€¼çš„èŒƒå›´æ˜¯ä»U+0000åˆ°U+10FFFFï¼Œå¯ä»¥è¡¨ç¤ºè¶…è¿‡110ä¸‡ä¸ªç¬¦å·ã€‚</p>
<p>Unicode å­—ç¬¦åˆ†ä¸º 17 ç»„å¹³é¢ï¼Œæ¯ä¸ªå¹³é¢æ‹¥æœ‰ 2^16 (65,536) ä¸ªç ä½ã€‚æ¯ä¸€ä¸ªç ä½éƒ½å¯ä»¥ç”¨ 16 è¿›åˆ¶ xy0000 åˆ° xyFFFF æ¥è¡¨ç¤ºï¼Œè¿™é‡Œçš„ xy æ˜¯è¡¨ç¤ºä¸€ä¸ª 16 è¿›åˆ¶çš„å€¼ï¼Œä» 00 åˆ° 10ã€‚</p>
<p>è€Œå½“ xy æ˜¯ 00 (ç ç‚¹èŒƒå›´æ˜¯ä»U+0000åˆ°U+FFFF) çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯ Unicode æœ€å‰ 2^16 (65,536) ä¸ªå­—ç¬¦ï¼Œè¢«ç§°ä¸º<strong>åŸºæœ¬å¹³é¢ BMP(Basic Multilingual Plane)</strong>ï¼Œæœ€å¸¸è§çš„å­—ç¬¦éƒ½åœ¨è¿™ä¸ªå¹³é¢ä¸Šï¼Œè¿™ä¹Ÿæ˜¯ Unicode æœ€å…ˆå®šä¹‰å’Œæœ€å…ˆå…¬å¸ƒçš„ä¸€ä¸ªå¹³é¢ã€‚</p>
<p>å…¶ä½™ 16 ä¸ªå¹³é¢ï¼ˆU+100000 åˆ° U+10FFFFï¼‰ç§°ä¸º<strong>è¡¥å……å¹³é¢(supplementary planes, or astral planes)</strong>ï¼Œä¹Ÿç§°ä¹‹ä¸ºè¡¥å……å­—ç¬¦ï¼Œç›¸å¯¹äº BMP å­—ç¬¦è€Œè¨€ï¼Œè¿™äº›å­—ç¬¦ç§°ä¹‹ä¸ºé BMP å­—ç¬¦ã€‚è¦åŒºåˆ†æ˜¯é BMP å­—ç¬¦å¾ˆç®€å•ï¼šå…¶ç ä½éœ€è¦è¶…è¿‡ 4 ä½ 16 è¿›åˆ¶è¡¨ç¤º</p>
<h2 id="UTF-16-å’Œ-UCS-2"><a href="#UTF-16-å’Œ-UCS-2" class="headerlink" title="UTF-16 å’Œ UCS-2"></a>UTF-16 å’Œ UCS-2</h2><h3 id="UTF-16"><a href="#UTF-16" class="headerlink" title="UTF-16"></a>UTF-16</h3><p>UTF-16 å¯¹äº BMP å­—ç¬¦çš„ç ä½ï¼Œç”¨ 2 ä¸ªå­—èŠ‚è¿›è¡Œç¼–ç ï¼›è€Œé BMP å­—ç¬¦çš„ç ä½ï¼Œç”¨ 4 ä¸ªå­—èŠ‚ç»„æˆä»£ç†å¯¹ï¼ˆsurrogate pairï¼‰æ¥è¡¨ç¤ºã€‚</p>
<p>å…³äº<strong>ä»£ç†å¯¹</strong>ï¼šå‰ä¸¤ä¸ªå­—èŠ‚ç§°ä¸ºé«˜ä½ä»£ç†æˆ–è€…é¡¶éƒ¨ä»£ç†ï¼Œ<strong>èŒƒå›´åœ¨ 0xD800 åˆ° 0xDBFF ä¹‹é—´</strong>ï¼›åä¸¤ä¸ªå­—èŠ‚ç§°ä¸ºä½ä½ä»£ç†æˆ–è€…å°¾éƒ¨ä»£ç†ï¼Œ<strong>èŒƒå›´åœ¨ 0xDC00 åˆ° 0xDFFF ä¹‹é—´</strong>ã€‚</p>
<p><strong>ç ä½ï¼ˆcode pointsï¼‰å’Œä»£ç†å¯¹ï¼ˆsurrogate pairsï¼‰ä¹‹é—´çš„è½¬æ¢ï¼š</strong><br>å‡è®¾ï¼šä¸€ä¸ªç ä½ C å¤§äº 0xFFFF çš„ç¼–ç ä½¿ç”¨ä»£ç†å¯¹ <h, l=""> æ¥è¡¨ç¤ºçš„å…¬å¼ä¸ºï¼š<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">H = Math.floor((C - <span class="number">0x10000</span>) / <span class="number">0x400</span>) + <span class="number">0xD800</span></div><div class="line">L = (C - <span class="number">0x10000</span>) % <span class="number">0x400</span> + <span class="number">0xDC00</span></div></pre></td></tr></table></figure></h,></p>
<p>è½¬æ¢å…¬å¼å˜æ¢åï¼Œæ¯”å¦‚ä»ä»£ç†å¯¹ <h, l=""> è½¬æ¢æˆä¸€ä¸ª Unicode ç ä½ Cï¼Œå¯ä»¥ä½¿ç”¨å…¬å¼ï¼š<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">C = (H - <span class="number">0xD800</span>) * <span class="number">0x400</span> + L - <span class="number">0xDC00</span> + <span class="number">0x10000</span></div></pre></td></tr></table></figure></h,></p>
<p>ä»£ç å®ç°å¦‚ä¸‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// codePoint &gt; 0xFFFF</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getSurrogates</span>(<span class="params">codePoint</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> high = <span class="built_in">Math</span>.floor((codePoint - <span class="number">0x10000</span>) / <span class="number">0x400</span>) + <span class="number">0xD800</span>;</div><div class="line">  <span class="keyword">var</span> low = (codePoint - <span class="number">0x10000</span>) % <span class="number">0x400</span> + <span class="number">0xDC00</span>;</div><div class="line">  <span class="keyword">return</span> [high, low];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCodePoint</span>(<span class="params">high, low</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> codePoint = (high - <span class="number">0xD800</span>) * <span class="number">0x400</span> + low - <span class="number">0xDC00</span> + <span class="number">0x10000</span>;</div><div class="line">  <span class="keyword">return</span> codePoint;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="UCS-2"><a href="#UCS-2" class="headerlink" title="UCS-2"></a>UCS-2</h3><p>UCS(Universal Character Set) é€šç”¨å­—ç¬¦é›†ï¼Œæ˜¯ä¸€ä¸ª ISO æ ‡å‡†ï¼ŒUCS-2 ç”¨ 2 ä¸ªå­—èŠ‚è¡¨ç¤º BMP å­—ç¬¦çš„ç ç‚¹ï¼ŒUCS-2 æ˜¯ä¸€ä¸ªè¿‡æ—¶çš„ç¼–ç æ–¹å¼ï¼Œå› ä¸ºå®ƒåªèƒ½ç¼–ç åŸºæœ¬å¹³é¢ BMP çš„ç ç‚¹ï¼Œåœ¨ BMP å­—ç¬¦çš„ç¼–ç ä¸Šï¼Œä¸ UTF-16 æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸ºæ˜¯UTF-16çš„ä¸€ä¸ªå­é›†ã€‚</p>
<h3 id="JavaScript-æ˜¯ç”¨å“ªä¸€ç§ç¼–ç æ–¹å¼çš„å‘¢ï¼Ÿ"><a href="#JavaScript-æ˜¯ç”¨å“ªä¸€ç§ç¼–ç æ–¹å¼çš„å‘¢ï¼Ÿ" class="headerlink" title="JavaScript æ˜¯ç”¨å“ªä¸€ç§ç¼–ç æ–¹å¼çš„å‘¢ï¼Ÿ"></a>JavaScript æ˜¯ç”¨å“ªä¸€ç§ç¼–ç æ–¹å¼çš„å‘¢ï¼Ÿ</h3><p>é‚£ä¹ˆ JavaScript æ˜¯ç”¨å“ªä¸€ç§ç¼–ç æ–¹å¼çš„å‘¢ï¼ŸUTF-16 è¿˜æ˜¯ UCS-2 å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼šUCS-2<br>åŸºäºå¦‚ä¸‹å¹´è¡¨ï¼š</p>
<ul>
<li>1990 UCS-2 è¯ç”Ÿ</li>
<li>1995.5 JavaScript è¯ç”Ÿ</li>
<li>1996.7 UTF-16 è¯ç”Ÿ</li>
</ul>
<p>æ‰€ä»¥ JS è¯ç”Ÿä¹‹æ—¶ UTF-16 è¿˜æ²¡æœ‰é—®ä¸–ï¼Œæ‰€ä»¥åªèƒ½ç”¨ æ¥å¤„ç†å­—ç¬¦ï¼Œè€Œè¿™ä¹Ÿä¸ºå­—ç¬¦å¤„ç†ç•™ä¸‹äº†éšæ‚£ï¼Œè€Œåæ¥é€šè¿‡ä¸æ–­å®Œå–„ï¼Œè­¬å¦‚å¼•å…¥ UTF-16 å°†é—®é¢˜ä¸€æ­¥æ­¥è§£å†³ã€‚</p>
<h2 id="JavaScript-å­—ç¬¦å¤„ç†"><a href="#JavaScript-å­—ç¬¦å¤„ç†" class="headerlink" title="JavaScript å­—ç¬¦å¤„ç†"></a>JavaScript å­—ç¬¦å¤„ç†</h2><h3 id="length-å±æ€§"><a href="#length-å±æ€§" class="headerlink" title="length å±æ€§"></a>length å±æ€§</h3><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="keyword">char</span> = <span class="string">'ğŸ’©'</span></div><div class="line"><span class="keyword">char</span>.length === <span class="number">2</span> <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="keyword">char</span>.charCodeAt(<span class="number">0</span>).toString(<span class="number">16</span>) <span class="comment">// d83d</span></div><div class="line"><span class="keyword">char</span>.charCodeAt(<span class="number">1</span>).toString(<span class="number">16</span>) <span class="comment">// dca9</span></div><div class="line"><span class="keyword">char</span> === <span class="string">'\ud83d\udca9'</span> <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p><strong>åˆ†æï¼š</strong><br>ç”±äº ğŸ’© è¿™ä¸ª emoji åœ¨ JSä¸­ç¼–ç ä¸º <code>\ud83d\udca9</code>ï¼Œè€Œ JS è®¤ä¸ºæ¯ä¸¤ä¸ªå­—èŠ‚å³è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ ğŸ’© è¿™ä¸ª emoji å­—ç¬¦çš„å­—ç¬¦é•¿åº¦å°±ä¸º 2ã€‚æ‰€ä»¥åœ¨è¾“å…¥æ¡†é•¿åº¦é™åˆ¶æ—¶å°±ä¼šæœ‰é—®é¢˜ï¼Œè­¬å¦‚ï¼šè¾“å…¥é•¿åº¦é™åˆ¶ 20ï¼Œä½†æ˜¯è¾“å…¥ 10 ä¸ª emoji åï¼Œå­—ç¬¦ä¸²é•¿åº¦å°±è¾¾åˆ° 20 äº†ã€‚</p>
<p><strong>è§£å†³æ–¹æ³•ï¼š</strong><br>ä¸Šä¸€èŠ‚ä¸­ï¼Œäº†è§£åˆ° UTF-16 ä½¿ç”¨ä»£ç†å¯¹ï¼Œé€šè¿‡å››ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºé BMP å­—ç¬¦ï¼Œå‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚éƒ½æœ‰å„è‡ªçš„èŒƒå›´ï¼Œæ‰€ä»¥ï¼š<br><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> regexAstralSymbols = <span class="regexp">/[\uD800-\uDBFF][\uDC00-\uDFFF]/g</span>; <span class="comment">// åŒ¹é…UTF-16çš„ä»£ç†å¯¹</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countSymbols</span>(<span class="params">string</span>) </span>&#123;</div><div class="line">    <span class="comment">// æŠŠä»£ç†å¯¹æ”¹ä¸ºä¸€ä¸ªBMPçš„å­—ç¬¦ï¼Œè¿™æ—¶å€™å–é•¿åº¦å°±æ­£å¸¸</span></div><div class="line">    <span class="keyword">return</span> <span class="built_in">string</span>.replace(regexAstralSymbols, <span class="string">'_'</span>).length;</div><div class="line">&#125;</div><div class="line">countSymbols(<span class="string">'ğŸ’©'</span>); <span class="comment">// 1</span></div></pre></td></tr></table></figure></p>
<hr>
<p>â—ï¸<strong>æ³¨æ„ï¼š</strong>å­—ç¬¦ä¸²ä¸­åŒ…å«æœ‰ emoji å­—ç¬¦æ—¶ï¼Œæ­¤è§£å†³æ–¹æ³•åªé€‚ç”¨äºä¸€éƒ¨åˆ† emojiï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">countSymbols</span><span class="params">(<span class="string">'1ï¸âƒ£'</span>)</span></span> <span class="comment">// 3</span></div><div class="line"><span class="function"><span class="title">countSymbols</span><span class="params">(<span class="string">'ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦'</span>)</span></span> <span class="comment">// 7</span></div></pre></td></tr></table></figure></p>
<p><strong>å…³äºæ­£ç¡®è®¡ç®— emoji å­—ç¬¦çš„é—®é¢˜è¯·å‚è€ƒæ–‡ç« ï¼š<a href="http://objcer.com/2017/07/20/explore-emoji-length/">æ¢ç©¶ emoji å­—ç¬¦é•¿åº¦</a> æ–‡ç« ç»™å‡ºæ¢ç©¶åˆ†æè¿‡ç¨‹ï¼Œå¹¶æä¾›äº† <a href="https://github.com/YingshanDeng/EmojiCharString" target="_blank" rel="external">EmojiCharString</a> ç±»åº“ï¼Œç”¨äºå½»åº•è§£å†³æ­¤é—®é¢˜ ğŸ¤“</strong></p>
<h3 id="åè½¬å­—ç¬¦ä¸²"><a href="#åè½¬å­—ç¬¦ä¸²" class="headerlink" title="åè½¬å­—ç¬¦ä¸²"></a>åè½¬å­—ç¬¦ä¸²</h3><p>å¯¹äºåè½¬å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå¿«çš„å†™å‡ºå¦‚ä¸‹å‡½æ•°ï¼š<br><figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">function <span class="built_in">reverse</span>(<span class="built_in">str</span>) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">str</span>.<span class="built_in">split</span>(<span class="string">''</span>).<span class="built_in">reverse</span>().<span class="built_in">join</span>(<span class="string">''</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¿›è¡Œä¸€ä¸‹æµ‹è¯•ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">reverse</span><span class="params">(<span class="string">'123'</span>)</span></span> <span class="comment">// "321"</span></div><div class="line"><span class="function"><span class="title">reverse</span><span class="params">(<span class="string">'ğŸ’©'</span>)</span></span> <span class="comment">// "ï¿½ï¿½"</span></div></pre></td></tr></table></figure></p>
<p><strong>åˆ†æï¼š</strong><br>ï¿½ çš„ Unicode ç ä½æ˜¯ U+FFFDï¼Œé€šå¸¸ç”¨æ¥è¡¨ç¤º Unicode è½¬æ¢æ—¶æ— æ³•è¯†åˆ«çš„å­—ç¬¦ï¼ˆä¹Ÿå°±æ˜¯ä¹±ç ï¼‰ã€‚å½“ğŸ’©ï¼ˆ\ud83d\udca9ï¼‰é€šè¿‡ä¸Šè¿°æ–¹æ³•åè½¬æ—¶ï¼Œå˜æˆ\udca9\ud83dï¼Œä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„ä»£ç†å¯¹ï¼ˆé«˜ä½å­—èŠ‚èŒƒå›´ä¸åŒï¼‰ï¼ŒåŒæ—¶ Unicode è§„å®šä»£ç†å¯¹èŒƒå›´å†…çš„ç ä½ä¸èƒ½å•ç‹¬å‡ºç°ï¼Œæ‰€ä»¥ js åªèƒ½ç”¨ ï¿½ è¡¨ç¤ºäº†ã€‚</p>
<p><strong>è§£å†³æ–¹æ³•ï¼š</strong><br>ES6 ä¸­æ•°ç»„æ–°å¢äº†é™æ€æ–¹æ³• <code>Array.from</code>ï¼Œæ­¤æ–¹æ³•æ”¯æŒå¯¹ä»£ç†å¯¹çš„è§£æ<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function">function <span class="title">reverse</span>(<span class="params"><span class="keyword">string</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> Array.<span class="keyword">from</span>(<span class="keyword">string</span>).reverse().<span class="keyword">join</span>(<span class="string">''</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p><code>Array.from</code> æ–¹æ³•çš„ä½œç”¨æ˜¯å°†ä¸€ä¸ª <code>array-like</code> æˆ–è€… <code>iterable object</code> è½¬æ¢æˆä¸€ä¸ª Array å¯¹è±¡ã€‚æœ€å¸¸è§çš„æ˜¯ <code>NodeList</code> å’Œå‡½æ•°å‚æ•° <code>arguments</code>ï¼Œåœ¨å®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å°†å®ƒä»¬è½¬æ¢æˆæ•°ç»„ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä»¥å¾€çš„è§£å†³æ–¹æ³•ï¼š</span></div><div class="line"><span class="keyword">var</span> imgs = [].slice.call(<span class="built_in">document</span>.querySelectorAll(<span class="string">'img'</span>));</div><div class="line"><span class="keyword">var</span> args = [].slice.call(<span class="built_in">arguments</span>);</div><div class="line"></div><div class="line"><span class="comment">// ç°åœ¨æœ‰äº† `Array.from` æˆ‘ä»¬å°±å¯ä»¥è¿™æ ·ï¼š</span></div><div class="line"><span class="keyword">var</span> imgs = <span class="built_in">Array</span>.from(<span class="built_in">document</span>.querySelectorAll(<span class="string">'img'</span>));</div><div class="line"><span class="keyword">var</span> args = <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>);</div></pre></td></tr></table></figure></p>
</blockquote>
<h3 id="å…³äº-charCodeAt-å’Œ-codePointAt"><a href="#å…³äº-charCodeAt-å’Œ-codePointAt" class="headerlink" title="å…³äº charCodeAt å’Œ codePointAt"></a>å…³äº <code>charCodeAt</code> å’Œ <code>codePointAt</code></h3><blockquote>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charCodeAt" target="_blank" rel="external">Mozilla</a>æ–‡æ¡£è¯´æ˜ï¼š The <strong>charCodeAt()</strong> method returns an integer between 0 and 65535 representing the UTF-16 code unit at the given index (the UTF-16 code unit matches the Unicode code point for code points representable in a single UTF-16 code unit, but might also be the first code unit of a surrogate pair for code points not representable in a single UTF-16 code unit, e.g. Unicode code points &gt; 0x10000). If you want the entire code point value, use <strong>codePointAt()</strong>.</p>
</blockquote>
<p>ç†è§£ä¸€ä¸‹ï¼šUTF-16 ç¼–ç æ–¹å¼å¯¹äº BMP å­—ç¬¦ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚å°±å¯ä»¥è¡¨ç¤ºï¼Œè¿™ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ª <code>code unit</code>ï¼›å¯¹äºé BMP å­—ç¬¦ï¼Œåˆ™éœ€è¦ 4 ä¸ªå­—èŠ‚ç»„æˆçš„ä»£ç†å¯¹æ¥è¡¨ç¤ºï¼Œè¿™å››ä¸ªå­—èŠ‚åˆ™è¡¨ç¤ºä¸¤ä¸ª <code>code unit</code>ã€‚æ‰€ä»¥ä¸€ä¸ªç ä½ (code point) ç”±ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ª <code>code unit</code> ç»„æˆ</p>
<ul>
<li><p><code>charCodeAt</code> æ–¹æ³•æ¥æ”¶ä¸€ä¸ª <code>index</code> å‚æ•°ï¼Œè¿”å›æŒ‡å®šä½ç½®ä¸Šçš„ <code>code unit</code> çš„æ•´æ•°å€¼ï¼ŒèŒƒå›´æ˜¯ 0 åˆ° 65535ã€‚</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="keyword">char</span> = 'a'; <span class="comment">// BMP å­—ç¬¦</span></div><div class="line"><span class="keyword">char</span>.charCodeAt(0).<span class="keyword">toString</span>(16); <span class="comment">// 61</span></div><div class="line"><span class="keyword">char</span>.charCodeAt(1).<span class="keyword">toString</span>(16); <span class="comment">// NaN</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> <span class="keyword">char</span> = 'ğŸ’©'; <span class="comment">// éBMP å­—ç¬¦</span></div><div class="line"><span class="keyword">char</span>.charCodeAt(0).<span class="keyword">toString</span>(16); <span class="comment">// d83d</span></div><div class="line"><span class="keyword">char</span>.charCodeAt(1).<span class="keyword">toString</span>(16); <span class="comment">// dca9</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>codePointAt</code> æ–¹æ³•åŒæ ·æ¥æ”¶ä¸€ä¸ª <code>index</code> å‚æ•°ï¼Œè¿”å›ä»æŒ‡å®šä½ç½®å¼€å§‹ï¼Œæ•´ä¸ªç ä½(code point)çš„å€¼ã€‚</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="keyword">char</span> = 'a'; <span class="comment">// BMP å­—ç¬¦</span></div><div class="line"><span class="keyword">char</span>.codePointAt(0).<span class="keyword">toString</span>(16); <span class="comment">// 61</span></div><div class="line"><span class="keyword">char</span>.codePointAt(1).<span class="keyword">toString</span>(16); <span class="comment">// NaN</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> <span class="keyword">char</span> = 'ğŸ’©'; <span class="comment">// éBMP å­—ç¬¦</span></div><div class="line"><span class="keyword">char</span>.codePointAt(0).<span class="keyword">toString</span>(16); <span class="comment">// 1f4a9</span></div><div class="line"><span class="keyword">char</span>.codePointAt(1).<span class="keyword">toString</span>(16); <span class="comment">// dca9</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>é€šè¿‡ä¸Šè¿°çš„ä»£ç ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼š<br>å¯¹äº BMP å­—ç¬¦ï¼Œ<code>charCodeAt</code> å’Œ <code>codePointAt</code> çš„è¡Œä¸ºä¸€è‡´ï¼Œéƒ½æ˜¯è¿”å›æ•´ä¸ªå­—ç¬¦çš„ç ä½ (code point)ï¼›<br>å¯¹äºé BMP å­—ç¬¦ï¼Œ<code>charCodeAt</code> é€šè¿‡æŒ‡å®šå‚æ•°ï¼Œè¿”å›ä¸åŒä½ç½®ä¸Šçš„ <code>code unit</code> å€¼ï¼›è€Œ <code>codePointAt</code> å½“å‚æ•°ä¸º 0 æ—¶ï¼Œè¿”å›æ•´ä¸ªå­—ç¬¦çš„ç ä½ (code point)ï¼Œå½“å‚æ•°ä¸º 1 æ—¶ï¼Œè¿”å›çš„æ˜¯ä½ä½ä»£ç† <code>code unit</code> çš„å€¼ã€‚</p>
<p>é€šè¿‡ <code>codePointAt</code> æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸¤ä¸ªå­—èŠ‚(16ä½)è¡¨ç¤ºï¼Œè¿˜æ˜¯å››ä¸ªå­—èŠ‚(32ä½)è¡¨ç¤ºï¼š<br><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> <span class="keyword">is</span><span class="number">32</span>Bit(c) &#123;</div><div class="line">    <span class="keyword">return</span> c.codePointAt(<span class="number">0</span>) &gt; <span class="number">0</span>xFFFF;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">is</span><span class="number">32</span>Bit(<span class="string">'A'</span>) <span class="comment">// false</span></div><div class="line"><span class="keyword">is</span><span class="number">32</span>Bit(<span class="string">'ğŸ’©'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<h3 id="ç ä½å’Œå­—ç¬¦è½¬æ¢"><a href="#ç ä½å’Œå­—ç¬¦è½¬æ¢" class="headerlink" title="ç ä½å’Œå­—ç¬¦è½¬æ¢"></a>ç ä½å’Œå­—ç¬¦è½¬æ¢</h3><p><code>charCodeAt</code> æ–¹æ³•å¯ä»¥è·å– BMP å­—ç¬¦çš„ç ä½ï¼›<code>codePointAt</code> æ–¹æ³•å¯ä»¥è·å– BMP å’Œé BMP å­—ç¬¦çš„ç ä½ã€‚åä¹‹ï¼Œå¦‚ä½•å°†ä¸€ä¸ªç ä½è½¬æ¢æˆå­—ç¬¦å‘¢ï¼Ÿ</p>
<p><code>charCodeAt</code> å’Œ <code>codePointAt</code> å¯¹åº”ç€çš„æœ‰ <code>fromCharCode</code> å’Œ <code>fromCodePoint</code> è¿™ä¸¤ä¸ªæ–¹æ³•ï¼ŒåŒæ ·çš„ï¼Œ<code>fromCharCode</code> åªèƒ½è®²ä¸€ä¸ª BMP å­—ç¬¦çš„ç ä½è½¬æ¢å›å­—ç¬¦ï¼Œå¯¹äºé BMP å­—ç¬¦çš„ç ä½å°±æ— èƒ½ä¸ºåŠ›äº†ï¼Œå¾—ä½¿ç”¨ <code>fromCodePoint</code> æ–¹æ³•ã€‚</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> c = <span class="string">'a'</span>;</div><div class="line"><span class="keyword">var</span> d = <span class="string">'ğŸ’©'</span>;</div><div class="line"><span class="built_in">String</span>.fromCharCode(c.charCodeAt(<span class="number">0</span>)) <span class="comment">// a</span></div><div class="line"><span class="built_in">String</span>.fromCharCode(d.charCodeAt(<span class="number">0</span>)) <span class="comment">// ï¿½</span></div><div class="line"><span class="built_in">String</span>.fromCodePoint(d.codePointAt(<span class="number">0</span>)) <span class="comment">// ğŸ’©</span></div></pre></td></tr></table></figure>
<p>åœ¨ ES5 ä¸­å…è®¸é€šè¿‡ <code>\u</code> åŠ ä¸Šç ä½ç»„æˆçš„ç¼–ç åºåˆ—æ¥è¡¨ç¤º 16 ä½çš„ Unicode BMP å­—ç¬¦ï¼Œå³ï¼š<code>\uXXXX</code>ã€‚ä¾‹å¦‚ï¼š<code>\u0061</code> è¡¨ç¤ºå­—ç¬¦ <code>a</code><br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.<span class="built_in">log</span>('\u<span class="number">0061</span>') <span class="comment">// a</span></div></pre></td></tr></table></figure></p>
<p>å½“ç„¶è¿™åªæ˜¯å¯¹äº BMP å­—ç¬¦æœ‰æ•ˆï¼Œå¯¹äºé BMP å­—ç¬¦ï¼Œç ä½èŒƒå›´å¤§äº <code>OxFFFF</code> æ—¶ï¼Œè¿™ç§è¡¨ç¤ºæ–¹å¼å°±æœ‰é—®é¢˜äº†ï¼Œä¾‹å¦‚<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.<span class="built_in">log</span>('\u1f4a9') <span class="comment">// á½Š9</span></div></pre></td></tr></table></figure></p>
<p><code>1f4a9</code> æ˜¯ emoji ğŸ’© çš„ç ä½ï¼Œå› ä¸º Unicode çš„ç¼–ç åºåˆ—æ€»æ˜¯åŒ…å« 16 ä½ï¼Œæ‰€ä»¥ JS ä¼šæŠŠ <code>\u1f4a9</code> åˆ†æˆä¸¤ä¸ªå­—ç¬¦ <code>\u1f4a</code> å’Œ <code>9</code>ï¼Œæ‰€ä»¥æœ€ç»ˆè¾“å‡ºï¼š<code>á½Š9</code> ä¸¤ä¸ªå­—ç¬¦ã€‚</p>
<p>ES6 é€šè¿‡æ‰©å±• Unicode çš„ç¼–ç åºåˆ—è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå°†ç ä½ç½®äºèŠ±æ‹¬å·å†…ï¼Œå³ï¼š<code>\u{XXXXX}</code>ï¼Œå¯è¡¨ç¤ºä»»ä½•å­—ç¬¦çš„ç ä½ã€‚<br><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">console.<span class="built_in">log</span>('\u&#123;<span class="number">0061</span>&#125;') <span class="comment">// a</span></div><div class="line">console.<span class="built_in">log</span>('\u&#123;1f4a9&#125;') <span class="comment">// ğŸ’©</span></div></pre></td></tr></table></figure></p>
<h3 id="æ­£åˆ™åŒ¹é…-u-ä¿®é¥°ç¬¦"><a href="#æ­£åˆ™åŒ¹é…-u-ä¿®é¥°ç¬¦" class="headerlink" title="æ­£åˆ™åŒ¹é… u ä¿®é¥°ç¬¦"></a>æ­£åˆ™åŒ¹é… <code>u</code> ä¿®é¥°ç¬¦</h3><p>æ­£åˆ™è¡¨è¾¾å¼ä¹Ÿæ˜¯åŸºäºä¸¤ä¸ªå­—èŠ‚(16ä½)ï¼Œä¸€ä¸ª code unit æ¥è¡¨ç¤ºå•ä¸ªå­—ç¬¦çš„ï¼Œé‚£ä¹ˆå¯¹äºé BMP å­—ç¬¦ï¼Œä¾‹å¦‚ï¼šemoji ğŸ’© å°±ä¼šè¢«è®¤ä¸ºæ˜¯ä¸¤ä¸ªå­—ç¬¦ï¼Œåœ¨æ­£åˆ™åŒ¹é…ä¸­å°±ä¼šé‡åˆ°é—®é¢˜ã€‚ä¾‹å¦‚ï¼š<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="keyword">char</span> = 'ğŸ’©';</div><div class="line">console.<span class="built_in">log</span>(<span class="keyword">char</span>.length) <span class="comment">// 2</span></div><div class="line">console.<span class="built_in">log</span>(/^.$/.<span class="keyword">test</span>(<span class="keyword">char</span>)); <span class="comment">// false</span></div></pre></td></tr></table></figure></p>
<p>åœ¨æ­£åˆ™ä¸­ï¼Œ<code>.</code> å°æ•°ç‚¹ï¼Œæ˜¯ç”¨äºåŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯å¯¹äºé BMP å­—ç¬¦ ğŸ’© JS æŠŠå®ƒè®¤ä¸ºæ˜¯ä¸¤ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥åŒ¹é…å¤±è´¥ã€‚<br>ES6 ä¸ºæ­£åˆ™è¡¨è¾¾å¼å®šä¹‰äº†ä¸€ä¸ªæ–°çš„ä¿®é¥°ç¬¦ï¼Œ<code>u</code> ä¹Ÿå³ Unicodeã€‚å½“ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼è®¾ç½®äº† <code>u</code> ä¿®é¥°ç¬¦æ—¶ï¼Œå®ƒå°†åˆ‡æ¢æ¨¡å¼ä¸ºå·¥ä½œåœ¨å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ code unitã€‚è¿™æ„å‘³ç€æ­£åˆ™è¡¨è¾¾å¼åœ¨åŒ…å«é BMP å­—ç¬¦çš„å­—ç¬¦ä¸²ä¸­ä¸ä¼šè¿·æƒ‘ã€‚<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">console.<span class="built_in">log</span>(/^.$/<span class="keyword">u</span>.<span class="keyword">test</span>(<span class="keyword">char</span>)); <span class="comment">// true</span></div></pre></td></tr></table></figure></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://cookfront.github.io/2015/06/04/es6-string/" target="_blank" rel="external">æ¯å¤©å­¦ç‚¹ES6ï¼å­—ç¬¦ä¸²</a><br><a href="http://www.alloyteam.com/2016/12/javascript-has-a-unicode-sinkhole/" target="_blank" rel="external">Javascriptæœ‰ä¸ªUnicodeçš„å¤©å‘</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/IMG_1915.PNG&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="Unicode" scheme="http://objcer.com/categories/Unicode/"/>
    
    
      <category term="BMP" scheme="http://objcer.com/tags/BMP/"/>
    
      <category term="charCodeAt" scheme="http://objcer.com/tags/charCodeAt/"/>
    
      <category term="codePointAt" scheme="http://objcer.com/tags/codePointAt/"/>
    
  </entry>
  
  <entry>
    <title>å…³äº ES6 Promise</title>
    <link href="http://objcer.com/2017/05/07/About-Promise/"/>
    <id>http://objcer.com/2017/05/07/About-Promise/</id>
    <published>2017-05-07T10:03:15.000Z</published>
    <updated>2017-06-27T07:25:07.000Z</updated>
    
    <content type="html"><![CDATA[<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/do-you-promise.png" alt=""></p>
<a id="more"></a>
<h2 id="ä¸²è¡Œ-Promise"><a href="#ä¸²è¡Œ-Promise" class="headerlink" title="ä¸²è¡Œ Promise"></a>ä¸²è¡Œ Promise</h2><p>Promise æœ‰ä¸€ä¸ª <code>Promise.all</code> æ–¹æ³•ï¼Œæ¥æ”¶ä¸€ä¸ª Promise å¯¹è±¡æ•°ç»„ä½œå‚æ•°ï¼Œ<strong>å¹¶è¡Œ</strong>æ‰§è¡Œå…¶ä¸­çš„ Promise å¯¹è±¡ï¼Œå½“è¿™ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰ Promise å¯¹è±¡éƒ½ <code>resolve</code> æˆ–è€…æŸä¸€ä¸ª Promise å¯¹è±¡ <code>reject</code> æ—¶ï¼Œè°ƒç”¨ <code>then</code> æ–¹æ³•ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœéœ€è¦è¿›è¡Œåœ¨ A å¤„ç†å®Œæˆä¹‹åï¼Œå†å¼€å§‹ B çš„å¤„ç†ï¼Œå¯¹äºè¿™ç§ä¸²è¡Œé¡ºåºå¤„ç†ï¼ŒPromise å¹¶æ²¡æœ‰æä¾›æ”¯æŒã€‚é‚£æˆ‘ä»¬åªèƒ½è‡ªå·±è§£å†³ã€‚</p>
<h3 id="é‡å¤ä½¿ç”¨å¤šä¸ª-then-å®ç°"><a href="#é‡å¤ä½¿ç”¨å¤šä¸ª-then-å®ç°" class="headerlink" title="é‡å¤ä½¿ç”¨å¤šä¸ª then å®ç°"></a>é‡å¤ä½¿ç”¨å¤šä¸ª <code>then</code> å®ç°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPromise</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">'promise: '</span>, name);</div><div class="line">            resolve();</div><div class="line">        &#125;, <span class="number">2000</span>);</div><div class="line">    &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line">getPromise(<span class="string">'one'</span>).then(getPromise.bind(<span class="literal">undefined</span>, <span class="string">'two'</span>));</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šé€šè¿‡ <code>new</code> å®ä¾‹åŒ–ä¸€ä¸ª Promise çš„æ—¶å€™ï¼Œpromise å·²ç»å¼€å§‹æ‰§è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬éƒ½æ˜¯é€šè¿‡ä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡</p>
<p>é€šè¿‡ä½¿ç”¨ <code>then</code> å°†ä¸¤ä¸ª Promise ä¸²è”èµ·æ¥ï¼Œä½¿å…¶é¡ºåºæ‰§è¡Œï¼Œä½†æ˜¯éšç€ä¸²è¡Œå¤„ç†çš„ Promise å¢å¤šï¼Œéœ€è¦ä¸æ–­å¢åŠ  <code>then</code> æ–¹æ³•çš„è°ƒç”¨ï¼Œåœ¨å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­å¹¶ä¸æ–¹ä¾¿ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>for</code> å¾ªç¯è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="é€šè¿‡-for-å¾ªç¯å®ç°"><a href="#é€šè¿‡-for-å¾ªç¯å®ç°" class="headerlink" title="é€šè¿‡ for å¾ªç¯å®ç°"></a>é€šè¿‡ <code>for</code> å¾ªç¯å®ç°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ps = [</div><div class="line">    getPromise.bind(<span class="literal">undefined</span>, <span class="string">'one'</span>),</div><div class="line">    getPromise.bind(<span class="literal">undefined</span>, <span class="string">'two'</span>)</div><div class="line">]</div><div class="line"><span class="keyword">var</span> promise = <span class="built_in">Promise</span>.resolve();</div><div class="line">ps.forEach(<span class="function">(<span class="params">p</span>) =&gt;</span> &#123;</div><div class="line">    promise = promise.then(p);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šæ•°ç»„ä¸­çš„å…ƒç´ éƒ½æ˜¯è¿”å› Promise å¯¹è±¡çš„å‡½æ•°</p>
<p>è¿™ç§å¤„ç†æ–¹å¼éœ€è¦ä¸€ä¸ªä¸­é—´å˜é‡ <code>promise</code>ï¼Œé€šè¿‡ä¸æ–­è¦†ç›– <code>promise</code> å˜é‡çš„å€¼ï¼Œè¾¾åˆ° <code>promise1.then(promise2)</code> çš„ç´¯ç§¯æ•ˆæœã€‚ä½†æ˜¯ç”±äºå¤šä½¿ç”¨äº†ä¸€ä¸ªä¸­é—´å˜é‡ï¼Œä»£ç æ˜¾å¾—ä¸å¤Ÿç®€æ´ã€‚</p>
<h3 id="é€šè¿‡-Array-prototype-reduce-å®ç°"><a href="#é€šè¿‡-Array-prototype-reduce-å®ç°" class="headerlink" title="é€šè¿‡ Array.prototype.reduce å®ç°"></a>é€šè¿‡ <code>Array.prototype.reduce</code> å®ç°</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">var ps = [</div><div class="line">    getPromise.bind(<span class="literal">undefined</span>, <span class="string">'one'</span>),</div><div class="line">    getPromise.bind(<span class="literal">undefined</span>, <span class="string">'two'</span>)</div><div class="line">]</div><div class="line">ps.reduce(<span class="function"><span class="params">(promise, p)</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> promise.<span class="keyword">then</span>(p);</div><div class="line">&#125;, Promise.resolve())</div></pre></td></tr></table></figure>
<p>è¿™ç§å®ç°ä¸²è¡Œ Promise å°±æ˜¾å¾—å¾ˆç®€æ´äº†å§ï¼Œåœ¨å®é™…å¼€å‘åº”ç”¨ä¸­å¤§å¤šä¹Ÿç”¨æ­¤æ–¹å¼ ğŸ‘Š</p>
<blockquote>
<p>å…³äº reduce ç”¨æ³•ï¼Œå‚è€ƒ <a href="http://objcer.com/2017/03/11/implement-the-array-map-reduce-filter-find-method/#more">å®ç° map, reduce, filter, find æ–¹æ³•</a></p>
</blockquote>
<h3 id="å®šä¹‰ä¸²è¡Œ-Promise-å‡½æ•°"><a href="#å®šä¹‰ä¸²è¡Œ-Promise-å‡½æ•°" class="headerlink" title="å®šä¹‰ä¸²è¡Œ Promise å‡½æ•°"></a>å®šä¹‰ä¸²è¡Œ Promise å‡½æ•°</h3><p>åœ¨åº”ç”¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œè®¸å¤šéœ€è¦ Promise ä¸²è¡Œæ‰§è¡Œï¼Œä¾‹å¦‚å¤šä¸ªç½‘ç»œè¯·æ±‚ä¸²è¡Œæ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿›è¡Œï¼Œè¯¥æ–¹æ³•æ¥æ”¶ä¸€ä¸ªæ¥æ”¶ä¸€ä¸ªå‡½æ•°æ•°ç»„ï¼Œæ•°ç»„ä¸­çš„å‡½æ•°å…ƒç´ éƒ½è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¹¶å°†æ¯ä¸€ä¸ª Promise å¯¹è±¡ <code>resolve</code> çš„æ‰§è¡Œç»“æœå­˜å‚¨åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç­‰æ‰€æœ‰çš„ Promise å¯¹è±¡ <code>resolve</code> ä¹‹åï¼Œå°†ç»“æœæ•°ç»„è¿”å›ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> sequencePromise(tasks) &#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_recordResults</span>(<span class="params">resultArray, result</span>) </span>&#123;</div><div class="line">        resultArray.push(result);</div><div class="line">        <span class="keyword">return</span> resultArray;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> pushResult = _recordResults.bind(<span class="literal">null</span>, []);</div><div class="line">    <span class="keyword">return</span> tasks.reduce(<span class="function">(<span class="params">promise, task</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> promise.then(task).then(pushResult);</div><div class="line">    &#125;, <span class="built_in">Promise</span>.resolve())</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="å¹¶è¡Œ-Promise"><a href="#å¹¶è¡Œ-Promise" class="headerlink" title="å¹¶è¡Œ Promise"></a>å¹¶è¡Œ Promise</h2><h3 id="å…³äº-Promise-all-å’Œ-Promise-race"><a href="#å…³äº-Promise-all-å’Œ-Promise-race" class="headerlink" title="å…³äº Promise.all å’Œ Promise.race"></a>å…³äº <code>Promise.all</code> å’Œ <code>Promise.race</code></h3><p>Promise çš„è¿™ä¸¤ä¸ªé™æ€æ–¹æ³•ï¼Œéƒ½æ¥æ”¶ä¸€ä¸ª iterable å¯è¿­ä»£å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼šPromise Arrayï¼‰ä½œä¸ºå‚æ•°ï¼Œ<strong>å¹¶è¡Œ</strong>æ‰§è¡Œå…¶ä¸­çš„ Promise å®ä¾‹ï¼Œç»“æœè¿”å›ä¸€ä¸ª Promiseï¼›äºŒè€…çš„åŒºåˆ«æ˜¯ï¼š</p>
<ul>
<li><code>Promise.all</code>: å¯è¿­ä»£å¯¹è±¡ä¸­çš„æ‰€æœ‰ Promise éƒ½ resolve ä¹‹å resolveï¼›æˆ–è€…åœ¨ä»»ä¸€ Promise è¢« reject å reject</li>
<li><code>Promise.race</code>: å¯è¿­ä»£å¯¹è±¡ä¸­çš„ç¬¬ä¸€ä¸ª Promise è¢« resolve æˆ–è€… reject åï¼Œè¿›è¡Œ resolve æˆ–è€… reject</li>
</ul>
<p>çœ‹å¦‚ä¸‹çš„ä¾‹å­ï¼š<br>æœ‰å¦‚ä¸‹ä¸‰ä¸ª Promise å®ä¾‹<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var p1 = <span class="keyword">new</span> Promise(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(<span class="string">'p1'</span>), <span class="number">2000</span>)</div><div class="line">&#125;);</div><div class="line">var p2 = <span class="keyword">new</span> Promise(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> reject(<span class="string">'p2'</span>), <span class="number">1000</span>)</div><div class="line">&#125;);</div><div class="line">var p3 = <span class="keyword">new</span> Promise(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(<span class="string">'p3'</span>), <span class="number">500</span>)</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>â‘  <code>Promise.all</code>ï¼šæ‰€æœ‰ Promise éƒ½ resolve ä¹‹å resolve<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Promise.all([p1, p3]).<span class="keyword">then</span>(<span class="function"><span class="params">(value)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'--resolve--: '</span>, value)</div><div class="line">&#125;).<span class="keyword">catch</span>(<span class="function"><span class="params">(err)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'--reject--: '</span>, err)</div><div class="line">&#125;)</div><div class="line"><span class="regexp">//</span> è¾“å‡ºï¼š--resolve--:  [<span class="string">"p1"</span>, <span class="string">"p3"</span>]</div></pre></td></tr></table></figure></p>
<p>â‘¡ <code>Promise.all</code>ï¼šä»»ä¸€ Promise è¢« reject å reject<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Promise.all([p1, p2, p3]).<span class="keyword">then</span>(<span class="function"><span class="params">(value)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'--resolve--: '</span>, value)</div><div class="line">&#125;).<span class="keyword">catch</span>(<span class="function"><span class="params">(err)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'--reject--: '</span>, err)</div><div class="line">&#125;)</div><div class="line"><span class="regexp">//</span> è¾“å‡ºï¼š--reject--:  p2</div></pre></td></tr></table></figure></p>
<p>â‘  <code>Promise.race</code>ï¼šç¬¬ä¸€ä¸ª Promise è¢« resolve æˆ–è€… reject åï¼Œè¿›è¡Œ resolve æˆ–è€… reject<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Promise.race([p1, p2, p3]).<span class="keyword">then</span>(<span class="function"><span class="params">(value)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'--resolve--: '</span>, value)</div><div class="line">&#125;).<span class="keyword">catch</span>(<span class="function"><span class="params">(err)</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'--reject--: '</span>, err)</div><div class="line">&#125;)</div><div class="line"><span class="regexp">//</span> è¾“å‡ºï¼šè¾“å‡ºï¼š--reject--:  p3</div></pre></td></tr></table></figure></p>
<h3 id="å¹¶è¡Œ-Promise-1"><a href="#å¹¶è¡Œ-Promise-1" class="headerlink" title="å¹¶è¡Œ Promise"></a>å¹¶è¡Œ Promise</h3><p>å¯¹äºï¼š<em>å¹¶è¡Œæ‰§è¡Œ Promises ç­‰å¾…æ‰€æœ‰çš„ Promise éƒ½å®Œæˆæ‰§è¡Œï¼ˆä¸ç®¡æ˜¯ resolve è¿˜æ˜¯ rejectï¼‰æ‰ç»“æŸã€‚</em>è¿™ç§æƒ…å½¢ä½¿ç”¨ <code>Promise.all</code> å¹¶ä¸èƒ½æ»¡è¶³ï¼Œå› ä¸º <code>Promise.all</code> åœ¨ä»»ä¸€ Promise è¢« reject å rejectï¼Œè¿™ç§æƒ…å½¢éœ€è¦å¯¹ Promise è¿›è¡Œä¸€äº›å¤„ç†åï¼Œå†ä½¿ç”¨ <code>Promise.all</code></p>
<blockquote>
<p>å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/31424561/wait-until-all-es6-promises-complete-even-rejected-promises?answertab=votes#tab-top" target="_blank" rel="external">Wait until all ES6 promises complete, even rejected promises</a></p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">parallelPromise</span>(<span class="params">tasks</span>) </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">reflect</span>(<span class="params">promise</span>) </span>&#123;</div><div class="line">         <span class="keyword">return</span> promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>)</span>&#123; <span class="keyword">return</span> &#123;<span class="attr">v</span>:v, <span class="attr">status</span>: <span class="string">"resolved"</span> &#125;&#125;,</div><div class="line">                            <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123; <span class="keyword">return</span> &#123;<span class="attr">e</span>:e, <span class="attr">status</span>: <span class="string">"rejected"</span> &#125;&#125;);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.all(tasks.map(reflect));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(<span class="string">'p1'</span>), <span class="number">2000</span>)</div><div class="line">&#125;);</div><div class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> reject(<span class="string">'p2'</span>), <span class="number">1000</span>)</div><div class="line">&#125;);</div><div class="line"><span class="keyword">var</span> p3 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(<span class="string">'p3'</span>), <span class="number">500</span>)</div><div class="line">&#125;);</div><div class="line"></div><div class="line">parallelPromise([p1, p2, p3]).then(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">var</span> success = results.filter(<span class="function"><span class="params">x</span> =&gt;</span> x.status === <span class="string">"resolved"</span>);</div><div class="line">    <span class="keyword">var</span> fail = results.filter(<span class="function"><span class="params">x</span> =&gt;</span> x.status === <span class="string">"rejected"</span>);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'--success--: '</span>, <span class="built_in">JSON</span>.stringify(success));</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'--fail--: '</span>, <span class="built_in">JSON</span>.stringify(fail));</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œç»“æœï¼š<br><figure class="highlight haml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">-<span class="ruby">-success--:  [&#123;<span class="string">"v"</span><span class="symbol">:<span class="string">"p1"</span></span>,<span class="string">"status"</span><span class="symbol">:<span class="string">"resolved"</span></span>&#125;,&#123;<span class="string">"v"</span><span class="symbol">:<span class="string">"p3"</span></span>,<span class="string">"status"</span><span class="symbol">:<span class="string">"resolved"</span></span>&#125;]</span></div><div class="line">-<span class="ruby">-fail--:  [&#123;<span class="string">"e"</span><span class="symbol">:<span class="string">"p2"</span></span>,<span class="string">"status"</span><span class="symbol">:<span class="string">"rejected"</span></span>&#125;]</span></div></pre></td></tr></table></figure></p>
<h2 id="å¯å–æ¶ˆçš„-Promise"><a href="#å¯å–æ¶ˆçš„-Promise" class="headerlink" title="å¯å–æ¶ˆçš„ Promise"></a>å¯å–æ¶ˆçš„ Promise</h2><p>Promise å¹¶æ²¡æœ‰æä¾› <code>cancel</code> çš„æ¥å£ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œå°è£…å®ç° Promise å¯å–æ¶ˆ(cancelable).</p>
<blockquote>
<p>å‚è€ƒè‡ªï¼š<a href="https://facebook.github.io/react/blog/2015/12/16/ismounted-antipattern.html" target="_blank" rel="external">isMounted is an Antipattern</a></p>
</blockquote>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">const makeCancelable = <span class="function"><span class="params">(promise)</span> =&gt;</span> &#123;</div><div class="line">    let hasCanceled_ = <span class="literal">false</span>;</div><div class="line"></div><div class="line">    const wrappedPromise = <span class="keyword">new</span> Promise(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</div><div class="line">        promise.<span class="keyword">then</span>(<span class="function"><span class="params">(val)</span> =&gt;</span></div><div class="line">            hasCanceled_ ? reject(&#123;isCanceled: <span class="literal">true</span>&#125;) : resolve(val)</div><div class="line">        );</div><div class="line">        promise.<span class="keyword">catch</span>(<span class="function"><span class="params">(error)</span> =&gt;</span></div><div class="line">              hasCanceled_ ? reject(&#123;isCanceled: <span class="literal">true</span>&#125;) : reject(error)</div><div class="line">        );</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        promise: wrappedPromise,</div><div class="line">        cancel() &#123;</div><div class="line">          hasCanceled_ = <span class="literal">true</span>;</div><div class="line">        &#125;,</div><div class="line">    &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æµ‹è¯•ä¾‹å­ğŸŒ°ï¼š<br><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">var cancelablePromise = makeCancelable(<span class="keyword">new</span> Promise(<span class="function"><span class="params">(resolve, reject)</span> =&gt;</span> &#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        resolve(<span class="string">'ok'</span>);</div><div class="line">    &#125;, <span class="number">3000</span>)</div><div class="line">&#125;));</div><div class="line"></div><div class="line">cancelablePromise</div><div class="line">    .promise</div><div class="line">    .<span class="keyword">then</span>(<span class="function"><span class="params">(value)</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'---resolve---'</span>, value);</div><div class="line">    &#125;)</div><div class="line">    .<span class="keyword">catch</span>(<span class="function"><span class="params">(reason)</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'---cancel---'</span>, reason.isCanceled);</div><div class="line">    &#125;);</div><div class="line"></div><div class="line"><span class="regexp">//</span> cancelablePromise.cancel()</div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/do-you-promise.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="JS" scheme="http://objcer.com/categories/JS/"/>
    
    
      <category term="Promise" scheme="http://objcer.com/tags/Promise/"/>
    
  </entry>
  
  <entry>
    <title>å…³äº ES6 Module</title>
    <link href="http://objcer.com/2017/04/19/About-ES6-Module/"/>
    <id>http://objcer.com/2017/04/19/About-ES6-Module/</id>
    <published>2017-04-19T12:44:58.000Z</published>
    <updated>2017-05-02T13:20:01.000Z</updated>
    
    <content type="html"><![CDATA[<p><em>é—®é¢˜å¼•å…¥ï¼š</em>æœ€è¿‘åœ¨ Babel ç¼–è¯‘æ—¶é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹ ES6 Module ç¼–è¯‘çš„é—®é¢˜ï¼Œæœ¬æ–‡å°†å¯¹è§£å†³è¯¥é—®é¢˜è¿‡ç¨‹ä¸­å…³äº ES6 Module æœ‰å…³å†…å®¹è¿›è¡Œè®°å½•å’Œä»‹ç»ã€‚</p>
<a id="more"></a>
<h2 id="å…³äºï¼šCommonJS-AMD-CMD-UMD"><a href="#å…³äºï¼šCommonJS-AMD-CMD-UMD" class="headerlink" title="å…³äºï¼šCommonJS, AMD, CMD, UMD"></a>å…³äºï¼šCommonJS, AMD, CMD, UMD</h2><ul>
<li>CommonJS: ç”¨äºæœåŠ¡ç«¯ï¼Œæ¨¡å—åŒæ­¥åŠ è½½ï¼Œnode.js çš„æ¨¡å—ç³»ç»Ÿå°±æ˜¯åŸºäº CommonJS è§„èŒƒçš„å®ç°</li>
<li>AMD (Asynchronous Module Definition): ç”¨äºæµè§ˆå™¨ç«¯ï¼Œæ¨¡å—å¼‚æ­¥åŠ è½½ï¼Œç›®å‰ï¼Œæµè¡Œçš„ require.js åº“å°±å®ç°äº† AMD è§„èŒƒ</li>
<li>CMD (Common Module Definition): æ˜¯ SeaJS åœ¨æ¨å¹¿è¿‡ç¨‹ä¸­å¯¹æ¨¡å—å®šä¹‰çš„è§„èŒƒåŒ–ï¼Œå’Œ AMD æœ‰äº›ç±»ä¼¼ï¼Œå‚è€ƒï¼š<a href="https://github.com/seajs/seajs/issues/277" target="_blank" rel="external">ä¸ RequireJS çš„å¼‚åŒ</a></li>
<li>UMD (Universal Module Definition): å…¼å®¹äº† AMD å’Œ CommonJSï¼ŒåŒæ—¶è¿˜æ”¯æŒè€å¼çš„â€œå…¨å±€â€å˜é‡è§„èŒƒï¼Œä½¿å¾—æ¨¡å—åŒ–ä»£ç å¯ä»¥åœ¨å‰ç«¯æµè§ˆå™¨å’Œåå°æœåŠ¡ç«¯ä¸­è¿è¡Œ</li>
</ul>
<h2 id="é—®é¢˜é˜è¿°åŠè§£å†³"><a href="#é—®é¢˜é˜è¿°åŠè§£å†³" class="headerlink" title="é—®é¢˜é˜è¿°åŠè§£å†³"></a>é—®é¢˜é˜è¿°åŠè§£å†³</h2><p>åœ¨ <code>test.js</code> æ–‡ä»¶ä¸­ï¼Œæœ‰å¦‚ä¸‹ä¸€è¡Œä»£ç ï¼š<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="builtin-name">export</span><span class="built_in"> default </span>23;</div></pre></td></tr></table></figure></p>
<p>åœ¨ <code>gulpfile.js</code> æ–‡ä»¶ä¸­ï¼Œæœ‰å¦‚ä¸‹ä»»åŠ¡å¯¹å…¶è¿›è¡Œç¼–è¯‘ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>)</div><div class="line"><span class="keyword">const</span> $ = <span class="built_in">require</span>(<span class="string">'gulp-load-plugins'</span>)();</div><div class="line"></div><div class="line">gulp.task(<span class="string">'babel'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'src/test.js'</span>])</div><div class="line">        .pipe($.babel(&#123;</div><div class="line">            <span class="attr">presets</span>: [<span class="string">'es2015'</span>]</div><div class="line">        &#125;))</div><div class="line">        .pipe(gulp.dest(<span class="string">'bin/'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œ <code>gulp babel</code> ç¼–è¯‘åï¼Œç»“æœä¸ºï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">"use strict"</span>;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.defineProperty(exports, <span class="string">"__esModule"</span>, &#123;</div><div class="line">  <span class="attr">value</span>: <span class="literal">true</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">exports.default = <span class="number">23</span>;</div></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šé‡åˆ°ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ<br>ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ <code>node.js</code> æ–‡ä»¶ä¸­æœ‰å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./test.js'</span>); <span class="comment">// &#123; default: 23 &#125;</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'---'</span>, a);</div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œ <code>node node.js</code> åï¼Œè¾“å‡ºçš„ç»“æœä¸ºï¼š<code>--- { default: 23 }</code><br>å¦‚æœæƒ³è¦ <code>a</code> å³ä¸º 23ï¼Œé‚£ä¹ˆéœ€è¦ï¼š<br><figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./test.js'</span>).<span class="keyword">default</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'---'</span>, a);</div></pre></td></tr></table></figure></p>
<p>æ˜¾ç„¶æ¯æ¬¡ <code>require</code> ä½¿ç”¨çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨æ·»åŠ  <code>default</code> æ¯”è¾ƒéº»çƒ¦ï¼Œè€Œä¸”ä»£ç ä¹Ÿä¸å¥½çœ‹ğŸ™ƒã€‚é‚£ä¹ˆæœ‰ä»€ä¹ˆæ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ä¹ˆï¼Ÿ</p>
<p><strong>ğŸ‘‡ä¸‹é¢æˆ‘ä»¬éœ€è¦å¯¹ <code>exports</code> å’Œ <code>module.exports</code> è¿›è¡Œäº†è§£</strong></p>
<p>åœ¨ Node.js modules ä¸­ï¼Œæˆ‘ä»¬å¯¹ <code>exports</code> éƒ½ä¸é™Œç”Ÿï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>exports</code> æš´éœ²ä»»ä½•åˆæ³•çš„ JavaScript å¯¹è±¡ï¼ŒåŒ…æ‹¬ï¼šboolean, number, date, JSON, string, function, array ç­‰ç­‰ã€‚<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">exports</span>.<span class="keyword">name</span> = <span class="function"><span class="keyword">function</span><span class="params">()</span> <span class="comment">&#123;</span></span></div><div class="line">    console.log('My name is XiaoDeng');</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>ç„¶ååœ¨å…¶ä»–æ–‡ä»¶ä¸­ä½¿ç”¨ï¼š<br><figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myName = require(<span class="string">'./test.js'</span>);</div><div class="line">myName.<span class="keyword">name</span>(); <span class="comment">// 'My name is XiaoDeng'</span></div></pre></td></tr></table></figure></p>
<p>é‚£ä¹ˆ <code>module.exports</code> åˆæ˜¯ä»€ä¹ˆå‘¢â“</p>
<blockquote>
<p>The <code>module.exports</code> object is created by the Module system.</p>
</blockquote>
<p>æ‰€ä»¥çœŸå®å­˜åœ¨ï¼Œä¸”æœ€ç»ˆè¿”å›ç»™è°ƒç”¨è€…çš„æ˜¯ <code>module.exports</code>ï¼›è€Œ <code>exports</code> åªæ˜¯ <code>module.exports</code> çš„ <strong>shortcut/alias</strong> è¾…åŠ©åˆ«åã€‚æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆç†è§£ï¼š<br><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="keyword">module</span> = <span class="keyword">new</span> <span class="keyword">Module</span>(...);</div><div class="line"><span class="keyword">var</span> exports = <span class="keyword">module</span>.exports;</div></pre></td></tr></table></figure></p>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/exports&amp;module.exports.png" alt=""><br><code>module.exports</code> åˆå§‹å€¼ä¸ºä¸€ä¸ªç©ºå¯¹è±¡ <code>{}</code>; <code>exports</code> æ˜¯æŒ‡å‘çš„å¯¹è±¡å’Œ <code>module.exports</code> æ‰§å‘çš„å¯¹è±¡ç›¸åŒã€‚</p>
<p><code>exports</code> çš„ä½œç”¨åœ¨äºæ”¶é›†å±æ€§å’Œæ–¹æ³•ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">exports.a = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"a"</span>);</div><div class="line">&#125;</div><div class="line">exports.b = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"b"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ­¤æ—¶ï¼Œ<code>exports</code> å’Œ <code>module.exports</code> éƒ½æ˜¯æŒ‡å‘åŒä¸€å¯¹è±¡ï¼š{ a: [Function], b: [Function] }ï¼›<br>ä½†æ˜¯å¦‚æœï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">exports = <span class="function"><span class="keyword">function</span> <span class="title">Something</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'bla bla'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æ­¤æ—¶ï¼Œ<code>exports</code> æ‰§å‘çš„å¯¹è±¡å’Œ  æŒ‡å‘çš„å¯¹è±¡å·²ç»ä¸åŒï¼Œæ­¤æ—¶ <code>exports</code> æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè€Œ <code>module.exports</code> å´ä¾ç„¶æ‰§å‘ä¸€ä¸ªç©ºå¯¹è±¡ <code>{}</code>ï¼ŒäºŒè€…çš„å¼•ç”¨ä¸åŒã€‚å¯ä»¥é€šè¿‡ <code>exports = module.exports</code> è®© <code>exports</code> é‡æ–°æŒ‡å‘ <code>module.exports</code> å³å¯ä¿æŒäºŒè€…å¼•ç”¨ç›¸åŒã€‚</p>
<blockquote>
<p>å¯¹ä¸Šè¿°é—®é¢˜çš„ç†è§£å°±æ¶‰åŠåˆ° <a href="http://objcer.com/2017/02/26/js-pass-by-value-or-by-reference/">JSä¸­æ˜¯ pass by value è¿˜æ˜¯ pass by reference</a></p>
</blockquote>
<p>é€šè¿‡ä»¥ä¸Šçš„åˆ†æï¼Œæˆ‘ä»¬æ¨èæ˜¯ä½¿ç”¨ <code>module.exports</code> è€Œé <code>exports</code>ã€‚ï¼ˆNode.jsæ–‡æ¡£ä¸­ä¹Ÿæ˜¯è¿™ä¹ˆæ¨èçš„ï¼‰</p>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ  <code>module.exports</code> æ¥è§£å†³ <code>require</code> æ—¶éœ€è¦æŒ‡å®š <code>default</code> çš„é—®é¢˜<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="built_in">Object</span>.defineProperty(exports, <span class="string">"__esModule"</span>, &#123;</div><div class="line">  <span class="attr">value</span>: <span class="literal">true</span></div><div class="line">&#125;);</div><div class="line">exports.default = <span class="string">'foo'</span>;</div><div class="line"><span class="built_in">module</span>.exports = exports[<span class="string">'default'</span>];</div></pre></td></tr></table></figure></p>
<p>å¦‚ä¸Šè¿™ä¸ªè¿‡ç¨‹å¯ä»¥é€šè¿‡ <strong>ğŸš€<a href="https://github.com/59naga/babel-plugin-add-module-exports" target="_blank" rel="external">babel-plugin-add-module-exports</a></strong> æ’ä»¶ï¼Œåœ¨ babel è¿‡ç¨‹ä¸­è‡ªåŠ¨å¤„ç†ã€‚</p>
<p>ç”±äºæµè§ˆå™¨ä¸­ç¼ºå°‘ <code>module</code> <code>exports</code> <code>require</code> <code>global</code> è¿™å››ä¸ª NodeJS ç¯å¢ƒå˜é‡ï¼Œæ‰€ä»¥ä¸å…¼å®¹ CommonJSï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæµè§ˆå™¨ä¸­å¹¶ä¸èƒ½ä½¿ç”¨ä¸Šè¿°çš„æ¨¡å—ï¼Œé‚£ä¹ˆä¸ºäº†è§£å†³å¦‚ä¸Šé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦å¦ä¸€ä¸ªæ’ä»¶ <strong>ğŸš€<a href="http://babeljs.io/docs/plugins/transform-es2015-modules-umd/" target="_blank" rel="external">ES2015 modules to UMD transform</a></strong>ï¼Œå°†æ¨¡å—ä»£ç ç¼–è¯‘æˆ UMD æ¨¡å¼ã€‚</p>
<p>ç»¼ä¸Šï¼šä¸‹è½½æ’ä»¶ï¼Œåœ¨ babel è¿‡ç¨‹ä¸­ä¼ å…¥ä¸¤ä¸ªæ’ä»¶åå³å¯<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¸‹è½½æ’ä»¶</span></div><div class="line">npm install --save-dev babel-plugin-add-<span class="built_in">module</span>-exports</div><div class="line">npm install --save-dev babel-plugin-transform-es2015-modules-umd</div><div class="line"></div><div class="line"><span class="comment">// gulpfile babel ä»»åŠ¡ä¸­æŒ‡å®šæ’ä»¶</span></div><div class="line">gulp.task(<span class="string">'babel'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> gulp.src([<span class="string">'src/test.js'</span>])</div><div class="line">        .pipe($.babel(&#123;</div><div class="line">            <span class="attr">presets</span>: [<span class="string">'es2015'</span>],</div><div class="line">            <span class="attr">plugins</span>: [</div><div class="line">                <span class="string">"add-module-exports"</span>, <span class="string">"transform-es2015-modules-umd"</span></div><div class="line">            ]</div><div class="line">        &#125;))</div><div class="line">        .pipe(gulp.dest(<span class="string">'bin/'</span>));</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>ç»è¿‡ç¼–è¯‘åï¼Œæœ€ç»ˆç”Ÿæˆçš„ä»£ç å¦‚ä¸‹ï¼š<br><figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">(<span class="name">function</span> (<span class="name">global</span>, factory) &#123;</div><div class="line">  if (<span class="name">typeof</span> define === <span class="string">"function"</span> &amp;&amp; define.amd) &#123;</div><div class="line">    define([<span class="string">"module"</span>, <span class="string">"exports"</span>], factory)<span class="comment">;</span></div><div class="line">  &#125; else if (<span class="name">typeof</span> exports !== <span class="string">"undefined"</span>) &#123;</div><div class="line">    factory(<span class="name">module</span>, exports)<span class="comment">;</span></div><div class="line">  &#125; else &#123;</div><div class="line">    var mod = &#123;</div><div class="line">      exports: &#123;&#125;</div><div class="line">    &#125;<span class="comment">;</span></div><div class="line">    factory(<span class="name"><span class="builtin-name">mod</span></span>, mod.exports)<span class="comment">;</span></div><div class="line">    global.test = mod.exports;</div><div class="line">  &#125;</div><div class="line">&#125;)(<span class="name">this</span>, function (<span class="name">module</span>, exports) &#123;</div><div class="line">  <span class="string">"use strict"</span><span class="comment">;</span></div><div class="line"></div><div class="line">  Object.defineProperty(<span class="name">exports</span>, <span class="string">"__esModule"</span>, &#123;</div><div class="line">    value: <span class="literal">true</span></div><div class="line">  &#125;)<span class="comment">;</span></div><div class="line">  exports.default = <span class="number">23</span><span class="comment">;</span></div><div class="line">  module.exports = exports[<span class="string">"default"</span>]<span class="comment">;</span></div><div class="line">&#125;)<span class="comment">;</span></div></pre></td></tr></table></figure></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://medium.com/@kentcdodds/misunderstanding-es6-modules-upgrading-babel-tears-and-a-solution-ad2d5ab93ce0" target="_blank" rel="external">Misunderstanding ES6 Modules, Upgrading Babel, Tears, and a Solution</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;em&gt;é—®é¢˜å¼•å…¥ï¼š&lt;/em&gt;æœ€è¿‘åœ¨ Babel ç¼–è¯‘æ—¶é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹ ES6 Module ç¼–è¯‘çš„é—®é¢˜ï¼Œæœ¬æ–‡å°†å¯¹è§£å†³è¯¥é—®é¢˜è¿‡ç¨‹ä¸­å…³äº ES6 Module æœ‰å…³å†…å®¹è¿›è¡Œè®°å½•å’Œä»‹ç»ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JS" scheme="http://objcer.com/categories/JS/"/>
    
    
      <category term="Module" scheme="http://objcer.com/tags/Module/"/>
    
      <category term="Babel" scheme="http://objcer.com/tags/Babel/"/>
    
      <category term="exports" scheme="http://objcer.com/tags/exports/"/>
    
      <category term="module.exports" scheme="http://objcer.com/tags/module-exports/"/>
    
  </entry>
  
  <entry>
    <title>è¯¦è§£ javascript this å…³é”®å­—</title>
    <link href="http://objcer.com/2017/03/26/javascript-this-keyword/"/>
    <id>http://objcer.com/2017/03/26/javascript-this-keyword/</id>
    <published>2017-03-26T09:02:09.000Z</published>
    <updated>2017-03-26T10:49:32.000Z</updated>
    
    <content type="html"><![CDATA[<p><code>this</code> æ˜¯ Javascript è¯­è¨€çš„ä¸€ä¸ªå…³é”®å­—ã€‚ å®ƒä»£è¡¨å‡½æ•°è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªå†…éƒ¨å¯¹è±¡ï¼Œåªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚è€Œè¿™ä¸ªå†…éƒ¨å¯¹è±¡ this æŒ‡å‘è°æœ‰æ—¶å´è®©æˆ‘ä»¬å¾ˆå›°æƒ‘ã€‚åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå‡½æ•°çš„è°ƒç”¨æ–¹å¼å†³å®šäº† this çš„å€¼ã€‚this ä¸èƒ½åœ¨æ‰§è¡ŒæœŸé—´è¢«èµ‹å€¼ï¼Œåœ¨æ¯æ¬¡å‡½æ•°è¢«è°ƒç”¨æ—¶ this çš„å€¼ä¹Ÿå¯èƒ½ä¼šä¸åŒã€‚</p>
<a id="more"></a>
<h2 id="this-æŒ‡å‘è°"><a href="#this-æŒ‡å‘è°" class="headerlink" title="this æŒ‡å‘è°"></a>this æŒ‡å‘è°</h2><h3 id="Function-Invocation-Pattern"><a href="#Function-Invocation-Pattern" class="headerlink" title="Function Invocation Pattern"></a>Function Invocation Pattern</h3><p>è¯¸å¦‚ <code>foo()</code> çš„è°ƒç”¨å½¢å¼è¢«ç§°ä¸º Function Invocation Patternï¼Œæ˜¯å‡½æ•°æœ€ç›´æ¥çš„ä½¿ç”¨å½¢å¼ï¼Œæ³¨æ„è¿™é‡Œçš„ foo æ˜¯ä½œä¸ºå•ç‹¬çš„å˜é‡å‡ºç°ï¼Œè€Œä¸æ˜¯å±æ€§ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œfoo å‡½æ•°ä½“ä¸­çš„ this æ°¸è¿œä¸º Global å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ä¸­å°±æ˜¯ window å¯¹è±¡ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¾‹å­1ï¼š</span></div><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a, <span class="keyword">this</span> === <span class="built_in">window</span>)</div><div class="line">&#125;</div><div class="line">foo() <span class="comment">// 1 true</span></div><div class="line"></div><div class="line"><span class="comment">// ä¾‹å­2ï¼š</span></div><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'foo: '</span>, <span class="keyword">this</span>.a, <span class="keyword">this</span> === <span class="built_in">window</span>)</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'bar: '</span>, <span class="keyword">this</span>.a, <span class="keyword">this</span> === <span class="built_in">window</span>)</div><div class="line">    &#125;</div><div class="line">    bar() <span class="comment">// bar:  1 true</span></div><div class="line">&#125;</div><div class="line">foo() <span class="comment">// foo:  1 true</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨ä¸¥æ ¼æ¨¡å¼(â€˜use strictâ€™)ä¸­çš„é»˜è®¤çš„ this ä¸å†æ˜¯ windowï¼Œè€Œæ˜¯ undefined.</p>
</blockquote>
<h3 id="Method-Invocation-Pattern"><a href="#Method-Invocation-Pattern" class="headerlink" title="Method Invocation Pattern"></a>Method Invocation Pattern</h3><p>è¯¸å¦‚ <code>foo.bar()</code> çš„è°ƒç”¨å½¢å¼è¢«ç§°ä¸º Method Invocation Patternï¼Œæ³¨æ„å…¶ç‰¹ç‚¹æ˜¯è¢«è°ƒç”¨çš„å‡½æ•°ä½œä¸ºä¸€ä¸ªå¯¹è±¡çš„å±æ€§å‡ºç°ï¼Œå¿…ç„¶ä¼šæœ‰â€œ.â€æˆ–è€…â€œ[]â€è¿™æ ·çš„å…³é”®ç¬¦å·ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œbar å‡½æ•°ä½“ä¸­çš„thisæ°¸è¿œä¸ºâ€œ.â€æˆ–â€œ[â€å‰çš„é‚£ä¸ªå¯¹è±¡ï¼Œå¦‚ä¸‹é¢ä¾‹ä¸­å°± <code>foo</code> å‡½æ•°ä¸­ <code>this</code> å°±æ˜¯æŒ‡å‘ <code>obj</code> å¯¹è±¡ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    <span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">foo</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.a, <span class="keyword">this</span> === obj) <span class="comment">// 1 true</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">obj.foo();</div></pre></td></tr></table></figure></p>
<h3 id="Constructor-Pattern"><a href="#Constructor-Pattern" class="headerlink" title="Constructor Pattern"></a>Constructor Pattern</h3><p><code>new foo()</code> è¿™ç§å½¢å¼çš„è°ƒç”¨è¢«ç§°ä¸º Constructor Patternï¼Œå…¶å…³é”®å­— <code>new</code> å°±å¾ˆèƒ½è¯´æ˜é—®é¢˜ï¼Œå½“ä¸€ä¸ªå‡½æ•°è¢«ä½œä¸ºä¸€ä¸ªæ„é€ å‡½æ•°æ¥ä½¿ç”¨ï¼ˆä½¿ç”¨newå…³é”®å­—ï¼‰ï¼Œå®ƒçš„ <code>this</code> ä¸å³å°†è¢«åˆ›å»ºçš„æ–°å¯¹è±¡ç»‘å®šã€‚å¦‚ä¸‹é¢ä¾‹å­ä¸­ï¼Œ<code>foo</code> å‡½æ•°å†…éƒ¨çš„ <code>this</code> æ°¸è¿œæ˜¯ <code>new foo()</code> è¿”å›çš„å¯¹è±¡ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.a = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> f = <span class="keyword">new</span> foo();</div><div class="line"><span class="built_in">console</span>.log(f.a) <span class="comment">// 1</span></div></pre></td></tr></table></figure></p>
<h3 id="Apply-Pattern"><a href="#Apply-Pattern" class="headerlink" title="Apply Pattern"></a>Apply Pattern</h3><p><code>foo.call(thisObject)</code> å’Œ <code>foo.apply(thisObject)</code> çš„å½¢å¼è¢«ç§°ä¸º Apply Patternï¼Œä½¿ç”¨äº†å†…ç½®çš„ <code>call</code> å’Œ <code>apply</code> å‡½æ•°ã€‚åœ¨è¿™ç§æ¨¡å¼ä¸‹ï¼Œ<code>call</code> å’Œ <code>apply</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ <code>foo</code> å‡½æ•°ä½“å†…çš„ <code>this</code>ï¼Œå¦‚æœ <code>thisObject</code> æ˜¯ <code>null</code> æˆ– <code>undefined</code>ï¼Œé‚£ä¹ˆä¼šå˜æˆ Global å¯¹è±¡ã€‚<br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(c, d)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.a + <span class="keyword">this</span>.b + c + d;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    a: <span class="number">1</span>,</div><div class="line">    b: <span class="number">2</span></div><div class="line">&#125;</div><div class="line">add.call(obj, <span class="number">3</span>) <span class="comment">// 6</span></div><div class="line">add.apply(obj, [<span class="number">3</span>, <span class="number">4</span>]) <span class="comment">// 10</span></div></pre></td></tr></table></figure></p>
<blockquote>
<p>this å¯¹è±¡åªä¼šåœ¨ä¸€ä¸ªå‡½æ•°ä¸­éœ€è¦ç¡®å®šï¼Œå¦‚æœæ˜¯åœ¨å…¨å±€åŸŸä¸‹ï¼Œthis æ°¸è¿œä¸º Global å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ä¸­é€šå¸¸å°±æ˜¯ window å¯¹è±¡ã€‚<br>åº”ç”¨ä»¥ä¸Š4ç§æ–¹å¼ï¼Œç¡®å®šä¸€ä¸ªå‡½æ•°æ˜¯ä½¿ç”¨ä»€ä¹ˆæ ·çš„ Pattern è¿›è¡Œè°ƒç”¨çš„ï¼Œå°±èƒ½å¾ˆå®¹æ˜“ç¡®å®š this æ˜¯ä»€ä¹ˆã€‚å¦å¤–ï¼Œthis æ˜¯æ°¸è¿œä¸ä¼šå»¶ä½œç”¨åŸŸé“¾æˆ–åŸå‹é“¾å‡ºç°ä¸€ä¸ªâ€œæŸ¥æ‰¾â€çš„è¿‡ç¨‹çš„ï¼Œåªä¼šåœ¨å‡½æ•°è°ƒç”¨æ—¶å°±å¯ä»¥å®Œå…¨ç¡®è®¤ã€‚</p>
</blockquote>
<h3 id="å¸¸è§ä¾‹å­"><a href="#å¸¸è§ä¾‹å­" class="headerlink" title="å¸¸è§ä¾‹å­"></a>å¸¸è§ä¾‹å­</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">10</span>;</div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    <span class="attr">x</span>: <span class="number">20</span>,</div><div class="line">    <span class="attr">f</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</div><div class="line">        <span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</div><div class="line">        &#125;</div><div class="line">        foo(); <span class="comment">// (2)</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj.f(); <span class="comment">// (1)</span></div></pre></td></tr></table></figure>
<p>å…¶ä¸­ä¸¤å¤„è°ƒç”¨(1)ã€(2) åˆ†åˆ«è¾“å‡ºï¼š 20ã€10ï¼›</p>
<ul>
<li>(1): <code>obj.f()</code> è°ƒç”¨ï¼Œè¢«è°ƒç”¨çš„å‡½æ•° <code>f</code> ä½œä¸º <code>obj</code> å¯¹è±¡çš„å±æ€§å‡ºç°ï¼Œå±äº Method Invocation Patternï¼Œ<code>f</code> å‡½æ•°å†…çš„ <code>this</code> æŒ‡å‘ <code>obj</code>, æ‰€ä»¥ <code>f</code> å‡½æ•°ä¸­è¾“å‡º <code>this.x</code> ä¸º20</li>
<li>(2): <code>f</code> å‡½æ•°ä¸­è°ƒç”¨ <code>foo</code> å‡½æ•°æ—¶æ˜¯ä½œä¸ºå•ç‹¬çš„å˜é‡å‡ºç°ï¼Œè€ŒéæŸä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå±äº Function Invocation Patternï¼Œæ‰€ä»¥å…¶ä¸­ <code>this</code> æŒ‡å‘å…¨å±€å˜é‡ window, è¾“å‡º <code>this.x</code> æ—¶æ‰¾åˆ°å…¨å±€å˜é‡ä¸­ <code>x</code> çš„å€¼ 10ï¼Œæ‰€ä»¥è¾“å‡ºä¸º 10</li>
</ul>
<p>é‚£ä¹ˆå¦‚æœä¹Ÿå¸Œæœ›(2)å¤„è°ƒç”¨è¾“å‡º 20ï¼Œè¦å¦‚ä½•ä¿®æ”¹å‘¢ï¼ŸğŸ‘‡<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">10</span>;</div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">    <span class="attr">x</span>: <span class="number">20</span>,</div><div class="line">    <span class="attr">f</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</div><div class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="built_in">console</span>.log(that.x);</div><div class="line">        &#125;</div><div class="line">        foo(); <span class="comment">// (2)</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj.f(); <span class="comment">// (1)</span></div></pre></td></tr></table></figure></p>
<h2 id="bind-å‡½æ•°å’Œç®­å¤´å‡½æ•°"><a href="#bind-å‡½æ•°å’Œç®­å¤´å‡½æ•°" class="headerlink" title="bind å‡½æ•°å’Œç®­å¤´å‡½æ•°"></a>bind å‡½æ•°å’Œç®­å¤´å‡½æ•°</h2><h3 id="bind-å‡½æ•°"><a href="#bind-å‡½æ•°" class="headerlink" title="bind å‡½æ•°"></a>bind å‡½æ•°</h3><p>ES5 å¼•å…¥äº† <code>bind</code> æ–¹æ³•æ¥è®¾ç½®å‡½æ•°çš„ <code>this</code> å€¼ï¼Œè€Œä¸ç”¨è€ƒè™‘å‡½æ•°å¦‚ä½•è¢«è°ƒç”¨çš„ã€‚è°ƒç”¨ <code>f.bind(someObject)</code> ä¼šåˆ›å»ºä¸€ä¸ªä¸ f å…·æœ‰ç›¸åŒå‡½æ•°ä½“å’Œä½œç”¨åŸŸçš„å‡½æ•°ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªæ–°å‡½æ•°ä¸­ï¼Œthis å°†æ°¸ä¹…åœ°è¢«ç»‘å®šåˆ°äº† bind çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ— è®ºè¿™ä¸ªå‡½æ•°æ˜¯å¦‚ä½•è¢«è°ƒç”¨çš„ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.a;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> bar = foo.bind(&#123;</div><div class="line">    <span class="attr">a</span>: <span class="string">'hello'</span></div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log(bar()) <span class="comment">// hello</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> o = &#123;</div><div class="line">    <span class="attr">a</span>: <span class="string">'world'</span>,</div><div class="line">    <span class="attr">foo</span>: foo,</div><div class="line">    <span class="attr">bar</span>: bar</div><div class="line">&#125;;</div><div class="line"><span class="built_in">console</span>.log(o.foo(), o.bar()) <span class="comment">// world hello</span></div></pre></td></tr></table></figure></p>
<h3 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h3><p>ç®­å¤´å‡½æ•°åœ¨è®¾è®¡ä¸­ä½¿ç”¨çš„æ˜¯ Lexical thisï¼Œå³<strong>è¿™ä¸ªå‡½æ•°è¢«åˆ›å»ºæ—¶çš„æ‰€åœ¨ç¯å¢ƒçš„ this å°±æ˜¯å‡½æ•°å†…éƒ¨çš„ this</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">printThis</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> print = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="keyword">this</span>);</div><div class="line">    print();</div><div class="line">&#125;</div><div class="line">printThis.call([<span class="number">1</span>]); <span class="comment">// [1]</span></div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">printThis</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> print = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>)</div><div class="line">    &#125;</div><div class="line">    print();</div><div class="line">&#125;</div><div class="line">printThis.call([<span class="number">1</span>]); <span class="comment">// window</span></div></pre></td></tr></table></figure>
<h2 id="DOMäº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„-this"><a href="#DOMäº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„-this" class="headerlink" title="DOMäº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ this"></a>DOMäº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ this</h2><p>ä¸º DOM å…ƒç´ æ·»åŠ äº‹ä»¶å¤„ç†å‡½æ•°å¤§è‡´æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š</p>
<h3 id="æ–¹å¼ä¸€"><a href="#æ–¹å¼ä¸€" class="headerlink" title="æ–¹å¼ä¸€"></a>æ–¹å¼ä¸€</h3><p><code>element.onclick = doSomething;</code>ï¼Œå‡½æ•°è¢«ç”¨ä½œäº‹ä»¶å¤„ç†å‡½æ•°æ—¶ï¼Œå®ƒçš„thisæŒ‡å‘è§¦å‘äº‹ä»¶çš„å…ƒç´ <br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">'btn1'</span>&gt;</span>click me! btn1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">'btn2'</span>&gt;</span>click me! btn2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.id)</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> btn1Element = <span class="built_in">document</span>.getElementById(<span class="string">'btn1'</span>),</div><div class="line">	btn2Element = <span class="built_in">document</span>.getElementById(<span class="string">'btn2'</span>);</div><div class="line">btn1Element.onclick = clickHandler;</div><div class="line">btn2Element.onclick = clickHandler;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç‚¹å‡» button ä¹‹åï¼Œä¼šæ‰§è¡Œå…¶ <code>onclick</code> äº‹ä»¶å›è°ƒå‡½æ•° <code>clickHandler</code>ï¼Œæ‰§è¡Œæ—¶ï¼Œå‡½æ•°ä¸­çš„ <code>this</code> éƒ½ä¼šæŒ‡å‘è§¦å‘äº‹ä»¶çš„ button å…ƒç´ ï¼ˆ<code>onclick</code> æ˜¯ button å…ƒç´ çš„ä¸€ä¸ªå±æ€§ï¼‰</p>
<h3 id="æ–¹å¼äºŒ"><a href="#æ–¹å¼äºŒ" class="headerlink" title="æ–¹å¼äºŒ"></a>æ–¹å¼äºŒ</h3><p><code>&lt;element onclick=&quot;doSomething()&quot;&gt;</code>ï¼Œåœ¨å†…è”äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ <code>this</code>ï¼Œå¹¶ä¸æŒ‡å‘è§¦å‘äº‹ä»¶çš„å…ƒç´ <br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">'btn1'</span> <span class="attr">onclick</span>=<span class="string">"clickHandler()"</span>&gt;</span>click me! btn1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">'btn2'</span> <span class="attr">onclick</span>=<span class="string">"clickHandler()"</span>&gt;</span>click me! btn2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>, <span class="keyword">this</span>.id)</div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œç‚¹å‡» button ä¹‹åï¼Œä¼šæ‰§è¡Œ <code>clickHandler()</code> å‡½æ•°ï¼Œè¿™å±äº Function Invocation Patternï¼Œæ‰€ä»¥æ­¤æ—¶å‡½æ•°ä¸­çš„ <code>this</code> æŒ‡å‘ä¸º windowsï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º undefinedï¼‰</p>
<p>å¦‚æœå¸Œæœ›åœ¨å†…è”äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ <code>this</code> ä¹ŸæŒ‡å‘è¯¥å…ƒç´ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨ <code>bind</code> å‡½æ•°æŒ‡å®šå…¶ <code>this</code> å€¼ã€‚</p>
<blockquote>
<p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>call</code> æˆ–è€… <code>apply</code> æ–¹æ³•ã€‚<a href="http://objcer.com/2017/02/19/apply-call-bind/">JavaScript ä¸­çš„ applyã€callã€bind</a></p>
</blockquote>
<figure class="highlight hsp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">button</span> id=<span class="string">'btn1'</span> <span class="keyword">onclick</span>=<span class="string">"clickHandler.bind(this)()"</span>&gt;click me! btn1&lt;/<span class="keyword">button</span>&gt;</div><div class="line">&lt;<span class="keyword">button</span> id=<span class="string">'btn1'</span> <span class="keyword">onclick</span>=<span class="string">"clickHandler.call(this)"</span>&gt;click me! btn1&lt;/<span class="keyword">button</span>&gt;</div><div class="line">&lt;<span class="keyword">button</span> id=<span class="string">'btn1'</span> <span class="keyword">onclick</span>=<span class="string">"clickHandler.apply(this)"</span>&gt;click me! btn1&lt;/<span class="keyword">button</span>&gt;</div></pre></td></tr></table></figure>
<h3 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h3><p>é€šè¿‡ä»¥ä¸Šä¸¤ç§æ–¹å¼ä¸º DOM å…ƒç´ æ·»åŠ äº‹ä»¶å¤„ç†å‡½æ•°åï¼Œæˆ‘ä»¬å¯ä»¥è¾“å‡ºçœ‹çœ‹ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> btn1Element = <span class="built_in">document</span>.getElementById(<span class="string">'btn1'</span>);</div><div class="line"><span class="built_in">console</span>.log(btn1Element.onclick)</div></pre></td></tr></table></figure></p>
<ul>
<li><p>æ–¹å¼ä¸€è¾“å‡ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clickHandler</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="keyword">this</span>.id)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>æ–¹å¼äºŒè¾“å‡ºï¼š</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onclick</span><span class="params">(event)</span> </span>&#123;</div><div class="line">  clickHandler()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>é€šè¿‡ä»¥ä¸Šä¹Ÿå¾ˆå¥½è¯´æ˜äº†ï¼Œå‰è€…ä¸­çš„ <code>this</code> æŒ‡å‘è§¦å‘äº‹ä»¶çš„ DOM å…ƒç´ ï¼›è€Œåè€…ä¸­çš„ <code>this</code> æŒ‡å‘å…¨å±€å¯¹è±¡ window</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>é€šè¿‡ä»¥ä¸Šçš„äº†è§£ï¼Œä¸åŒæ–¹å¼ä¸º DOM å…ƒç´ æ·»åŠ äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå‡½æ•°ä¸­çš„ <code>this</code> æŒ‡å‘å¯èƒ½ä¸åŒï¼Œéœ€è¦ç‰¹åˆ«ç•™æ„ã€‚</p>
<p>é€šè¿‡ä»¥ä¸‹æ–¹å¼æ·»åŠ çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œ<code>this</code> éƒ½æ­£å¸¸æŒ‡å‘ DOM å…ƒç´ ï¼š<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">element</span>.onclick = doSomething</div><div class="line"><span class="keyword">element</span>.addEventListener(<span class="string">'click'</span>,doSomething, <span class="literal">false</span>)</div><div class="line"><span class="keyword">element</span>.onclick = <span class="function"><span class="keyword">function</span> () &#123; <span class="title">this</span>.<span class="title">style</span>.<span class="title">color</span> = <span class="string">'#cc0000'</span>; &#125;</span></div><div class="line">&lt;<span class="keyword">element</span> onclick=<span class="string">"this.style.color = '#cc0000';"</span>&gt;</div><div class="line">&lt;<span class="keyword">element</span> onclick=<span class="string">"doSomething.bind(this)()"</span>&gt;</div><div class="line">&lt;<span class="keyword">element</span> onclick=<span class="string">"doSomething.call(this)"</span>&gt;</div><div class="line">&lt;<span class="keyword">element</span> onclick=<span class="string">"doSomething.apply(this)"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>è€Œé€šè¿‡ä»¥ä¸‹æ–¹å¼æ·»åŠ çš„äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œ<code>this</code> å¹¶ä¸æŒ‡å‘ DOM å…ƒç´ ï¼š<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">element</span>.onclick = <span class="function"><span class="keyword">function</span> () &#123; <span class="title">doSomething</span>() &#125;</span></div><div class="line"><span class="keyword">element</span>.attachEvent(<span class="string">'onclick'</span>, doSomething)</div><div class="line">&lt;<span class="keyword">element</span> onclick=<span class="string">"doSomething()"</span>&gt;</div></pre></td></tr></table></figure></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/this" target="_blank" rel="external">MDN this</a><br><a href="http://www.quirksmode.org/js/this.html" target="_blank" rel="external">The this keyword</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;this&lt;/code&gt; æ˜¯ Javascript è¯­è¨€çš„ä¸€ä¸ªå…³é”®å­—ã€‚ å®ƒä»£è¡¨å‡½æ•°è¿è¡Œæ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„ä¸€ä¸ªå†…éƒ¨å¯¹è±¡ï¼Œåªèƒ½åœ¨å‡½æ•°å†…éƒ¨ä½¿ç”¨ã€‚è€Œè¿™ä¸ªå†…éƒ¨å¯¹è±¡ this æŒ‡å‘è°æœ‰æ—¶å´è®©æˆ‘ä»¬å¾ˆå›°æƒ‘ã€‚åœ¨ç»å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå‡½æ•°çš„è°ƒç”¨æ–¹å¼å†³å®šäº† this çš„å€¼ã€‚this ä¸èƒ½åœ¨æ‰§è¡ŒæœŸé—´è¢«èµ‹å€¼ï¼Œåœ¨æ¯æ¬¡å‡½æ•°è¢«è°ƒç”¨æ—¶ this çš„å€¼ä¹Ÿå¯èƒ½ä¼šä¸åŒã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JS" scheme="http://objcer.com/categories/JS/"/>
    
    
      <category term="this" scheme="http://objcer.com/tags/this/"/>
    
  </entry>
  
  <entry>
    <title>PhoneGap å…¥é—¨è¸©å‘</title>
    <link href="http://objcer.com/2017/03/25/getting-start-phonegap/"/>
    <id>http://objcer.com/2017/03/25/getting-start-phonegap/</id>
    <published>2017-03-25T08:27:07.000Z</published>
    <updated>2017-03-25T08:28:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¬å¸äº§å“åœ¨çº¿æ–‡ç« ç¼–è¾‘å™¨ <a href="https://d.wps.cn/home.html" target="_blank" rel="external">å†™å¾—</a> ä»Šå¹´éœ€è¦è¿›è¡Œç§»åŠ¨ APP çš„å¼€å‘ï¼Œç»è¿‡è€ƒå¯Ÿå†³å®šä½¿ç”¨ PhoneGapï¼Œå°½é‡é‡ç”¨åŸæœ‰çš„ web ä»£ç ï¼Œæ‰“åŒ…æˆç§»åŠ¨ APPã€‚åœ¨æ¥ä¸‹æ¥ä¸€æ®µæ—¶é—´å°†å¯¹è¿™ä¸ªæ¡†æ¶è¿›è¡Œä¸€äº›å­¦ä¹ ã€‚</p>
<a id="more"></a>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><a href="http://phonegap.com/" target="_blank" rel="external">PhoneGap</a> æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„ç§»åŠ¨ app å¼€å‘æ¡†æ¶ï¼Œå¯ä»¥æŠŠ html css js å†™çš„é¡µé¢æ‰“åŒ…æˆè·¨å¹³å°çš„å¯ä»¥å®‰è£…çš„ç§»åŠ¨ appï¼Œå¹¶ä¸”å¯ä»¥è°ƒç”¨åŸç”Ÿçš„å‡ ä¹æ‰€æœ‰çš„åŠŸèƒ½ï¼Œæ¯”å¦‚æ‘„åƒå¤´ï¼Œè”ç³»äººï¼ŒåŠ é€Ÿåº¦ç­‰ã€‚</p>
<p>ğŸ“Œ PhoneGap å’Œ Cordova çš„å…³ç³»ï¼Ÿ<br>Cordova æ˜¯ PhoneGap è´¡çŒ®ç»™ Apache åçš„å¼€æºé¡¹ç›®ï¼Œæ˜¯ä» PhoneGap ä¸­æŠ½ç¦»å‡ºçš„æ ¸å¿ƒä»£ç ï¼Œæ˜¯é©±åŠ¨ PhoneGap çš„æ ¸å¿ƒå¼•æ“ã€‚æœ‰ç‚¹ç±»ä¼¼ Webkit å’Œ Google Chrome çš„å…³ç³»ã€‚</p>
<blockquote>
<p><a href="http://phonegap.com/blog/2012/03/19/phonegap-cordova-and-whate28099s-in-a-name/" target="_blank" rel="external">PhoneGap, Cordova, and whatâ€™s in a name?</a><br>PhoneGap is a distribution of Apache Cordova. You can think of Apache Cordova as the engine that powers PhoneGap, similar to how WebKit is the engine that powers Chrome or Safari.</p>
</blockquote>
<h2 id="æ­å»ºå¼€å‘ç¯å¢ƒ"><a href="#æ­å»ºå¼€å‘ç¯å¢ƒ" class="headerlink" title="æ­å»ºå¼€å‘ç¯å¢ƒ"></a>æ­å»ºå¼€å‘ç¯å¢ƒ</h2><ol>
<li><p>å…¨å±€å®‰è£… <code>phonegap</code></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm <span class="selector-tag">i</span> -g phonegap</div></pre></td></tr></table></figure>
</li>
<li><p>å¸¸ç”¨å‘½ä»¤</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// åˆ›å»ºä¸€ä¸ªapp</div><div class="line">phonegap <span class="built_in">create</span> path/<span class="built_in">to</span>/my-app<span class="comment"></span></div><div class="line">// æ·»åŠ  iOS å¹³å°é¡¹ç›®</div><div class="line">phonegap <span class="built_in">platform</span> <span class="built_in">add</span> ios <span class="comment">--save</span><span class="comment"></span></div><div class="line">// æ›´æ–° iOS é¡¹ç›®ä»£ç æ–‡ä»¶</div><div class="line">phonegap <span class="built_in">prepare</span> ios<span class="comment"></span></div><div class="line">// å¯åŠ¨æµè§ˆå™¨è°ƒè¯•æœåŠ¡</div><div class="line">phonegap serve<span class="comment"></span></div><div class="line">// iOS æ¨¡æ‹Ÿå™¨ä¸­è¿è¡Œ</div><div class="line">phonegap run ios <span class="comment">--emulator</span></div><div class="line">phonegap run ios <span class="comment">--emulator --target='iPhone-SE, 10.2'</span></div></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ iOS æ¨¡æ‹Ÿå™¨ä¸­è°ƒè¯•</p>
</li>
</ol>
<p>è™½ç„¶ PhoneGap ä¹Ÿæä¾›äº†åœ¨æµè§ˆå™¨ä¸­è°ƒè¯•é¡µé¢çš„å‘½ä»¤ <code>phonegap serve</code> ä½†æ˜¯åœ¨ç§»åŠ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæœ‰äº›ä¾‹å¦‚æ²™ç›’ï¼ŒImagePicker ç­‰çš„è°ƒè¯•ï¼Œå°±éœ€è¦ç”¨æ¨¡æ‹Ÿå™¨æ¥è¿›è¡Œã€‚é™¤äº†é€šè¿‡å¦‚ä¸Š <code>phonegap run ios --emulator</code> å‘½ä»¤å¯æ¨¡æ‹Ÿå™¨ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç”¨ Xcode æ‰“å¼€ <code>platforms/ios/</code> ç›®å½•ä¸­çš„ <code>xcworkspace</code> ç„¶åè¿è¡Œè·‘å‡ºæ¨¡æ‹Ÿå™¨ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥é€šè¿‡ Safari è°ƒè¯•å·¥å…·å¯¹æ¨¡æ‹Ÿå™¨ä¸­çš„ç½‘é¡µè¿›è¡Œè°ƒè¯•ã€‚</p>
<p>â—ï¸æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æŠ€å·§ï¼šç‚¹å‡» Xcode ä¸­ run è·‘å‡ºæ¨¡æ‹Ÿå™¨ï¼Œå¦‚æœæˆ‘ä»¬çš„å‰ç«¯ä»£ç æœ‰é—®é¢˜ï¼Œå‡ºé”™çš„è¯ï¼Œå°±ä¼šåœ¨å‡ºé”™å‡ºä¸­æ–­æ‰§è¡Œï¼Œä½†æ˜¯åœ¨ Xcode ä¸­çš„è°ƒè¯•è¾“å‡ºå’Œ Safari çš„è°ƒè¯•è¾“å‡ºä¸­éƒ½æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰æ—¶å€™å¯èƒ½å¹¶ä¸ä¼šå‘è§‰å‡ºé”™äº†ï¼Œæˆ–è€…ä¸çŸ¥é“å“ªé‡Œå‡ºäº†é—®é¢˜ã€‚è§£å†³è¿™ä¸ªé—®é¢˜æ¯”è¾ƒç®€å•ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ Safari è°ƒè¯•é¡µé¢ä¸­ reload ä¸€ä¸‹é¡µé¢å³å¯ã€‚</p>
<ul>
<li>æ–¹æ³•ä¸€ï¼š<br>é€šå¸¸æˆ‘ä»¬éƒ½æ˜¯ä½¿ç”¨ Sublime Text æˆ–è€… Actom è¿™ç±»ç¼–è¾‘å™¨æ¥ç¼–å†™ä»£ç ã€‚ç¼–è¾‘åï¼Œæˆ‘ä»¬éœ€è¦ <code>phonegap prepare ios</code> æ¥æ›´æ–° iOS é¡¹ç›®ï¼Œç„¶ååœ¨ Xcode ä¸­é‡æ–°è¿è¡Œã€‚é‡å¤å¦‚æ­¤çš„æ­¥éª¤ï¼Œæ˜¾ç„¶ä¸æ˜¯å¤ªæ–¹ä¾¿ã€‚</li>
<li>æ–¹æ³•äºŒï¼š<br>æˆ‘ä»¬çŸ¥é“åœ¨ PhoneGap æ‰“åŒ…ç§»åŠ¨åº”ç”¨ï¼Œæ˜¯æŠŠç½‘é¡µä»£ç æ”¾åœ¨åº”ç”¨ä¸­ï¼Œé€šè¿‡ file åè®®è¿›è¡ŒåŠ è½½ï¼Œè¿™æ ·æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹äº†é¡µé¢ï¼Œå°±éœ€è¦é€šè¿‡ <code>phonegap prepare ios</code> æ¥æ›´æ–° iOS é¡¹ç›®ï¼Œç„¶åéœ€è¦ Xcode é‡æ–°è¿è¡Œã€‚é‚£å¦‚æœæˆ‘ä»¬æŠŠç½‘é¡µæ–‡ä»¶çš„å¼•ç”¨ä¿®æ”¹æˆè¯·æ±‚æˆ‘ä»¬æœ¬åœ°çš„ server è¿™æ ·æˆ‘ä»¬æ¯æ¬¡ä¿®æ”¹äº†æ–‡ä»¶ï¼Œå°±åªéœ€è¦ reload æ¨¡æ‹Ÿå™¨ä¸­çš„é¡µé¢å°±å¯ä»¥äº†ã€‚</li>
</ul>
<p>â‘ å¯åŠ¨æœ¬åœ° server<br><figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>)</div><div class="line"><span class="keyword">const</span> browserSync = <span class="built_in">require</span>(<span class="string">'browser-sync'</span>)</div><div class="line"></div><div class="line">gulp.task(<span class="string">'debug'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">	browserSync(&#123;</div><div class="line">        port: <span class="number">8082</span>,</div><div class="line">        logPrefix: <span class="string">'WPS Writer'</span>,</div><div class="line">        open: <span class="literal">false</span>,</div><div class="line">        server: &#123;</div><div class="line">            baseDir: [<span class="string">'www'</span>],</div><div class="line">            directory: <span class="literal">true</span></div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>â‘¡ç½‘é¡µæ–‡ä»¶å¼•ç”¨è·¯å¾„ä¿®æ”¹<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"scripts/index.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">å˜æˆ--&gt;</div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://localhost:8082/scripts/index.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¬å¸äº§å“åœ¨çº¿æ–‡ç« ç¼–è¾‘å™¨ &lt;a href=&quot;https://d.wps.cn/home.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;å†™å¾—&lt;/a&gt; ä»Šå¹´éœ€è¦è¿›è¡Œç§»åŠ¨ APP çš„å¼€å‘ï¼Œç»è¿‡è€ƒå¯Ÿå†³å®šä½¿ç”¨ PhoneGapï¼Œå°½é‡é‡ç”¨åŸæœ‰çš„ web ä»£ç ï¼Œæ‰“åŒ…æˆç§»åŠ¨ APPã€‚åœ¨æ¥ä¸‹æ¥ä¸€æ®µæ—¶é—´å°†å¯¹è¿™ä¸ªæ¡†æ¶è¿›è¡Œä¸€äº›å­¦ä¹ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="PhoneGap" scheme="http://objcer.com/categories/PhoneGap/"/>
    
    
  </entry>
  
  <entry>
    <title>é—­åŒ…ï¼ˆclosuresï¼‰</title>
    <link href="http://objcer.com/2017/03/19/closures/"/>
    <id>http://objcer.com/2017/03/19/closures/</id>
    <published>2017-03-19T13:58:11.000Z</published>
    <updated>2017-07-20T11:46:24.000Z</updated>
    
    <content type="html"><![CDATA[<p>JS ä¸­é—­åŒ…æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ã€‚ <strong>å®ƒç”±ä¸¤éƒ¨åˆ†æ„æˆï¼šå‡½æ•°ï¼Œä»¥åŠåˆ›å»ºè¯¥å‡½æ•°çš„ç¯å¢ƒã€‚ç¯å¢ƒç”±é—­åŒ…åˆ›å»ºæ—¶åœ¨ä½œç”¨åŸŸä¸­çš„ä»»ä½•å±€éƒ¨å˜é‡ç»„æˆã€‚</strong>ç®€å•çš„ç†è§£ï¼šåœ¨ä¸€ä¸ªå‡½æ•°ä¸­åˆ›å»ºäº†å¦ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±åˆ›å»ºäº†ä¸€ä¸ªé—­åŒ…ã€‚</p>
<a id="more"></a>
<p>ğŸ‘‡ä¸‹é¢å°†é€šè¿‡ä¸€äº›é—­åŒ…ä½¿ç”¨ä¾‹å­æ¥ç†è§£é—­åŒ…è¿™ä¸ªæ¦‚å¿µã€‚</p>
<h2 id="é—­åŒ…æ¦‚å¿µ"><a href="#é—­åŒ…æ¦‚å¿µ" class="headerlink" title="é—­åŒ…æ¦‚å¿µ"></a>é—­åŒ…æ¦‚å¿µ</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> name = <span class="string">'Cony'</span>;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(name)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> displayName = init();</div><div class="line">displayName();</div></pre></td></tr></table></figure>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ<code>init</code> å‡½æ•°æ‰§è¡Œåè¿”å›çš„åŒ¿åå‡½æ•° <code>displayName</code> å°±æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œç”± <code>displayName</code> å‡½æ•°å’Œé—­åŒ…åˆ›å»ºæ—¶å­˜åœ¨çš„ <code>Cony</code> å­—ç¬¦ä¸²å½¢æˆã€‚</p>
<p>å…¶ä¸­æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>é—­åŒ…å¯ä»¥è·å–å¼•ç”¨åˆ°åˆ›å»ºæ—¶æ‰€åœ¨ç¯å¢ƒçš„å±€éƒ¨å˜é‡</li>
<li><code>init</code> å‡½æ•°æ‰§è¡Œåï¼Œå…¶ä¸­çš„å±€éƒ¨å˜é‡å¹¶ä¸ä¼šé©¬ä¸Šè¢«é‡Šæ”¾ï¼Œæ‰€ä»¥åœ¨ç¨åé—­åŒ…å‡½æ•°æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥è¢«å¼•ç”¨åˆ°ï¼ˆè¿™ä¸€ç‚¹å¯èƒ½å’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€æœ‰ç‚¹åŒºåˆ«ï¼Œä¾‹å¦‚Cè¯­è¨€ä¸­ï¼Œå‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå…¶ä¸­çš„å±€éƒ¨å˜é‡å°±è¢«é‡Šæ”¾äº†ï¼‰</li>
</ul>
<h2 id="é—­åŒ…å¼•ç”¨åˆ›å»ºç¯å¢ƒä¸­çš„å±€éƒ¨å˜é‡"><a href="#é—­åŒ…å¼•ç”¨åˆ›å»ºç¯å¢ƒä¸­çš„å±€éƒ¨å˜é‡" class="headerlink" title="é—­åŒ…å¼•ç”¨åˆ›å»ºç¯å¢ƒä¸­çš„å±€éƒ¨å˜é‡"></a>é—­åŒ…å¼•ç”¨åˆ›å»ºç¯å¢ƒä¸­çš„å±€éƒ¨å˜é‡</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> num = <span class="number">12</span>;</div><div class="line">    <span class="keyword">var</span> log = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(num)</div><div class="line">    &#125;</div><div class="line">    num ++;</div><div class="line">    <span class="keyword">return</span> log;</div><div class="line">&#125;</div><div class="line"></div><div class="line">init()(); <span class="comment">// 13</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­è¯´æ˜é—­åŒ…å‡½æ•°ä¸­ä½¿ç”¨çš„ <code>num</code> å˜é‡æ—¶å¼•ç”¨å¤–éƒ¨çš„ï¼Œè€Œåœ¨æ‰§è¡Œæ—¶ï¼Œå¤–éƒ¨çš„ <code>num</code> å˜é‡å·²ç»å˜æˆäº† 13ï¼Œæ‰€ä»¥ä¼šè¾“å‡º 13ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">init</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> log = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(num)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> num = <span class="number">12</span>;</div><div class="line">    <span class="keyword">return</span> log;</div><div class="line">&#125;</div><div class="line"></div><div class="line">init()(); <span class="comment">// 12</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­è¯´æ˜ï¼Œé—­åŒ…å‡½æ•°å¯ä»¥ä½¿ç”¨åˆ›å»ºæ—¶æ‰€åœ¨ç¯å¢ƒçš„æ‰€æœ‰å±€éƒ¨å˜é‡ï¼Œå³ä¾¿æ˜¯åœ¨å…¶åå£°æ˜å®šä¹‰çš„ã€‚</p>
<blockquote>
<p>è¿™ä¸ªä¾‹å­ä¸­æ¶‰åŠ variable hoistingï¼ˆå˜é‡æå‡ï¼‰ï¼Œå¯ä»¥å‚è€ƒ <a href="https://bitsofco.de/variable-and-function-hoisting-in-es2015/" target="_blank" rel="external">Variable and Function Hoisting in ES2015</a></p>
</blockquote>
<h2 id="åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…"><a href="#åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…" class="headerlink" title="åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…"></a>åœ¨å¾ªç¯ä¸­åˆ›å»ºé—­åŒ…</h2><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildList</span>(<span class="params">list</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> result = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>.length; i++) &#123;</div><div class="line">        <span class="keyword">var</span> item = <span class="string">'item'</span> + i;</div><div class="line">        result.push( <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(item + <span class="string">' '</span> + <span class="built_in">list</span>[i])&#125; );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">testList</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> fnlist = buildList([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]);</div><div class="line">    <span class="comment">// Using j only to help prevent confusion -- could use i.</span></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; fnlist.length; j++) &#123;</div><div class="line">        fnlist[j]();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">testList()</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ <code>buildList</code> å‡½æ•°æ¥æ”¶ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åä¸ºæ¯ä¸€ä¸ªæ•°ç»„å…ƒç´ åˆ›å»ºä¸€ä¸ªé—­åŒ…å‡½æ•°ï¼Œè¿”å›é—­åŒ…å‡½æ•°æ•°ç»„ã€‚æœŸæœ›ä¸­ï¼Œ<code>testList</code> å‡½æ•°æ‰§è¡Œåï¼Œè¾“å‡ºï¼š<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">item0 </span><span class="number">1</span></div><div class="line"><span class="keyword">item1 </span><span class="number">2</span></div><div class="line"><span class="keyword">item2 </span><span class="number">3</span></div></pre></td></tr></table></figure></p>
<p>ä½†æ˜¯ä¸Šé¢è¿™æ®µä»£ç å´é‡å¤è¾“å‡º3æ¬¡ï¼š<code>item2 undefined</code>ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼ŸğŸ¤”<br><em>åˆ†æä¸€ä¸‹ï¼š</em><br>åœ¨ <code>buildList</code> å‡½æ•°ä¸­çš„ <code>for</code> å¾ªç¯ä¸º <code>result</code> æ•°ç»„æ·»åŠ ä¸‰ä¸ªåŒ¿åå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é—­åŒ…å‡½æ•°ï¼Œè¿™ä¸‰ä¸ªé—­åŒ…å‡½æ•°åˆ›å»ºæ—¶æ‰€åœ¨çš„ç¯å¢ƒç›¸åŒï¼Œå…±äº«å…¶ä¸­çš„å±€éƒ¨å˜é‡ï¼ˆ<code>item</code>ï¼Œ<code>i</code> å’Œ <code>list</code>ï¼‰ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨å‡½æ•° <code>buildList</code> æ‰§è¡Œç»“æŸåï¼Œ å±€éƒ¨å˜é‡ <code>item</code> çš„å€¼å˜æˆäº† <code>item2</code>ï¼Œ<code>i</code> çš„å€¼å·²ç»å˜æˆ 3ï¼Œæ‰€ä»¥ <code>list[i]</code> çš„å€¼å°±æ˜¯ <code>undefined</code>ã€‚æ‰€ä»¥åœ¨ <code>testList</code> å‡½æ•°æ‰§è¡Œé—­åŒ…å‡½æ•° <code>fnlist[j]()</code> æ—¶ï¼Œæ¯ä¸€æ¬¡çš„è¾“å‡ºç»“æœéƒ½æ˜¯ç›¸åŒçš„ <code>item2 undefined</code>ã€‚</p>
<p>é‚£ä¹ˆè¦å¦‚ä½•ä¿®æ”¹ï¼Œæ‰èƒ½å¾—åˆ°æˆ‘ä»¬æœŸæœ›ä¸­çš„ç»“æœå‘¢ï¼Ÿæ–¹å¼æœ‰å¥½å¤šç§ï¼Œç®€å•ç½—åˆ—ä¸¤ç§ã€‚<br>1ã€ä½¿ç”¨ ES6 <code>let</code> ä»£æ›¿ <code>var</code><br><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åœ¨ buildList å‡½æ•°ä¸­ï¼Œå°†å…¶ä¸­çš„ä¸¤å¤„ var æ›¿æ¢æˆ let</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>.length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> item = <span class="string">'item'</span> + i;</div><div class="line">    result.push( <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(item + <span class="string">' '</span> + <span class="built_in">list</span>[i])&#125; );</div><div class="line">&#125;</div><div class="line">--&gt;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>.length; i++) &#123;</div><div class="line">    <span class="keyword">let</span> item = <span class="string">'item'</span> + i;</div><div class="line">    result.push( <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(item + <span class="string">' '</span> + <span class="built_in">list</span>[i])&#125; );</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>2ã€é€šè¿‡é—­åŒ…è§£å†³<br><figure class="highlight qml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">buildList</span>(<span class="params">list</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> result = [];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="built_in">list</span>.length; i++) &#123;</div><div class="line">        (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> index = i;</div><div class="line">            <span class="keyword">var</span> item = <span class="string">'item'</span> + index;</div><div class="line">            result.push( <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="built_in">console</span>.log(item + <span class="string">' '</span> + <span class="built_in">list</span>[index])&#125; );</div><div class="line">        &#125;)();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œé—­åŒ…å‡½æ•°å¯ä»¥å¼•ç”¨åˆ›å»ºæ—¶æ‰€åœ¨ç¯å¢ƒçš„å±€éƒ¨å˜é‡ï¼Œè¿™é‡Œé€šè¿‡é—­åŒ…ï¼Œ<code>for</code> å¾ªç¯ä¸­æ¯ä¸€ä¸ªé—­åŒ…å¼•ç”¨çš„ <code>index</code> éƒ½ä¸åŒï¼Œéƒ½æ˜¯å•ç‹¬çš„ï¼Œè¿™æ ·ï¼Œä»£ç å°±å¦‚æˆ‘ä»¬é¢„æœŸçš„ç»“æœè¿è¡Œã€‚</p>
<h2 id="ç”¨é—­åŒ…æ¨¡æ‹Ÿç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•"><a href="#ç”¨é—­åŒ…æ¨¡æ‹Ÿç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•" class="headerlink" title="ç”¨é—­åŒ…æ¨¡æ‹Ÿç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•"></a>ç”¨é—­åŒ…æ¨¡æ‹Ÿç§æœ‰å±æ€§å’Œç§æœ‰æ–¹æ³•</h2><p>åœ¨ JS ä¸­å¹¶ä¸æ”¯æŒç§æœ‰å±æ€§å’Œæ–¹æ³•ï¼Œä½†æ˜¯é€šè¿‡é—­åŒ…å¯ä»¥æ¨¡æ‹Ÿå®ç°ã€‚é€šè¿‡é—­åŒ…æ¥å®šä¹‰å…¬å…±æ¥å£ï¼Œå¹¶éšè—ç§æœ‰æ–¹æ³•å’Œå˜é‡ï¼Œè¿™ä¹Ÿç§°ä¹‹ä¸ºæ¨¡å—æ¨¡å¼ï¼ˆmodule patternï¼‰<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Counter = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> privateCounter = <span class="number">0</span>;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">_changeBy</span>(<span class="params">val</span>) </span>&#123;</div><div class="line">        privateCounter += val;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">increment</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            _changeBy(<span class="number">1</span>);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">decrement</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            _changeBy(<span class="number">-1</span>);</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">value</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> privateCounter;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)();</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ <code>privateCounter</code> å’Œ <code>_changeBy</code> åˆ†åˆ«ä¸ºç§æœ‰å˜é‡å’Œç§æœ‰æ–¹æ³•ï¼Œæ— æ³•é€šè¿‡ <code>Counter</code> ç›´æ¥è®¿é—®ï¼›è€Œ <code>increment</code> <code>decrement</code> <code>value</code> å‡ä¸ºå…¬å…±æ¥å£ã€‚</p>
<h2 id="æ€è€ƒé¢˜"><a href="#æ€è€ƒé¢˜" class="headerlink" title="æ€è€ƒé¢˜"></a>æ€è€ƒé¢˜</h2><p>åœ¨ <a href="http://www.ruanyifeng.com/blog/2009/08/learning_javascript_closures.html" target="_blank" rel="external">å­¦ä¹ Javascripté—­åŒ…ï¼ˆClosureï¼‰</a> è¿™ç¯‡æ–‡ç« æœ€åæåˆ°ä¸¤ä¸ªä¾‹å­ï¼Œå¼•ç”¨åˆ°æ­¤å¤„ï¼Œä»¥ä¸‹ä¸¤æ®µä»£ç åˆ†åˆ«è¾“å‡ºä»€ä¹ˆï¼Œå…¶ä¸­ä¹Ÿæ¶‰åŠåˆ° <code>this</code> å…³é”®å­—çš„é—®é¢˜ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"The Window"</span>;</div><div class="line"><span class="keyword">var</span> object = &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">"My Object"</span>,</div><div class="line">    <span class="attr">getNameFunc</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">console</span>.log(object.getNameFunc()());</div></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> name = <span class="string">"The Window"</span>;</div><div class="line"><span class="keyword">var</span> object = &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">"My Object"</span>,</div><div class="line">    <span class="attr">getNameFunc</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> that = <span class="keyword">this</span>;</div><div class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> that.name;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">console</span>.log(object.getNameFunc()());</div></pre></td></tr></table></figure>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://stackoverflow.com/questions/111102/how-do-javascript-closures-work?answertab=votes#tab-top" target="_blank" rel="external">JavaScript Closures for Beginners</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;JS ä¸­é—­åŒ…æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡ã€‚ &lt;strong&gt;å®ƒç”±ä¸¤éƒ¨åˆ†æ„æˆï¼šå‡½æ•°ï¼Œä»¥åŠåˆ›å»ºè¯¥å‡½æ•°çš„ç¯å¢ƒã€‚ç¯å¢ƒç”±é—­åŒ…åˆ›å»ºæ—¶åœ¨ä½œç”¨åŸŸä¸­çš„ä»»ä½•å±€éƒ¨å˜é‡ç»„æˆã€‚&lt;/strong&gt;ç®€å•çš„ç†è§£ï¼šåœ¨ä¸€ä¸ªå‡½æ•°ä¸­åˆ›å»ºäº†å¦ä¸€ä¸ªå‡½æ•°ï¼Œä¹Ÿå°±åˆ›å»ºäº†ä¸€ä¸ªé—­åŒ…ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JS" scheme="http://objcer.com/categories/JS/"/>
    
    
      <category term="é—­åŒ…" scheme="http://objcer.com/tags/%E9%97%AD%E5%8C%85/"/>
    
  </entry>
  
  <entry>
    <title>å…³äº CSS transition-timing-function</title>
    <link href="http://objcer.com/2017/03/18/css-transition-timing-function/"/>
    <id>http://objcer.com/2017/03/18/css-transition-timing-function/</id>
    <published>2017-03-18T08:48:37.000Z</published>
    <updated>2017-03-18T08:50:52.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ CSS Animation å±æ€§ä¸­å¯ä»¥è®¾ç½®å’ŒåŠ¨ç”»æœ‰å…³çš„å‚æ•°ï¼Œå…¶ä¸­ transition-timing-function æ˜¯è§„å®šåŠ¨ç”»æ‰§è¡Œçš„é€Ÿåº¦æ›²çº¿ï¼Œå¸¸è§çš„å–å€¼æœ‰ä¸¤ä¸ªï¼šâ‘ æ­¥è¿›å‡½æ•° â‘¡ä¸‰æ¬¡è´å¡å°”æ›²çº¿</p>
<blockquote>
<p>Timing functions are either defined as a stepping function or a cubic BÃ©zier curve.</p>
</blockquote>
<p><a href="https://www.w3.org/TR/2012/WD-css3-transitions-20120403/#transition-timing-function-property" target="_blank" rel="external">(W3C)The â€˜transition-timing-functionâ€™ Property</a><br><a id="more"></a></p>
<p>å¹³æ—¶ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¤§å¤šéƒ½æ˜¯ç”¨ linear ease ease-in ease-out ease-in-out cubic-bezier(n,n,n,n) è¿™å‡ ä¸ªå‚æ•°ï¼Œè¿™äº›æ–¹å¼è¿‡æ¸¡åŠ¨ç”»ï¼Œä¼šåœ¨æ¯ä¸ªå…³é”®å¸§ä¹‹é—´æ’å…¥è¡¥é—´åŠ¨ç”»ï¼Œæ‰€ä»¥çœ‹èµ·æ¥åŠ¨ç”»çš„æ•ˆæœæ˜¯å¹³æ»‘è¿è´¯çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// html</span></div><div class="line">&lt;<span class="selector-tag">div</span> class=<span class="string">"box"</span>&gt;&lt;/div&gt;</div><div class="line"><span class="comment">// css</span></div><div class="line"><span class="selector-class">.box</span> &#123;</div><div class="line">	<span class="attribute">position</span>: absolute;</div><div class="line">	<span class="attribute">left</span>: <span class="number">0px</span>;</div><div class="line">	<span class="attribute">width</span>: <span class="number">150px</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">150px</span>;</div><div class="line">	<span class="attribute">background</span>: gray;</div><div class="line">	<span class="attribute">animation</span>: move <span class="number">2s</span> linear forwards;</div><div class="line">&#125;</div><div class="line">@keyframes move &#123;</div><div class="line">	<span class="number">0%</span> &#123;</div><div class="line">		<span class="attribute">left</span>: <span class="number">0px</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="number">100%</span> &#123;</div><div class="line">		<span class="attribute">left</span>: <span class="number">600px</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¯¥ä¾‹å­ä¸­ï¼Œdiv èŠ‚ç‚¹å°±ä¼šåŒ€é€Ÿä»å·¦å‘å³ç§»åŠ¨ã€‚</p>
<p>ç„¶è€Œå¯¹äºæœ‰äº›åŠ¨ç”»æ•ˆæœæ˜¯ä¸éœ€è¦è¿è´¯çš„ï¼Œåªéœ€è¦åœ¨å…³é”®å¸§ä¹‹é—´è·³è·ƒï¼Œç§°ä¹‹ä¸ºé€å¸§åŠ¨ç”»ï¼›è¿™ä¸ªæ—¶å€™å°±åº”è¯¥ä½¿ç”¨ steps æ–¹å¼è¿‡æ¸¡ï¼Œå¯ä»¥æŒ‡å®šçš„å‚æ•°åŒ…æ‹¬ï¼š<code>step-start | step-end | steps(&lt;integer&gt;[, [ start | end ] ]?)</code></p>
<ul>
<li><code>steps(&lt;integer&gt;[, [ start | end ] ]?)</code> å¯ä»¥ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¤§äº0çš„æ•´æ•°ï¼Œå®ƒæ˜¯å°†é—´éš”åŠ¨ç”»ï¼Œä¹Ÿå³æ˜¯<strong>ä¸¤ä¸ªå…³é”®å¸§</strong>ï¼Œç­‰åˆ†æˆæŒ‡å®šæ•°ç›®çš„å°é—´éš”åŠ¨ç”»ï¼›ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¯ä»¥æ¥å— start å’Œ end ä¸¤ä¸ªå€¼ï¼ŒæŒ‡å®šåœ¨æ¯ä¸ªé—´éš”çš„ç»ˆç‚¹æˆ–æ˜¯èµ·ç‚¹å‘ç”Ÿé˜¶è·ƒå˜åŒ–ï¼Œé»˜è®¤ä¸º end</li>
<li><code>step-start</code> ç­‰åŒäº <code>steps(1,start)</code>ï¼šåŠ¨ç”»åˆ†æˆ1æ­¥ï¼ŒåŠ¨ç”»æ‰§è¡Œæ—¶ä»¥ <strong>é—´éš”ç»ˆç‚¹</strong> ä¸ºèµ·ç‚¹å¼€å§‹å˜åŒ–ï¼›</li>
<li><code>step-end</code> ç­‰åŒäº <code>steps(1,end)</code>ï¼šåŠ¨ç”»åˆ†æˆä¸€æ­¥ï¼ŒåŠ¨ç”»æ‰§è¡Œæ—¶ä»¥ <strong>é—´éš”èµ·ç‚¹</strong> ä¸ºèµ·ç‚¹å¼€å§‹å˜åŒ–ã€‚</li>
</ul>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/step.png" alt=""></p>
<p>ä¾‹å¦‚ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// html</span></div><div class="line">&lt;<span class="selector-tag">div</span> class=<span class="string">"box"</span>&gt;&lt;/div&gt;</div><div class="line"><span class="comment">// css</span></div><div class="line"><span class="selector-class">.box</span> &#123;</div><div class="line">	<span class="attribute">position</span>: absolute;</div><div class="line">	<span class="attribute">left</span>: <span class="number">0px</span>;</div><div class="line">	<span class="attribute">width</span>: <span class="number">150px</span>;</div><div class="line">	<span class="attribute">height</span>: <span class="number">150px</span>;</div><div class="line">	<span class="attribute">background</span>: gray;</div><div class="line">	<span class="attribute">animation</span>: move <span class="number">2s</span> steps(<span class="number">2</span>, start) forwards;</div><div class="line">&#125;</div><div class="line">@keyframes move &#123;</div><div class="line">	<span class="number">0%</span> &#123;</div><div class="line">		<span class="attribute">left</span>: <span class="number">0px</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="number">100%</span> &#123;</div><div class="line">		<span class="attribute">left</span>: <span class="number">600px</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>è¯¥ä¾‹å­ä¸­ï¼Œdiv èŠ‚ç‚¹ç§»åŠ¨å˜åŒ–ï¼š<code>300px --&gt; 600px</code>ã€‚å¦‚æœä¿®æ”¹æˆ <code>animation: move 2s steps(2, end) forwards;</code>ï¼Œé‚£ä¹ˆ div èŠ‚ç‚¹ç§»åŠ¨å˜åŒ–ï¼š<code>0px --&gt; 300px --&gt; 600px</code></p>
<p>é€å¸§åŠ¨ç”»ä¾‹å­å¯ä»¥å‚è€ƒ: <a href="http://www.jianshu.com/p/05c5a9b302d2" target="_blank" rel="external">cssé€å¸§åŠ¨ç”»</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ CSS Animation å±æ€§ä¸­å¯ä»¥è®¾ç½®å’ŒåŠ¨ç”»æœ‰å…³çš„å‚æ•°ï¼Œå…¶ä¸­ transition-timing-function æ˜¯è§„å®šåŠ¨ç”»æ‰§è¡Œçš„é€Ÿåº¦æ›²çº¿ï¼Œå¸¸è§çš„å–å€¼æœ‰ä¸¤ä¸ªï¼šâ‘ æ­¥è¿›å‡½æ•° â‘¡ä¸‰æ¬¡è´å¡å°”æ›²çº¿&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Timing functions are either defined as a stepping function or a cubic BÃ©zier curve.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.w3.org/TR/2012/WD-css3-transitions-20120403/#transition-timing-function-property&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;(W3C)The â€˜transition-timing-functionâ€™ Property&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="CSS" scheme="http://objcer.com/categories/CSS/"/>
    
    
      <category term="transition-timing-function" scheme="http://objcer.com/tags/transition-timing-function/"/>
    
  </entry>
  
  <entry>
    <title>å…³äº CSS border-radius</title>
    <link href="http://objcer.com/2017/03/17/css-border-radius/"/>
    <id>http://objcer.com/2017/03/17/css-border-radius/</id>
    <published>2017-03-17T13:46:43.000Z</published>
    <updated>2017-03-17T15:07:38.000Z</updated>
    
    <content type="html"><![CDATA[<p><code>border-radius</code> ç”¨æ¥è®¾ç½®è¾¹æ¡†åœ†è§’ã€‚å½“ä½¿ç”¨ä¸€ä¸ªåŠå¾„æ—¶ç¡®å®šä¸€ä¸ªåœ†å½¢ï¼›å½“ä½¿ç”¨ä¸¤ä¸ªåŠå¾„æ—¶ç¡®å®šä¸€ä¸ªæ¤­åœ†ï¼Œè¿™ä¸ª(æ¤­)åœ†ä¸è¾¹æ¡†çš„äº¤é›†å½¢æˆåœ†è§’æ•ˆæœã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/FC08A931-6DE4-4CE0-A6F8-4F1B523E2007.png" alt=""></p>
<p>å¯¹äº <code>border-radius</code> å±æ€§ï¼Œæˆ‘ä»¬æœ€å¸¸è§å°±æ˜¯è®¾ç½®ä¸€ä¸ªå‚æ•°ï¼š<br><figure class="highlight scss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">border-radius</span>: <span class="number">50px</span>;</div><div class="line"><span class="comment">// æˆ–è€…</span></div><div class="line"><span class="attribute">border-radius</span>: <span class="number">50%</span>;</div></pre></td></tr></table></figure></p>
<p>è€Œè¿™ç§ç”¨æ³•å…¶å®å°±æ˜¯ä¸ºå››ä¸ªè§’éƒ½æŒ‡å®šäº†ç›¸åŒçš„åœ†è§’åŠå¾„ï¼Œç„¶è€Œå¯¹äº <code>border-radius</code> å…¶å®æœ‰æ›´åŠ çµæ´»çš„ç”¨æ³•ï¼Œå¯ä»¥åˆ†åˆ«è®¾ç½®å››ä¸ªè§’ä¸åŒçš„åœ†è§’æ•ˆæœã€‚</p>
<a id="more"></a>
<h2 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h2><p><code>border-radius</code> æ˜¯ä¸€ä¸ªç®€å†™å±æ€§ï¼Œåˆ†åˆ«è®¾ç½®äº†ï¼š</p>
<ul>
<li>border-top-left-radius</li>
<li>border-top-right-radius</li>
<li>border-bottom-right-radius</li>
<li>border-bottom-left-radius</li>
</ul>
<p>1ã€<code>border-radius</code> å¯ä»¥åˆ†åˆ«æŒ‡å®š1ï¼Œ2ï¼Œ3ï¼Œ4ä¸ªå€¼ï¼Œå€¼çš„ç±»å‹å¯ä»¥æ˜¯ length æˆ–è€… percentageã€‚</p>
<ul>
<li>æŒ‡å®šä¸€ä¸ªå€¼ï¼šå››ä¸ªè§’éƒ½è®¾å®šç›¸åŒçš„åœ†è§’å€¼</li>
<li>æŒ‡å®šä¸¤ä¸ªå€¼ï¼šå‚æ•°ä¸€æŒ‡å®š top-left å’Œ bottom-rightï¼›å‚æ•°äºŒæŒ‡å®š top-right å’Œ bottom-left</li>
<li>æŒ‡å®šä¸‰ä¸ªå€¼ï¼šå‚æ•°ä¸€æŒ‡å®š top-leftï¼›å‚æ•°äºŒæŒ‡å®š top-right å’Œ bottom-leftï¼›å‚æ•°ä¸‰æŒ‡å®š bottom-right</li>
<li>æŒ‡å®šå››ä¸ªå€¼ï¼šå››ä¸ªå‚æ•°åˆ†åˆ«æŒ‡å®š top-leftï¼Œtop-rightï¼Œbottom-rightï¼Œbottom-leftï¼ˆé¡ºæ—¶é’ˆæ–¹å‘ï¼‰</li>
</ul>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/33F068D3-6BC7-4EE1-94BD-1B83632382FA.png" alt=""></p>
<p>2ã€<code>border-radius</code> å¯ä»¥ä¸ºåœ†è§’æŒ‡å®šä¸¤ä¸ªåŠå¾„ï¼Œä¸Šè¿°æˆ‘ä»¬è°ˆåˆ°çš„éƒ½æ˜¯æŒ‡å®šäº†ä¸€ä¸ªåœ†è§’åŠå¾„ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªæ­£åœ†å½¢ï¼›è€ŒæŒ‡å®šä¸¤ä¸ªåŠå¾„ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªæ¤­åœ†å½¢ã€‚ç”¨æ³•æ˜¯é€šè¿‡ä¸€ä¸ªæ–œçº¿åˆ†å‰²å¼€ï¼Œæ–œçº¿å·¦æ–¹æ˜¯ x è½´æ–¹å‘çš„åŠå¾„ï¼Œå³æ–¹æ˜¯ y è½´æ–¹å‘çš„åŠå¾„ã€‚å½“ç„¶ï¼Œæ–œçº¿å·¦å³ä¸¤ä¾§å¯ä»¥åˆ†åˆ«æŒ‡å®š 1ï¼Œ2ï¼Œ3ï¼Œ4 ä¸ªå‚æ•°ï¼Œæ‰€ä»¥æœ‰è¾ƒå¤šçš„ç»„åˆã€‚<br>ä¾‹å¦‚ï¼š<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/D6EBFB3B-41B5-4249-84C6-5F1773F8C480.png" alt=""></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/border-radius" target="_blank" rel="external">MDN border-radius</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;code&gt;border-radius&lt;/code&gt; ç”¨æ¥è®¾ç½®è¾¹æ¡†åœ†è§’ã€‚å½“ä½¿ç”¨ä¸€ä¸ªåŠå¾„æ—¶ç¡®å®šä¸€ä¸ªåœ†å½¢ï¼›å½“ä½¿ç”¨ä¸¤ä¸ªåŠå¾„æ—¶ç¡®å®šä¸€ä¸ªæ¤­åœ†ï¼Œè¿™ä¸ª(æ¤­)åœ†ä¸è¾¹æ¡†çš„äº¤é›†å½¢æˆåœ†è§’æ•ˆæœã€‚&lt;br&gt;&lt;img src=&quot;http://7vikhl.com1.z0.glb.clouddn.com/FC08A931-6DE4-4CE0-A6F8-4F1B523E2007.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;code&gt;border-radius&lt;/code&gt; å±æ€§ï¼Œæˆ‘ä»¬æœ€å¸¸è§å°±æ˜¯è®¾ç½®ä¸€ä¸ªå‚æ•°ï¼š&lt;br&gt;&lt;figure class=&quot;highlight scss&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;1&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;2&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;3&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;border-radius&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;50px&lt;/span&gt;;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// æˆ–è€…&lt;/span&gt;&lt;/div&gt;&lt;div class=&quot;line&quot;&gt;&lt;span class=&quot;attribute&quot;&gt;border-radius&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;50%&lt;/span&gt;;&lt;/div&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è€Œè¿™ç§ç”¨æ³•å…¶å®å°±æ˜¯ä¸ºå››ä¸ªè§’éƒ½æŒ‡å®šäº†ç›¸åŒçš„åœ†è§’åŠå¾„ï¼Œç„¶è€Œå¯¹äº &lt;code&gt;border-radius&lt;/code&gt; å…¶å®æœ‰æ›´åŠ çµæ´»çš„ç”¨æ³•ï¼Œå¯ä»¥åˆ†åˆ«è®¾ç½®å››ä¸ªè§’ä¸åŒçš„åœ†è§’æ•ˆæœã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="CSS" scheme="http://objcer.com/categories/CSS/"/>
    
    
      <category term="border-radius" scheme="http://objcer.com/tags/border-radius/"/>
    
  </entry>
  
  <entry>
    <title>å…³äº &#39;void 0&#39; å’Œ &#39;javascript:void(0)&#39;â“</title>
    <link href="http://objcer.com/2017/03/12/What-does-void-0-mean/"/>
    <id>http://objcer.com/2017/03/12/What-does-void-0-mean/</id>
    <published>2017-03-11T16:55:34.000Z</published>
    <updated>2017-03-11T16:57:48.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ–è®¸æˆ‘ä»¬éƒ½åœ¨ä»£ç ä¸­è§åˆ°è¿‡ <code>void 0</code> å’Œ <code>javascript:void(0)</code>ï¼Œè¿™ä¸¤ä¸ªåˆ°åº•æ˜¯ä»€ä¹ˆå«ä¹‰å‘¢ï¼Ÿ<br><a id="more"></a></p>
<h2 id="void-0"><a href="#void-0" class="headerlink" title="void 0"></a><code>void 0</code></h2><p><code>void</code> è¿ç®—ç¬¦ä¼šå¯¹ç»™å®šçš„è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼ï¼Œç„¶åç›´æ¥è¿”å› undefinedã€‚<br><em>è¯­æ³•ï¼š</em><br><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> expression</div></pre></td></tr></table></figure></p>
<p><em>ä¾‹å¦‚ï¼š</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">void</span> <span class="number">0</span></div><div class="line"><span class="keyword">void</span> (<span class="number">0</span>)</div><div class="line"><span class="keyword">void</span> <span class="string">"hello"</span></div><div class="line"><span class="keyword">void</span> (<span class="keyword">new</span> <span class="built_in">Date</span>())</div><div class="line"><span class="comment">//all will return undefined</span></div></pre></td></tr></table></figure></p>
<p>è¿™ä¼¼ä¹çœ‹èµ·æ¥æ²¡æœ‰ä»€ä¹ˆç”¨å¤„ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬éœ€è¦è¿”å› <code>undefined</code>ï¼Œé‚£æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ <code>undefined</code> å°±å¥½äº†å˜›ã€‚</p>
<blockquote>
<p>The global undefined property represents the primitive value undefined. It is one of JavaScriptâ€™s primitive types.</p>
</blockquote>
<p>æ²¡é”™ï¼Œå¯¹äºæ­£å¸¸æƒ…å†µä¸‹ï¼Œç›´æ¥ä½¿ç”¨ <code>undefined</code> æ¯” <code>void 0</code> æ›´åŠ ç®€å•è€Œä¸”æµ…æ˜¾æ˜“æ‡‚ï¼›ä½†æ˜¯åœ¨ JavaScript ä¸­æœ‰ä¸€ç‚¹æ¯”è¾ƒç‰¹æ®Šï¼š<code>undefined</code> å¹¶ä¸æ˜¯ä¿ç•™å…³é”®å­—ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªå…¨å±€å±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>undefined</code> åªæ˜¯ä¸€ä¸ªå˜é‡åè€Œå·²ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹å®ƒè¿›è¡Œèµ‹å€¼ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">alert(<span class="built_in">window</span>.hasOwnProperty(<span class="string">'undefined'</span>)); <span class="comment">// alerts "true"</span></div><div class="line"></div><div class="line">alert(<span class="literal">undefined</span>); <span class="comment">//alerts "undefined"</span></div><div class="line"><span class="keyword">var</span> <span class="literal">undefined</span> = <span class="string">"new value"</span>;</div><div class="line">alert(<span class="literal">undefined</span>) <span class="comment">// alerts "new value"</span></div></pre></td></tr></table></figure></p>
<p>æ³¨æ„ï¼šè¿™ç§æƒ…å†µå·²ç»å¾—åˆ°æ”¹å–„äº†ï¼Œç°ä»£æµè§ˆå™¨ä¸­ï¼Œ<code>undefined</code> ä½œä¸ºå…¨å±€å±æ€§åªæ˜¯å¯è¯»ï¼ˆread-onlyï¼‰ï¼Œä½†æ˜¯åœ¨å±€éƒ¨ä½œç”¨åŸŸä¸­ï¼Œè¿˜æ˜¯å¯ä»¥å¯¹å…¶è¿›è¡Œå†èµ‹å€¼ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> <span class="literal">undefined</span> = <span class="string">'hello'</span>;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'---'</span>, <span class="literal">undefined</span>) <span class="comment">// --- hello</span></div><div class="line">&#125;</div><div class="line">test();</div></pre></td></tr></table></figure></p>
<p>ç”±äº <code>undefined</code> å€¼å¯èƒ½å¹¶ä¸æ˜¯ <code>undefined</code> çš„é—®é¢˜ï¼Œæ‰€ä»¥ <code>void 0</code> å°±å‡¸æ˜¾ä½œç”¨äº†ï¼Œ<code>void 0</code> ä½¿ç”¨è¿”å› <code>undefined</code></p>
<p>é‚£ä¹ˆä¸ºä»€ä¹ˆä¼šæ˜¯ <code>void 0</code> å‘¢ï¼Ÿèƒ½ä¸èƒ½æ˜¯ <code>void 100</code>ï¼Œ<code>void 200</code>ï¼Œ<code>void &quot;hello&quot;</code> è¿™äº›å‘¢ï¼Ÿå½“ç„¶ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå¦‚æœä½ å–œæ¬¢çš„è¯ï¼Œä½¿ç”¨ <code>void 0</code> çš„å¥½å¤„æ˜¯ 0 ç®€çŸ­ä¸”ç¬¦åˆç¼–ç¨‹è¯­è¨€ä¹ æƒ¯ã€‚</p>
<h2 id="javascript-void-0"><a href="#javascript-void-0" class="headerlink" title="javascript:void(0)"></a><code>javascript:void(0)</code></h2><p>åœ¨ <code>a</code> æ ‡ç­¾ï¼ˆè¶…é“¾æ¥ï¼‰ä¸­ï¼Œæˆ‘ä»¬å¯èƒ½ç»å¸¸ä¼šé‡åˆ°è¿™ç§æƒ…å†µï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(0);"</span> &gt;</span>test<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>å½“ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªä»¥ javascript: URI æ—¶ï¼Œæµè§ˆå™¨ä¼šå¯¹å†’å·åé¢çš„ä»£ç è¿›è¡Œæ±‚å€¼ï¼Œä¾‹å¦‚ï¼š<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"javascript:void(document.body.style.backgroundColor='green');"</span>&gt;</span></div><div class="line">  ç‚¹å‡»è¿™ä¸ªé“¾æ¥ä¼šè®©é¡µé¢èƒŒæ™¯å˜æˆç»¿è‰²ã€‚</div><div class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>è€Œ <code>void(0)</code> å§‹ç»ˆè¿”å›  <code>undefined</code>ï¼Œæ‰€ä»¥ <code>&lt;a href=&quot;javascript:void(0);&quot; &gt;test&lt;/a&gt;</code> å°±åˆ›å»ºäº†ä¸€ä¸ªæ­»è¶…é“¾æ¥ï¼Œç‚¹å‡»åï¼Œä¸ä¼šå‘ç”Ÿä»»ä½•äº‹æƒ…ã€‚</p>
<p><strong>æ³¨æ„</strong>ï¼Œè™½ç„¶è¿™ä¹ˆåšæ˜¯å¯è¡Œçš„ï¼Œä½†åˆ©ç”¨ javascript: ä¼ªåè®®æ¥æ‰§è¡Œ JavaScript ä»£ç æ˜¯ä¸æ¨èçš„ã€‚</p>
<p>å¦‚æœæƒ³è¦ä¸€ä¸ªé“¾æ¥ç‚¹å‡»åä¸åšä»»ä½•äº‹æƒ…ï¼Œæˆ–è€…å“åº”ç‚¹å‡»è€Œå®Œæˆå…¶ä»–äº‹æƒ…ï¼Œå¯ä»¥è®¾ç½®å…¶å±æ€§ href = â€œ#â€ï¼Œç„¶åç»‘å®š <code>onclick</code> äº‹ä»¶ï¼Œè¿™æ ·ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“é¡µé¢æœ‰æ»šåŠ¨æ¡æ—¶ï¼Œç‚¹å‡»åä¼šè¿”å›åˆ°é¡µé¢é¡¶ç«¯ï¼Œç”¨æˆ·ä½“éªŒä¸å¥½ï¼›å½“ç„¶æœ‰è§£å†³æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ <code>onclick</code> äº‹ä»¶ä¸­è¿”å› <code>false</code> å³å¯ã€‚<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">a</span> href=<span class="string">"#"</span> onclick=<span class="string">"return false;"</span>&gt;test&lt;/<span class="keyword">a</span>&gt;<span class="comment"></span></div><div class="line">// ç­‰ä»·äº</div><div class="line">&lt;<span class="keyword">a</span> href=<span class="string">"javascript:void(0);"</span> &gt;test&lt;/<span class="keyword">a</span>&gt;</div></pre></td></tr></table></figure></p>
<p><code>href=&quot;javascript:void(0)&quot;</code> ä¸ <code>href=&quot;#&quot;</code> çš„åŒºåˆ«ï¼š</p>
<ul>
<li><code>javascript:void(0)</code> ä»…ä»…è¡¨ç¤ºä¸€ä¸ªæ­»é“¾æ¥ã€‚</li>
<li><code>#</code> åŒ…å«äº†ä¸€ä¸ªä½ç½®ä¿¡æ¯ï¼Œé»˜è®¤çš„é”šæ˜¯ <code>#top</code>ï¼Œä¹Ÿå°±æ˜¯ç½‘é¡µçš„ä¸Šç«¯ã€‚åœ¨é¡µé¢å¾ˆé•¿çš„æ—¶å€™ä¼šä½¿ç”¨ <code>#</code> æ¥å®šä½é¡µé¢çš„å…·ä½“ä½ç½®ï¼Œæ ¼å¼ä¸ºï¼š<code># + id</code>ã€‚</li>
</ul>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://stackoverflow.com/questions/7452341/what-does-void-0-mean" target="_blank" rel="external">What does â€˜void 0â€™ mean?</a><br><a href="http://stackoverflow.com/questions/1291942/what-does-javascriptvoid0-mean" target="_blank" rel="external">What does â€˜javascript:void(0)â€™ mean?</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ–è®¸æˆ‘ä»¬éƒ½åœ¨ä»£ç ä¸­è§åˆ°è¿‡ &lt;code&gt;void 0&lt;/code&gt; å’Œ &lt;code&gt;javascript:void(0)&lt;/code&gt;ï¼Œè¿™ä¸¤ä¸ªåˆ°åº•æ˜¯ä»€ä¹ˆå«ä¹‰å‘¢ï¼Ÿ&lt;br&gt;
    
    </summary>
    
      <category term="JS" scheme="http://objcer.com/categories/JS/"/>
    
    
      <category term="void 0" scheme="http://objcer.com/tags/void-0/"/>
    
      <category term="javascript:void(0)" scheme="http://objcer.com/tags/javascript-void-0/"/>
    
  </entry>
  
  <entry>
    <title>å®ç° map, reduce, filter, find æ–¹æ³•</title>
    <link href="http://objcer.com/2017/03/11/implement-the-array-map-reduce-filter-find-method/"/>
    <id>http://objcer.com/2017/03/11/implement-the-array-map-reduce-filter-find-method/</id>
    <published>2017-03-11T08:22:26.000Z</published>
    <updated>2017-03-17T15:07:38.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨å¯¹æ•°ç»„è¿›è¡Œæ“ä½œä¸­ï¼Œæœ€å¸¸é‡åˆ°çš„æ“ä½œå°±æ˜¯éå†æ•°ç»„ï¼Œè¿›è¡Œç›¸å…³çš„æ•°æ®å¤„ç†ï¼Œæœ€ç®€å•çš„åšæ³•æ˜¯ä½¿ç”¨å¾ªç¯ï¼Œ<code>for</code> æˆ–è€… <code>while</code>ï¼Œç„¶è€Œè¿™æ ·çš„å†™æ³•å¹¶ä¸ç®—æ˜¯æœ€ä½³çš„ï¼ˆ<a href="http://jrsinclair.com/articles/2017/javascript-without-loops/" target="_blank" rel="external">JAVASCRIPT WITHOUT LOOPS</a>ï¼‰ï¼›åœ¨ JavaScript ä¸­ï¼Œæä¾›äº† <code>map</code>ï¼Œ<code>reduce</code>ï¼Œ<code>reduceRight</code>ï¼Œ<code>filter</code>ï¼Œ<code>find</code> ç­‰æ–¹æ³•æ›´åŠ çµæ´»çš„å®ç°å¯¹æ•°ç»„æ•°æ®çš„æ“ä½œã€‚</p>
<p>æœ¬æ–‡å°†å¯¹ <code>map</code>ï¼Œ<code>reduce</code>ï¼Œ<code>reduceRight</code>ï¼Œ<code>filter</code>ï¼Œ<code>find</code> æ–¹æ³•çš„ç”¨æ³•è¿›è¡Œç®€å•ä»‹ç»ï¼Œå¹¶å„è‡ªæ‰‹åŠ¨å¯¹å…¶å®ç°ã€‚å…¶ä¸­å¤§éƒ¨åˆ†å†…å®¹éƒ½æ˜¯é˜…è¯»å‚è€ƒ MDN æ–‡æ¡£è€Œæ¥ã€‚</p>
<a id="more"></a>
<h2 id="map"><a href="#map" class="headerlink" title="map"></a><code>map</code></h2><p><code>map</code> æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„ï¼Œå…¶ç»“æœæ˜¯è¯¥æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ è°ƒç”¨ä¸€ä¸ªæä¾›çš„å›è°ƒå‡½æ•°ã€‚<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="keyword">new</span><span class="type">_array</span> = arr.map(callback[, thisArg])</div></pre></td></tr></table></figure></p>
<ul>
<li><code>callback</code>: ä½¿ç”¨ä¸‰ä¸ªå‚æ•° <code>currentValue</code>, <code>index</code>, <code>array</code></li>
<li><code>thisArg</code>: å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šæ‰§è¡Œ <code>callback</code> æ—¶çš„ <code>this</code> å€¼</li>
</ul>
<p>æ‰‹åŠ¨å®ç°è¯¥æ–¹æ³•ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.prototype._map = <span class="function"><span class="keyword">function</span>(<span class="params">callback <span class="regexp">/*, thisArg*/</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == <span class="literal">null</span>) &#123;</div><div class="line">        <span class="comment">// undefined == null</span></div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'null or undefined'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> callback !== <span class="string">'function'</span>) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'callback is not a function'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> oldArr = <span class="built_in">Object</span>(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">var</span> len = oldArr.length &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line">    <span class="comment">// or: var len = +oldArr.length || 0;</span></div><div class="line">    <span class="keyword">var</span> thisArg;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">arguments</span>.length &gt; <span class="number">1</span>) &#123;</div><div class="line">        thisArg = <span class="built_in">arguments</span>[<span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> newArr = <span class="keyword">new</span> <span class="built_in">Array</span>(len);</div><div class="line">    <span class="keyword">var</span> k = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (k &lt; len) &#123;</div><div class="line">        <span class="keyword">if</span> (k <span class="keyword">in</span> oldArr) &#123;</div><div class="line">            newArr[k] = callback.call(thisArg, oldArr[k], k, oldArr);</div><div class="line">        &#125;</div><div class="line">        k ++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> newArr;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line">array._map(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'-'</span>, value, <span class="string">'-'</span>, index, <span class="string">'-'</span>, arr);</div><div class="line">    <span class="keyword">return</span> value * <span class="number">2</span>;</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p><strong>ğŸ“Œæ³¨æ„</strong><br>1ã€åœ¨ä¸Šè¿°çš„ä»£ç ä¸­æˆ‘ä»¬æ³¨æ„åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> t = <span class="built_in">Object</span>(<span class="keyword">this</span>);</div><div class="line"><span class="keyword">var</span> len = t.length &gt;&gt;&gt; <span class="number">0</span>;</div></pre></td></tr></table></figure></p>
<p>å…¶ä¸­ <code>t.length &gt;&gt;&gt; 0</code> æ˜¯ä»€ä¹ˆç”¨æ³•å‘¢ï¼Ÿ</p>
<p><code>&gt;&gt;&gt;</code>: æ— ç¬¦å·å³ç§»ä½èµ‹å€¼(Unsigned right shift assignment)<br><code>t.length &gt;&gt;&gt; 0</code> æ­¤å¤„çš„ä½œç”¨æ˜¯ï¼Œå¯ä»¥å°†ä¸€ä¸ª non-Number è½¬æ¢æˆ non-negative Number.</p>
<p>å¯¹äº <code>var t = Object(this);</code> å¦‚æœ <code>this</code> ä¸º <code>null</code> æˆ–è€… <code>undefined</code>ï¼Œé‚£ä¹ˆè¿”å›çš„å°±æ˜¯ä¸€ä¸ªç©ºçš„å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™æ—¶ <code>t.length</code> è·å–å¯¹è±¡çš„ <code>length</code> å±æ€§å°±ä¼šè¿”å› <code>undefined</code>ï¼›è€Œ <code>t.length &gt;&gt;&gt; 0</code> å°±æ˜¯ä¸ºäº†çº æ­£è¿™ä¸ªæ½œåœ¨çš„é—®é¢˜ã€‚</p>
<p>å…¶å®äº†è§£äº†ä¸ºå•¥éœ€è¦ <code>t.length &gt;&gt;&gt; 0</code> çš„åŸå› åï¼Œæˆ‘ä»¬å…¶ä»–å¯ä»¥æ¢ä¸€ç§æ›´æµ…æ˜¾æ˜“æ‡‚çš„è§£å†³æ–¹å¼ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// Cast this.length to a number, or <span class="keyword">use</span> <span class="number">0</span> <span class="keyword">if</span> this.length <span class="keyword">is</span></div><div class="line">// <span class="keyword">NaN</span>/undefined (evaluates <span class="keyword">to</span> <span class="literal">false</span>)</div><div class="line"><span class="keyword">var</span> <span class="keyword">len</span> = +this.length || <span class="number">0</span>;</div></pre></td></tr></table></figure></p>
<p><em>å‚è€ƒé“¾æ¥ï¼š</em><br><a href="http://stackoverflow.com/questions/5969124/why-are-the-mdc-prototype-functions-written-this-way" target="_blank" rel="external">why-are-the-mdc-prototype-functions-written-this-way</a><br><a href="http://stackoverflow.com/questions/1822350/what-is-the-javascript-operator-and-how-do-you-use-it" target="_blank" rel="external">what-is-the-javascript-operator-and-how-do-you-use-it</a></p>
<p>2ã€ä¸ºå¯¹è±¡æ·»åŠ æ–¹æ³•æœ‰ä¸¤ç§æ–¹å¼ï¼Œæ­¤å¤„æ˜¯ç›´æ¥åœ¨æ•°ç»„çš„åŸå‹(<code>Array.prototype</code>)ä¸­æ·»åŠ æ–¹æ³•ï¼›è¿˜æœ‰å¦ä¸€ç§æ–¹å¼ï¼šé€šè¿‡ <code>Object.defineProperty</code> ä¸ºå¯¹è±¡å®šä¹‰ä¸€ä¸ªæ–¹æ³•ã€‚å»ºè®®ä½¿ç”¨åè€…ï¼Œå› ä¸ºç›´æ¥åœ¨åŸå‹ä¸­æ·»åŠ æ–¹æ³•ï¼Œä¼šæœ‰ä¸€ä¸ªç¼ºé™·å°±æ˜¯ï¼Œæ·»åŠ çš„æ–¹æ³•æ˜¯å¯æšä¸¾çš„ï¼Œè€Œé€šè¿‡ <code>Object.defineProperty</code> å¯ä»¥é…ç½®æ–¹æ³•çš„å¯æšä¸¾å±æ€§ã€‚</p>
<h2 id="reduce-å’Œ-reduceRight"><a href="#reduce-å’Œ-reduceRight" class="headerlink" title="reduce å’Œ reduceRight"></a><code>reduce</code> å’Œ <code>reduceRight</code></h2><p>1ã€<code>reduce</code> æ–¹æ³•å¯¹ç´¯åŠ å™¨å’Œæ•°ç»„çš„æ¯ä¸ªå€¼ (ä»å·¦åˆ°å³)åº”ç”¨ä¸€ä¸ªå‡½æ•°ï¼Œä»¥å°†å…¶å‡å°‘ä¸ºå•ä¸ªå€¼ã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">arr</span><span class="selector-class">.reduce</span>(<span class="selector-tag">callback</span><span class="selector-attr">[, initialValue]</span>)</div></pre></td></tr></table></figure></p>
<ul>
<li><code>callback</code>: ä½¿ç”¨å››ä¸ªå‚æ•° <code>accumulator</code>, <code>currentValue</code>, <code>currentIndex</code>, <code>array</code></li>
<li><code>initialValue</code>: å¯é€‰å‚æ•°</li>
</ul>
<p>ä¾‹å­ï¼šæ•°ç»„æ±‚å’Œ<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var sum = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>].reduce((acc, cur) =&gt; acc + cur, <span class="number">0</span>) <span class="comment">// 10</span></div></pre></td></tr></table></figure></p>
<p>æ‰‹åŠ¨å®ç°è¯¥æ–¹æ³•ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.prototype._reduce = <span class="function"><span class="keyword">function</span>(<span class="params">callback <span class="regexp">/*, initialValue*/</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == <span class="literal">null</span>) &#123;</div><div class="line">        <span class="comment">// undefined == null</span></div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'null or undefined'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> callback !== <span class="string">'function'</span>) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'callback is not a function'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> oldArr = <span class="built_in">Object</span>(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">var</span> len = oldArr.length &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> initialValue, k=<span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(<span class="built_in">arguments</span>.length &gt;= <span class="number">2</span>) &#123;</div><div class="line">        initialValue = <span class="built_in">arguments</span>[<span class="number">1</span>];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">while</span>(k &lt; len &amp;&amp; !(k <span class="keyword">in</span> oldArr)) k++;</div><div class="line">        <span class="keyword">if</span>(k &gt;= len) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>( <span class="string">'Reduce of empty array '</span> +</div><div class="line">            <span class="string">'with no initial value'</span> );</div><div class="line">        &#125;</div><div class="line">        initialValue = oldArr[k++];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(k &lt; len) &#123;</div><div class="line">        <span class="keyword">if</span>(k <span class="keyword">in</span> oldArr) &#123;</div><div class="line">            initialValue = callback(initialValue, oldArr[k], k, oldArr);</div><div class="line">        &#125;</div><div class="line">        k++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> initialValue;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line"><span class="comment">// var array = []</span></div><div class="line">array._reduce(<span class="function"><span class="keyword">function</span>(<span class="params">acc, cur, index, arr</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'-'</span>, acc, <span class="string">'-'</span>, cur, <span class="string">'-'</span>, index);</div><div class="line">    <span class="keyword">return</span> acc + cur;</div><div class="line">&#125;, <span class="number">100</span>)</div></pre></td></tr></table></figure></p>
<p>2ã€<code>reduceRight</code> æ–¹æ³•å’Œ <code>reduce</code> ç±»ä¼¼ï¼Œåªä¸è¿‡éå†å€¼çš„é¡ºåºå’Œ <code>reduce</code> æ–¹æ³•ç›¸åï¼Œä»å³å‘å·¦ã€‚</p>
<p>æ‰‹åŠ¨å®ç°è¯¥æ–¹æ³•ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.prototype._reduceRight = <span class="function"><span class="keyword">function</span>(<span class="params">callback <span class="regexp">/*, initialValue*/</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == <span class="literal">null</span>) &#123;</div><div class="line">        <span class="comment">// undefined == null</span></div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'null or undefined'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> callback !== <span class="string">'function'</span>) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'callback is not a function'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> oldArr = <span class="built_in">Object</span>(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">var</span> len = oldArr.length &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> initialValue, k = len - <span class="number">1</span>;</div><div class="line"></div><div class="line">    <span class="keyword">if</span>(<span class="built_in">arguments</span>.length &gt;= <span class="number">2</span>) &#123;</div><div class="line">        initialValue = <span class="built_in">arguments</span>[<span class="number">1</span>];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">while</span>(k &gt;= <span class="number">0</span> &amp;&amp; !(k <span class="keyword">in</span> oldArr)) k--;</div><div class="line">        <span class="keyword">if</span>(k &lt; <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>( <span class="string">'Reduce of empty array '</span> +</div><div class="line">            <span class="string">'with no initial value'</span> );</div><div class="line">        &#125;</div><div class="line">        initialValue = oldArr[k--];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">while</span>(k &gt;= <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">if</span>(k <span class="keyword">in</span> oldArr) &#123;</div><div class="line">            initialValue = callback(initialValue, oldArr[k], k, oldArr);</div><div class="line">        &#125;</div><div class="line">        k--;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> initialValue;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line"><span class="comment">// var array = []</span></div><div class="line">array._reduceRight(<span class="function"><span class="keyword">function</span>(<span class="params">acc, cur, index, arr</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'-'</span>, acc, <span class="string">'-'</span>, cur, <span class="string">'-'</span>, index);</div><div class="line">    <span class="keyword">return</span> acc + cur;</div><div class="line">&#125;, <span class="number">100</span>)</div></pre></td></tr></table></figure></p>
<h2 id="filter"><a href="#filter" class="headerlink" title="filter"></a><code>filter</code></h2><p><code>filter</code> æ–¹æ³•ä½¿ç”¨æŒ‡å®šçš„å‡½æ•°æµ‹è¯•æ‰€æœ‰å…ƒç´ ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰é€šè¿‡æµ‹è¯•çš„å…ƒç´ çš„æ–°æ•°ç»„ã€‚<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="keyword">new</span><span class="type">_arrary</span> = arr.filter(callback[, thisArg])</div></pre></td></tr></table></figure></p>
<ul>
<li><code>callback</code>: ä½¿ç”¨ä¸‰ä¸ªå‚æ•° <code>currentValue</code>, <code>index</code>, <code>array</code>ï¼Œè¿”å› <code>true</code> è¡¨ç¤ºä¿ç•™è¯¥å€¼ï¼Œ<code>false</code> è¡¨ç¤ºæ’é™¤è¯¥å€¼</li>
<li><code>thisArg</code>: å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šæ‰§è¡Œ <code>callback</code> æ—¶çš„ <code>this</code> å€¼</li>
</ul>
<p>æ‰‹åŠ¨å®ç°è¯¥æ–¹æ³•ï¼š<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Array</span>.prototype._filter = <span class="function"><span class="keyword">function</span></span>(callback <span class="comment">/*, thisArg*/</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">this</span> == <span class="literal">null</span>) &#123;</div><div class="line">        <span class="comment">// undefined == null</span></div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">TypeError</span>(<span class="string">'null or undefined'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (typeof callback !== <span class="string">'function'</span>) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="type">TypeError</span>(<span class="string">'callback is not a function'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> oldArr = Object(<span class="built_in">this</span>);</div><div class="line">    <span class="keyword">var</span> len = oldArr.length &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> <span class="keyword">new</span><span class="type">Arr</span> = [];</div><div class="line">    <span class="keyword">var</span> thisArg = arguments.length &gt;= <span class="number">2</span> ? arguments[<span class="number">1</span>] : <span class="type">void 0</span>;</div><div class="line">    <span class="keyword">var</span> k = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(k &lt; len) &#123;</div><div class="line">        <span class="keyword">if</span>(k <span class="keyword">in</span> oldArr) &#123;</div><div class="line">            <span class="keyword">var</span> val = oldArr[k];</div><div class="line">            <span class="keyword">if</span>(callback.call(thisArg, val, k, oldArr)) &#123;</div><div class="line">                <span class="keyword">new</span><span class="type">Arr</span>.push(val);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        k++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span><span class="type">Arr</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="find"><a href="#find" class="headerlink" title="find"></a><code>find</code></h2><p><code>find</code> æ–¹æ³•è¿”å›æ•°ç»„ä¸­æ»¡è¶³æä¾›çš„æµ‹è¯•å‡½æ•°çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼ã€‚å¦åˆ™è¿”å› undefinedã€‚<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">arr</span><span class="selector-class">.find</span>(<span class="selector-tag">callback</span><span class="selector-attr">[, thisArg]</span>)</div></pre></td></tr></table></figure></p>
<ul>
<li><code>callback</code>: ä½¿ç”¨ä¸‰ä¸ªå‚æ•° <code>currentValue</code>, <code>index</code>, <code>array</code></li>
<li><code>thisArg</code>: å¯é€‰å‚æ•°ï¼ŒæŒ‡å®šæ‰§è¡Œ <code>callback</code> æ—¶çš„ <code>this</code> å€¼</li>
</ul>
<p>æ‰‹åŠ¨å®ç°è¯¥æ–¹æ³•ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.prototype._find = <span class="function"><span class="keyword">function</span>(<span class="params">callback <span class="regexp">/*, thisArg*/</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> == <span class="literal">null</span>) &#123;</div><div class="line">        <span class="comment">// undefined == null</span></div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'null or undefined'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> callback !== <span class="string">'function'</span>) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'callback is not a function'</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> oldArr = <span class="built_in">Object</span>(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">var</span> len = oldArr.length &gt;&gt;&gt; <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> thisArg = <span class="built_in">arguments</span>.length &gt;= <span class="number">2</span> ? <span class="built_in">arguments</span>[<span class="number">1</span>] : <span class="keyword">void</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">var</span> k = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(k &lt; len) &#123;</div><div class="line">        <span class="keyword">if</span>(k <span class="keyword">in</span> oldArr) &#123;</div><div class="line">            <span class="keyword">var</span> val = oldArr[k];</div><div class="line">            <span class="keyword">if</span>(callback.call(thisArg, val, k, oldArr)) &#123;</div><div class="line">                <span class="keyword">return</span> val;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        k++;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<blockquote>
<p>å…¶ä¸­ <code>void 0</code> å¯å‚è€ƒ: <a href="http://objcer.com/2017/03/12/What-does-void-0-mean/">å…³äº â€˜void 0â€™ å’Œ â€˜javascript:void(0)â€™â“</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨å¯¹æ•°ç»„è¿›è¡Œæ“ä½œä¸­ï¼Œæœ€å¸¸é‡åˆ°çš„æ“ä½œå°±æ˜¯éå†æ•°ç»„ï¼Œè¿›è¡Œç›¸å…³çš„æ•°æ®å¤„ç†ï¼Œæœ€ç®€å•çš„åšæ³•æ˜¯ä½¿ç”¨å¾ªç¯ï¼Œ&lt;code&gt;for&lt;/code&gt; æˆ–è€… &lt;code&gt;while&lt;/code&gt;ï¼Œç„¶è€Œè¿™æ ·çš„å†™æ³•å¹¶ä¸ç®—æ˜¯æœ€ä½³çš„ï¼ˆ&lt;a href=&quot;http://jrsinclair.com/articles/2017/javascript-without-loops/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;JAVASCRIPT WITHOUT LOOPS&lt;/a&gt;ï¼‰ï¼›åœ¨ JavaScript ä¸­ï¼Œæä¾›äº† &lt;code&gt;map&lt;/code&gt;ï¼Œ&lt;code&gt;reduce&lt;/code&gt;ï¼Œ&lt;code&gt;reduceRight&lt;/code&gt;ï¼Œ&lt;code&gt;filter&lt;/code&gt;ï¼Œ&lt;code&gt;find&lt;/code&gt; ç­‰æ–¹æ³•æ›´åŠ çµæ´»çš„å®ç°å¯¹æ•°ç»„æ•°æ®çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†å¯¹ &lt;code&gt;map&lt;/code&gt;ï¼Œ&lt;code&gt;reduce&lt;/code&gt;ï¼Œ&lt;code&gt;reduceRight&lt;/code&gt;ï¼Œ&lt;code&gt;filter&lt;/code&gt;ï¼Œ&lt;code&gt;find&lt;/code&gt; æ–¹æ³•çš„ç”¨æ³•è¿›è¡Œç®€å•ä»‹ç»ï¼Œå¹¶å„è‡ªæ‰‹åŠ¨å¯¹å…¶å®ç°ã€‚å…¶ä¸­å¤§éƒ¨åˆ†å†…å®¹éƒ½æ˜¯é˜…è¯»å‚è€ƒ MDN æ–‡æ¡£è€Œæ¥ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="JS" scheme="http://objcer.com/categories/JS/"/>
    
    
      <category term="map" scheme="http://objcer.com/tags/map/"/>
    
      <category term="reduce" scheme="http://objcer.com/tags/reduce/"/>
    
      <category term="filter" scheme="http://objcer.com/tags/filter/"/>
    
      <category term="find" scheme="http://objcer.com/tags/find/"/>
    
  </entry>
  
</feed>
