<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Push Notification," />





  <link rel="alternate" href="/atom.xml" title="Deng's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.0.2" />






<meta name="keywords" content="Push Notification">
<meta property="og:type" content="article">
<meta property="og:title" content="Cordova è¿œç¨‹æ¨é€ - iOSç¯‡">
<meta property="og:url" content="http://objcer.com/2017/06/04/cordova-register-and-receive-push-notifications-iOS/index.html">
<meta property="og:site_name" content="Deng&#39;s Blog">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/iOS-PUsh-Notifications.png">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/82BDFC5F-339D-4402-8719-5197D0246305.png">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/Managing%20the%20device%20token.png">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/Remote%20notification%20path%20from%20provider%20to%20device.png">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/apns-app.png">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/CreateCertificate.png">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/aps.png">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/capabilities.jpg">
<meta property="og:image" content="http://7vikhl.com1.z0.glb.clouddn.com/build-settings.jpg">
<meta property="og:updated_time" content="2017-06-03T17:05:32.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cordova è¿œç¨‹æ¨é€ - iOSç¯‡">
<meta name="twitter:image" content="http://7vikhl.com1.z0.glb.clouddn.com/iOS-PUsh-Notifications.png">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    }
  };
</script>




  <link rel="canonical" href="http://objcer.com/2017/06/04/cordova-register-and-receive-push-notifications-iOS/"/>


  <title> Cordova è¿œç¨‹æ¨é€ - iOSç¯‡ | Deng's Blog </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Deng's Blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Work Smart, Enjoy Life!</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Cordova è¿œç¨‹æ¨é€ - iOSç¯‡
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2017-06-04T01:03:12+08:00" content="2017-06-04">
              2017-06-04
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Cordova/" itemprop="url" rel="index">
                    <span itemprop="name">Cordova</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2017/06/04/cordova-register-and-receive-push-notifications-iOS/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/06/04/cordova-register-and-receive-push-notifications-iOS/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/06/04/cordova-register-and-receive-push-notifications-iOS/" class="leancloud_visitors" data-flag-title="Cordova è¿œç¨‹æ¨é€ - iOSç¯‡">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•° </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="http://7vikhl.com1.z0.glb.clouddn.com/iOS-PUsh-Notifications.png" alt=""></p>
<a id="more"></a>
<h2 id="APNs"><a href="#APNs" class="headerlink" title="APNs"></a>APNs</h2><blockquote>
<p>APNs(<em>Apple Push Notification service</em>) <a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/APNSOverview.html#//apple_ref/doc/uid/TP40008194-CH8-SW1" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£ Overview</a></p>
</blockquote>
<h3 id="æ¨é€åŸç†"><a href="#æ¨é€åŸç†" class="headerlink" title="æ¨é€åŸç†"></a>æ¨é€åŸç†</h3><p>å½“ Provider è¿œç¨‹æœåŠ¡å™¨éœ€è¦å‘ App æ¨é€ä¸€æ¡æ¶ˆæ¯æ—¶ï¼Œå¹¶ä¸æ˜¯ç›´æ¥å¾€ App æ¨é€æ¶ˆæ¯ï¼Œè€Œæ˜¯æ¨é€è‹¹æœ APNs æœåŠ¡å™¨ä¸Šï¼Œè€Œè‹¹æœçš„ APNs æœåŠ¡å™¨å†é€šè¿‡ä¸è®¾å¤‡å»ºç«‹é•¿è¿æ¥è¿›è€ŒæŠŠæ¶ˆæ¯æ¨é€åˆ°æˆ‘ä»¬çš„è®¾å¤‡ä¸Šã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/82BDFC5F-339D-4402-8719-5197D0246305.png" alt=""></p>
<p>ç”±æ­¤ï¼šAPNs æ¨é€å°±åˆ’åˆ†æˆä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li>Provider-to-APNs connection (æœåŠ¡ç«¯äº¤äº’)</li>
<li>APNs-to-device connection (å®¢æˆ·ç«¯äº¤äº’)</li>
</ul>
<h3 id="deviceToken"><a href="#deviceToken" class="headerlink" title="deviceToken"></a>deviceToken</h3><p>1ã€å½“ä¸€ä¸ª App æ³¨å†Œæ¥æ”¶è¿œç¨‹é€šçŸ¥æ—¶ï¼Œç³»ç»Ÿä¼šå‘é€è¯·æ±‚åˆ° APNs æœåŠ¡å™¨ï¼ŒAPNs æœåŠ¡å™¨æ”¶åˆ°æ­¤è¯·æ±‚ä¼šç”Ÿæˆä¸€ä¸ª<strong>ç‹¬ä¸€æ— äºŒ</strong>çš„ deviceTokenï¼Œå‘é€åˆ°å¯¹åº”è¯·æ±‚çš„ App ä¸Šã€‚ç„¶å App æŠŠæ­¤ deviceToken å‘é€ç»™æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨ Providerã€‚</p>
<blockquote>
<p>â—ï¸ä¸€ä¸ª deviceToken å¯ä»¥å”¯ä¸€æ ‡è¯†æŸä¸ªè®¾å¤‡ä¸Šçš„æŸä¸ª Appï¼Œå¯ä»¥ç†è§£æˆï¼š<strong>deviceToken = device UUID + App Bundle ID</strong></p>
</blockquote>
<p><img src="http://7vikhl.com1.z0.glb.clouddn.com/Managing%20the%20device%20token.png" alt=""></p>
<p>2ã€Provider ç»™æˆ‘ä»¬çš„è®¾å¤‡æ¨é€é€šçŸ¥çš„æ—¶å€™ï¼Œå¿…é¡»åŒ…å«æ­¤ deviceTokenã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/Remote%20notification%20path%20from%20provider%20to%20device.png" alt=""></p>
<h3 id="æ¨é€æ¶ˆæ¯-Payload"><a href="#æ¨é€æ¶ˆæ¯-Payload" class="headerlink" title="æ¨é€æ¶ˆæ¯ Payload"></a>æ¨é€æ¶ˆæ¯ Payload</h3><blockquote>
<p><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CreatingtheNotificationPayload.html#//apple_ref/doc/uid/TP40008194-CH10-SW1" target="_blank" rel="external">Creating the Remote Notification Payload</a></p>
</blockquote>
<p>1ã€Payload æ¶ˆæ¯å¤§å°</p>
<ul>
<li>For regular remote notifications, the maximum size is 4KB (4096 bytes)</li>
<li>For Voice over Internet Protocol (VoIP) notifications, the maximum size is 5KB (5120 bytes)</li>
<li>If you are using the legacy APNs binary interface to send notifications instead of an HTTP/2 request, the maximum payload size is 2KB (2048 bytes)</li>
</ul>
<p>å½“ Payload è´Ÿè½½å¤§å°è¶…è¿‡è§„å®šçš„è´Ÿè½½å¤§å°æ—¶ï¼ŒAPNs ä¼šæ‹’ç»å‘é€æ­¤æ¶ˆæ¯ã€‚</p>
<p>2ã€Payload æ¶ˆæ¯æ ¼å¼<br><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// ä»¥ä¸‹ä¸º Payload å¸¸ç”¨å­—æ®µï¼Œè¯¦ç»†è¯·å‚è€ƒå®˜æ–¹æ–‡æ¡£</div><div class="line">&#123;</div><div class="line">    <span class="string">"aps"</span> : &#123;</div><div class="line">        <span class="string">"alert"</span>              :   &#123;   // <span class="type">string</span> <span class="keyword">or</span> dictionary</div><div class="line">            <span class="string">"title"</span>          :   "<span class="type">string</span><span class="string">",</span></div><div class="line">            "<span class="keyword">body</span><span class="string">"           :   "</span>string<span class="string">"</span></div><div class="line">        &#125;,</div><div class="line">        "badge<span class="string">"              :    number,</span></div><div class="line">        "sound<span class="string">"              :    "</span>string<span class="string">"</span></div><div class="line">    &#125;,</div><div class="line">    "acme1<span class="string">" : [ "</span>foo<span class="string">",  "</span>bar<span class="string">" ]</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>apsï¼šæ¨é€æ¶ˆæ¯å¿…é¡»æœ‰çš„ key<ul>
<li>alertï¼šæ¨é€æ¶ˆæ¯åŒ…å«æ­¤ key å€¼ï¼Œç³»ç»Ÿå°±ä¼šæ ¹æ®ç”¨æˆ·çš„è®¾ç½®å±•ç¤ºæ ‡å‡†çš„æ¨é€ä¿¡æ¯<ul>
<li>titleï¼šç®€çŸ­æè¿°æ­¤è°ƒæ¨é€æ¶ˆæ¯çš„ç›®çš„</li>
<li>bodyï¼šæ¨é€çš„å†…å®¹</li>
</ul>
</li>
<li>badgeï¼šåœ¨ app å›¾æ ‡ä¸Šæ˜¾ç¤ºæ¶ˆæ¯æ•°é‡ï¼Œç¼ºå°‘æ­¤ key ï¼Œæ¶ˆæ¯æ•°é‡å°±ä¸ä¼šæ”¹å˜ï¼Œæ¶ˆé™¤æ ‡è®°æ—¶æŠŠæ­¤ key å¯¹åº”çš„ value è®¾ç½®ä¸º0</li>
<li>soundï¼šè®¾ç½®æ¨é€å£°éŸ³çš„keyå€¼ï¼Œç³»ç»Ÿé»˜è®¤æç¤ºå£°éŸ³å¯¹åº”çš„ value å€¼ä¸º default</li>
</ul>
</li>
<li>acme: ä»¥ <code>acme</code> ä½œä¸ºå‰ç¼€ï¼Œè¡¨ç¤ºè‡ªå®šä¹‰æ•°æ®</li>
</ul>
<p>ä¾‹å¦‚ï¼š<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="attr">"aps"</span> : &#123;</div><div class="line">        <span class="attr">"alert"</span>: <span class="string">"This is a notification"</span>,</div><div class="line">        <span class="attr">"badge"</span>: <span class="number">1</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"acme-data"</span>: [ <span class="string">"foo"</span>,  <span class="string">"bar"</span> ]</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    <span class="attr">"aps"</span> : &#123;</div><div class="line">        <span class="attr">"alert"</span>: &#123;</div><div class="line">            <span class="attr">"title"</span>: <span class="string">"This is Title"</span>,</div><div class="line">            <span class="attr">"body"</span>: <span class="string">"This is Body"</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">"badge"</span>: <span class="number">1</span></div><div class="line">    &#125;,</div><div class="line">    <span class="attr">"acme-data"</span>: [ <span class="string">"foo"</span>,  <span class="string">"bar"</span> ]</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>3ã€å½“è®¾å¤‡å¤„äºç¦»çº¿ offline çŠ¶æ€æ—¶ï¼ŒAPNs ä¼šä¸ºä¿ç•™ Provider æ‰€æ¨é€çš„æœ€åä¸€æ¡é€šçŸ¥ï¼Œå½“è®¾å¤‡è½¬æ¢ä¸ºè¿ç½‘çŠ¶æ€æ—¶ï¼ŒAPNsåˆ™æŠŠå…¶ä¿ç•™çš„æœ€åä¸€æ¡é€šçŸ¥æ¨é€ç»™æˆ‘ä»¬çš„è®¾å¤‡ï¼›å¦‚æœè®¾å¤‡é•¿æ—¶é—´ç¦»çº¿ï¼Œé‚£ä¹ˆæœ€åä¸€æ¡é€šçŸ¥ä¹Ÿæœ‰å¯èƒ½è¢«ä¸¢å¼ƒã€‚</p>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p><img src="http://7vikhl.com1.z0.glb.clouddn.com/apns-app.png" alt=""></p>
<ul>
<li>â‘  App å‘ç³»ç»Ÿå‘èµ·è¯·æ±‚</li>
<li>â‘¡ ç³»ç»Ÿå‘ APNs å‘é€æ³¨å†Œè¿œç¨‹æ¨é€è¯·æ±‚</li>
<li>â‘¢ APNs ç”Ÿæˆ deviceToken å¹¶è¿”å›</li>
<li>â‘£ App å°† deviceToken å‘é€ç»™æœåŠ¡å™¨ Provider</li>
<li>â‘¤ ä»æ¨é€ç®¡ç†å¹³å°å‘ Provider å‘å‡ºæ¨é€æ¶ˆæ¯æŒ‡ä»¤</li>
<li>â‘¥ Provider æ¨é€æ¶ˆæ¯ç»™ APNs</li>
<li>â‘¦ APNs æ¨é€æ¶ˆæ¯ç»™ App</li>
</ul>
<h2 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h2><p>Cordova é¡¹ç›®è¦é›†æˆè¿œç¨‹æ¨é€åŠŸèƒ½ï¼Œéœ€è¦ç”¨åˆ° <a href="https://github.com/phonegap/phonegap-plugin-push" target="_blank" rel="external">phonegap-plugin-push</a> è¿™ä¸ªæ’ä»¶ï¼Œè¯¥æ’ä»¶æä¾›äº†å¯¹å¤šä¸ªå¹³å°çš„æ¨é€æ”¯æŒï¼Œå½“ç„¶åŒ…æ‹¬ iOS å’Œ Androidï¼Œä¸‹é¢ä»¥ iOS é¡¹ç›®ä¸ºä¾‹ï¼Œè¯¦ç»†ä»‹ç»æ•´ä¸ªå®‰è£…è¿‡ç¨‹ã€‚</p>
<blockquote>
<p>iOS å®‰è£…è¿‡ç¨‹ï¼š<a href="https://github.com/phonegap/phonegap-plugin-push/blob/master/docs/INSTALLATION.md#ios-details" target="_blank" rel="external">å‚è€ƒæ–‡æ¡£</a></p>
</blockquote>
<p>â—ï¸æ³¨æ„ï¼š</p>
<ul>
<li>ä»¥ä¸‹å®‰è£…è¿‡ç¨‹éœ€è¦<strong>ç¿»å¢™</strong></li>
<li>è¯¥æ’ä»¶è¦æ±‚ cordova ç‰ˆæœ¬è‡³å°‘ 6.1.0ï¼Œå¦åˆ™è¦ä¹ˆæ›´æ–° cordova æˆ–è€…ä¸‹è½½æ—¶æŒ‡å®šè¯¥æ’ä»¶ç‰ˆæœ¬å·ï¼š<figure class="highlight avrasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cordova plugin <span class="keyword">add</span> phonegap-plugin-<span class="keyword">push</span><span class="subst">@1</span><span class="number">.8</span><span class="number">.1</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>æ‰§è¡Œå®‰è£…å‘½ä»¤ï¼š<br><figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">âœ  wps-<span class="built_in">writer</span> git:(feature/<span class="keyword">edit</span>) cordova plugin add phonegap-plugin-<span class="keyword">push</span></div><div class="line">Fetching plugin <span class="string">"phonegap-plugin-push@1.10.4"</span> via npm</div><div class="line">Installing <span class="string">"phonegap-plugin-push"</span> <span class="keyword">for</span> browser</div><div class="line">Installing <span class="string">"phonegap-plugin-push"</span> <span class="keyword">for</span> ios</div><div class="line">Failed to install 'phonegap-plugin-<span class="keyword">push</span>':undefined</div><div class="line"><span class="built_in">Error</span>: CocoaPods was <span class="keyword">not</span> found. Please install version <span class="number">1.0</span><span class="number">.1</span> <span class="keyword">or</span> greater from https:<span class="comment">//cocoapods.org/</span></div></pre></td></tr></table></figure></p>
<p>æç¤ºæˆ‘ä»¬è¦å®‰è£… CocoaPodsï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">âœ  wps-writer git:(feature/edit) âœ— sudo gem <span class="keyword">install</span> cocoapods</div><div class="line"><span class="keyword">ERROR</span>:  Could <span class="keyword">not</span> find a valid gem <span class="string">'cocoapods'</span> (&gt;= <span class="number">0</span>), here <span class="keyword">is</span> why:</div><div class="line">          Unable <span class="keyword">to</span> download <span class="keyword">data</span> <span class="keyword">from</span> https://ruby.taobao.org/ - Errno::ECONNRESET: <span class="keyword">Connection</span> <span class="keyword">reset</span> <span class="keyword">by</span> peer - SSL_connect (https://ruby.taobao.org/specs<span class="number">.4</span><span class="number">.8</span>.gz)</div></pre></td></tr></table></figure></p>
<p>æ ¹æ®é”™è¯¯æç¤ºæˆ‘ä»¬çŸ¥é“ï¼Œä»æ·˜å® Ruby çš„è½¯ä»¶æºä¸­æ‰¾ä¸åˆ° cocoapodsï¼Œæˆ‘ä»¬éœ€è¦å¢åŠ  gem æº<br><figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># å¢åŠ /åˆ é™¤ gem æº</span></div><div class="line">gem sources --<span class="keyword">add</span> https:<span class="comment">//rubygems.org/</span></div><div class="line">gem sources --<span class="keyword">remove</span> https:<span class="comment">//rubygems.org/</span></div><div class="line"><span class="meta"># æŸ¥çœ‹ gem æº</span></div><div class="line">gem sources -l</div></pre></td></tr></table></figure></p>
<p>å®‰è£…å®Œ CocoaPods ä¹‹åï¼Œé‡æ–°å®‰è£…æ’ä»¶ï¼š<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">âœ  wps-writer git:(feature/edit) cordova plugin add phonegap-plugin-push</div><div class="line">Fetching plugin <span class="string">"phonegap-plugin-push@1.10.4"</span> via npm</div><div class="line">Installing <span class="string">"phonegap-plugin-push"</span> <span class="keyword">for</span> browser</div><div class="line">Installing <span class="string">"phonegap-plugin-push"</span> <span class="keyword">for</span> ios</div><div class="line">Failed to install <span class="string">'phonegap-plugin-push'</span>:Error: pod: Command failed with exit <span class="selector-tag">code</span> <span class="number">1</span></div><div class="line">    at ChildProcess<span class="selector-class">.whenDone</span> (/Users/YingshanDeng/Documents/WebPS/wps-writer/platforms/ios/cordova/node_modules/cordova-common/src/superspawn<span class="selector-class">.js</span>:<span class="number">169</span>:<span class="number">23</span>)</div><div class="line">    at emitTwo (events<span class="selector-class">.js</span>:<span class="number">100</span>:<span class="number">13</span>)</div><div class="line">    at ChildProcess<span class="selector-class">.emit</span> (events<span class="selector-class">.js</span>:<span class="number">185</span>:<span class="number">7</span>)</div><div class="line">    at maybeClose (internal/child_process<span class="selector-class">.js</span>:<span class="number">827</span>:<span class="number">16</span>)</div><div class="line">    at Process<span class="selector-class">.ChildProcess</span>._handle<span class="selector-class">.onexit</span> (internal/child_process<span class="selector-class">.js</span>:<span class="number">211</span>:<span class="number">5</span>)</div><div class="line">Error: pod: Command failed with exit <span class="selector-tag">code</span> <span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>å®‰è£…æ–‡æ¡£ä¸­ä¹Ÿå¯ä»¥æ‰¾åˆ° <a href="https://github.com/phonegap/phonegap-plugin-push/blob/master/docs/INSTALLATION.md#common-cocoapod-installation-issues" target="_blank" rel="external">è§£å†³è¿™ä¸ªé—®é¢˜</a> çš„ä»‹ç»ï¼š</p>
<ul>
<li>è¿›å…¥ <code>platforms/ios</code> iOS é¡¹ç›®æ ¹ç›®å½•ï¼Œæ‰§è¡Œ <code>pod repo update</code></li>
<li>é‡æ–°å®‰è£…è¯¥æ’ä»¶</li>
</ul>
<p>ä½†æ˜¯æ‰§è¡Œ <code>pod repo update</code> å®åœ¨æ˜¯å¤ªæ…¢äº†ğŸ’©ï¼Œä¸èƒ½å¿ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•è¿›è¡Œè§£å†³ï¼š<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sudo rm -fr ~/.cocoapods/repos/<span class="keyword">master</span></div><div class="line"><span class="title">pod</span> setup</div></pre></td></tr></table></figure></p>
<p>æ‰§è¡Œ <code>pod setup</code> ä¼š Specs æ•´ä¸ªä»“åº“ clone åˆ°æœ¬åœ°ï¼Œè¿™ä¸ªä»“åº“æ˜¯æ˜¯æ‰€æœ‰ Pods çš„ç´¢å¼•ï¼Œå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œæ‰€æœ‰å…¬å¼€çš„ Pods éƒ½åœ¨è¿™é‡Œé¢ã€‚æ•´ä¸ªä¸‹è½½å¤§å°çº¦ 400M æ‰€ä»¥éœ€è¦ç‚¹æ—¶é—´ ğŸ¤£</p>
<p>ä¸‹è½½å®Œæ¯•åï¼Œæˆ‘ä»¬å†è¿›å…¥ iOS é¡¹ç›®ä¸­æ‰§è¡Œ <code>pod repo update</code> å°±å¾ˆå¿«äº†ã€‚ä»¥ä¸Šæ“ä½œéƒ½é¡ºåˆ©å®Œæˆåï¼Œé‡æ–°å®‰è£…è¯¥æ’ä»¶ï¼š<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># å…ˆç§»é™¤åæ·»åŠ </div><div class="line">cordova <span class="keyword">plugin</span> <span class="keyword">rm</span> phonegap-<span class="keyword">plugin</span>-push</div><div class="line">cordova <span class="keyword">plugin</span> add phonegap-<span class="keyword">plugin</span>-push</div></pre></td></tr></table></figure></p>
<p>ä¸å‡ºæ„å¤–å°±å®‰è£…æˆåŠŸäº† âœŒï¸ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹å…¶å®å°±æ˜¯ä¸¤ç‚¹ï¼š</p>
<ul>
<li><code>sudo gem install cocoapods</code></li>
<li><code>pod setup</code></li>
</ul>
<h2 id="ä½¿ç”¨æ’ä»¶"><a href="#ä½¿ç”¨æ’ä»¶" class="headerlink" title="ä½¿ç”¨æ’ä»¶"></a>ä½¿ç”¨æ’ä»¶</h2><blockquote>
<p><a href="https://github.com/phonegap/phonegap-plugin-push/blob/master/docs/API.md#pushnotificationinitoptions" target="_blank" rel="external">API æ–‡æ¡£</a></p>
</blockquote>
<p>æ’ä»¶åœ¨å…¨å±€æ·»åŠ äº†ä¸€ä¸ª PushNotification ç±»ã€‚</p>
<h3 id="PushNotification-init-options"><a href="#PushNotification-init-options" class="headerlink" title="PushNotification.init(options)"></a><code>PushNotification.init(options)</code></h3><p>æ¨é€åˆå§‹åŒ–ï¼Œé€šè¿‡ä¼ å…¥é…ç½®ä¿¡æ¯ï¼ŒåŒ…å«å„ä¸ªå¹³å°ç›¸åº”çš„è®¾ç½®ï¼Œè¿”å› <code>PushNotification</code> å®ä¾‹<br>â—ï¸æ³¨æ„ï¼š</p>
<ul>
<li>å¿…é¡»åœ¨ <code>deviceready</code> äº‹ä»¶å›è°ƒä¸­è°ƒç”¨ <code>PushNotification.init()</code></li>
<li>æ¯ä¸€æ¬¡ App å¯åŠ¨ï¼Œéƒ½éœ€è¦è°ƒç”¨ <code>PushNotification.init()</code>ï¼Œå› ä¸º App å¯¹åº”çš„æ¨é€æœåŠ¡ registration ID å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼ˆå¯¹äº iOS å³æ˜¯ deviceTokenï¼‰</li>
</ul>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"> push = PushNotification.init(&#123;</div><div class="line">    <span class="comment">// android: &#123;</span></div><div class="line">    <span class="comment">// &#125;,</span></div><div class="line">    <span class="comment">// browser: &#123;</span></div><div class="line">    <span class="comment">// &#125;,</span></div><div class="line"><span class="symbol">    ios:</span> &#123;</div><div class="line"><span class="symbol">        alert:</span> <span class="string">"true"</span>, <span class="comment">// å¼¹å‡ºé€šçŸ¥æç¤º</span></div><div class="line"><span class="symbol">        badge:</span> <span class="string">"true"</span>, <span class="comment">// åº”ç”¨å›¾æ ‡å³ä¸Šè§’æ•°å­—æ ‡è®°</span></div><div class="line"><span class="symbol">        sound:</span> <span class="string">"true"</span>, <span class="comment">// é€šçŸ¥æç¤ºéŸ³</span></div><div class="line"><span class="symbol">        clearBadge:</span> <span class="string">"true"</span> <span class="comment">// åº”ç”¨æ‰“å¼€åæ¸…é™¤å›¾æ ‡æ ‡è®°</span></div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="äº‹ä»¶ç›‘å¬-push-on-event-callback"><a href="#äº‹ä»¶ç›‘å¬-push-on-event-callback" class="headerlink" title="äº‹ä»¶ç›‘å¬ push.on(event, callback)"></a>äº‹ä»¶ç›‘å¬ <code>push.on(event, callback)</code></h3><figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// â‘  æ³¨å†Œé€šçŸ¥æˆåŠŸå›è°ƒï¼Œè¿”å›çš„ registrationId</span></div><div class="line"><span class="comment">// å¯¹äº iOSï¼Œå‘ APNs æ³¨å†Œè¿œç¨‹æ¨é€ï¼Œè¿”å›çš„ deviceToken å³ registrationId</span></div><div class="line">push.<span class="keyword">on</span>(<span class="string">'registration'</span>, (<span class="built_in">data</span>) =&gt; &#123;</div><div class="line">    console.<span class="keyword">log</span>(<span class="string">'---registration---'</span>, <span class="built_in">data</span>.registrationId)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// â‘¡ æ¥æ”¶åˆ°è¿œç¨‹æ¨é€æ¶ˆæ¯çš„å›è°ƒ</span></div><div class="line">push.<span class="keyword">on</span>(<span class="string">'notification'</span>, (<span class="built_in">data</span>) =&gt; &#123;</div><div class="line">    <span class="comment">// data.message,</span></div><div class="line">    <span class="comment">// data.title,</span></div><div class="line">    <span class="comment">// data.count,</span></div><div class="line">    <span class="comment">// data.sound,</span></div><div class="line">    <span class="comment">// data.image,</span></div><div class="line">    <span class="comment">// data.additionalData</span></div><div class="line">    console.<span class="keyword">log</span>(<span class="string">'---notification---'</span>, <span class="built_in">data</span>)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// â‘¢ å†…éƒ¨é”™è¯¯å›è°ƒ</span></div><div class="line">push.<span class="keyword">on</span>(<span class="string">'error'</span>, (e) =&gt; &#123;</div><div class="line">    <span class="comment">// e.message</span></div><div class="line">    console.<span class="keyword">log</span>(<span class="string">'---notification error---'</span>, e.message);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="PushNotification-hasPermission"><a href="#PushNotification-hasPermission" class="headerlink" title="PushNotification.hasPermission"></a><code>PushNotification.hasPermission</code></h3><p>æ£€æŸ¥ App æ˜¯å¦æˆæƒå…è®¸æ¨é€é€šçŸ¥<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">checkPermission: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        PushNotification.hasPermission(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">            <span class="comment">// resolve(isEnabled)</span></div><div class="line">            resolve(data.isEnabled);</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="get-setApplicationIconBadgeNumber"><a href="#get-setApplicationIconBadgeNumber" class="headerlink" title="get/setApplicationIconBadgeNumber"></a><code>get/setApplicationIconBadgeNumber</code></h3><p>è·å–/è®¾ç½®åº”ç”¨å›¾æ ‡æ ‡è®°æ•°å­—<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">setIconBadgeNumber(count) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// resolve()</span></div><div class="line">        push.setApplicationIconBadgeNumber(resolve, reject, count);</div><div class="line">    &#125;);</div><div class="line">&#125;,</div><div class="line">getIconBadgeNumber() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// resolve(count)</span></div><div class="line">        push.getApplicationIconBadgeNumber(resolve, reject);</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="badge-è‡ªå¢é—®é¢˜-ğŸ¤–"><a href="#badge-è‡ªå¢é—®é¢˜-ğŸ¤–" class="headerlink" title="badge è‡ªå¢é—®é¢˜ ğŸ¤–"></a>badge è‡ªå¢é—®é¢˜ ğŸ¤–</h3><p>é€šå¸¸æ¥è¯´ï¼Œåº”ç”¨åœ¨æ¥æ”¶åˆ°ä¸€æ¡æ¨é€æ¶ˆæ¯é€šçŸ¥çš„æ—¶å€™ï¼Œå›¾æ ‡æ ‡è®° badge å°±åº”è¯¥åŠ ä¸€ï¼›å½“æ‰“å¼€åº”ç”¨çš„æ—¶å€™ï¼Œbadge æ¸…é›¶ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“é€šè¿‡è®¾ç½® Payload æ¶ˆæ¯ä¸­çš„ <code>badge</code> å­—æ®µï¼Œå¯ä»¥è®¾ç½®åº”ç”¨æ¥æ”¶åˆ°æ¨é€æ¶ˆæ¯æ—¶ï¼Œå›¾æ ‡æ ‡è®°è®¾ç½®çš„æ•°å€¼ï¼ˆ<code>badge</code> å­—æ®µä¸ºé›¶å³ä¸ºæ¸…ç©ºå›¾æ ‡æ ‡è®°æ•°å­—ï¼‰ï¼›è€Œåœ¨ PushNotification æ’ä»¶åˆå§‹åŒ–æ—¶é€šè¿‡é…ç½®ä¼ å…¥ <code>clearBadge</code> å¯ä»¥è®¾ç½®æ‰“å¼€åº”ç”¨æ—¶ï¼Œå›¾æ ‡æ ‡è®°æ¸…é›¶ã€‚</p>
<p>ä½†æ˜¯èƒ½å¦åšåˆ°æ¥æ”¶åˆ°æ¨é€æ¶ˆæ¯æ—¶ï¼Œbadge æ˜¾ç¤ºæ•°å€¼è‡ªå¢ä¸€å‘¢ï¼Ÿå°±ç›®å‰ PushNotification æ’ä»¶æ¥è¯´ï¼Œå¹¶ä¸èƒ½åšåˆ°ã€‚è€Œå¯¹äºå¾®ä¿¡æˆ–è€… QQ è¿™ç±»åº”ç”¨çš„å›¾æ ‡ badge æ•°å€¼æç¤ºçš„æ˜¯æœªè¯»æ¶ˆæ¯æ•°ï¼Œå…¶è®¾ç½®é€»è¾‘åº”è¯¥æ˜¯é€šè¿‡æœåŠ¡ç«¯ç»´æŠ¤çš„ã€‚</p>
<p>å¯¹äºå›¾æ ‡æ ‡è®°çš„è®¾ç½®ï¼Œå‚è€ƒäº†ä¸€äº› App çš„åšæ³•ï¼š</p>
<ul>
<li>è®¾ç½® <code>badge</code> å­—æ®µä¸º 1</li>
<li>ä¸å±•ç¤ºå›¾æ ‡æ ‡è®°ï¼ˆè®¾ç½® <code>badge</code> å­—æ®µä¸º 0 æˆ–è€… PushNotification æ’ä»¶åˆå§‹åŒ–æ˜¯ <code>badge</code> è®¾ç½®ä¸º <code>false</code>ï¼‰</li>
</ul>
<h2 id="æ¨é€è¯ä¹¦"><a href="#æ¨é€è¯ä¹¦" class="headerlink" title="æ¨é€è¯ä¹¦"></a>æ¨é€è¯ä¹¦</h2><p>å…·å¤‡æ¥æ”¶è¿œç¨‹æ¨é€çš„åº”ç”¨æ‰“åŒ…æ—¶éœ€è¦ä½¿ç”¨æ¨é€è¯ä¹¦ï¼ŒåŒæ ·ä¹ŸåŒºåˆ†å¼€å‘è¯ä¹¦å’Œå‘å¸ƒè¯ä¹¦ã€‚</p>
<h3 id="å¯¼å‡ºæ¨é€è¯ä¹¦"><a href="#å¯¼å‡ºæ¨é€è¯ä¹¦" class="headerlink" title="å¯¼å‡ºæ¨é€è¯ä¹¦"></a>å¯¼å‡ºæ¨é€è¯ä¹¦</h3><p>ç™»å½• <a href="https://developer.apple.com" target="_blank" rel="external">è‹¹æœå¼€å‘è€…ä¸­å¿ƒ</a> åœ¨ <code>Certificates, Identifiers &amp; Profiles -&gt; Identifiers -&gt; App IDs</code>ï¼Œæ‰¾åˆ°åº”ç”¨å¯¹åº”çš„ App IDï¼Œç‚¹å‡» <code>Edit</code> å¯¹ Push Notifications è¿›è¡Œé…ç½®å¯¼å‡º certificate è¯ä¹¦ã€‚<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/CreateCertificate.png" alt=""></p>
<p>åŒå‡»å®‰è£…è¯ä¹¦å¦‚ä¸‹ï¼š<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/aps.png" alt=""></p>
<p>åŒæ—¶æˆ‘ä»¬ä¹Ÿéœ€è¦æ›´æ–°ä¸‹è½½ Provisioning Profile æ–‡ä»¶ã€‚</p>
<h3 id="Xcode-çœŸæœºè°ƒè¯•æ¨é€é…ç½®"><a href="#Xcode-çœŸæœºè°ƒè¯•æ¨é€é…ç½®" class="headerlink" title="Xcode çœŸæœºè°ƒè¯•æ¨é€é…ç½®"></a>Xcode çœŸæœºè°ƒè¯•æ¨é€é…ç½®</h3><p>1ã€target -&gt; Capabilities<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/capabilities.jpg" alt=""></p>
<p>2ã€target -&gt; Build Settings -&gt; Signings<br><img src="http://7vikhl.com1.z0.glb.clouddn.com/build-settings.jpg" alt=""></p>
<h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="http://www.jianshu.com/p/4b947569a548" target="_blank" rel="external">iOSæ¨é€ä¹‹è¿œç¨‹æ¨é€ï¼ˆiOS Notification Of Remote Notificationï¼‰</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Push-Notification/" rel="tag">#Push Notification</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/05/22/Unicode-spaces/" rel="next" title="Unicode ä¹‹ç¥å¥‡çš„ç©ºæ ¼">
                <i class="fa fa-chevron-left"></i> Unicode ä¹‹ç¥å¥‡çš„ç©ºæ ¼
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/06/04/The-Difference-Between-URLs-and-URIs/" rel="prev" title="URI, URL, URN çš„åŒºåˆ«">
                URI, URL, URN çš„åŒºåˆ« <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="http://7vikhl.com1.z0.glb.clouddn.com/avatar.jpg"
               alt="å°é‚“" />
          <p class="site-author-name" itemprop="name">å°é‚“</p>
          <p class="site-description motion-element" itemprop="description">Hello World</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">52</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">72</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/yingshandeng" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/objcer" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/u/2249439934" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#APNs"><span class="nav-number">1.</span> <span class="nav-text">APNs</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¨é€åŸç†"><span class="nav-number">1.1.</span> <span class="nav-text">æ¨é€åŸç†</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#deviceToken"><span class="nav-number">1.2.</span> <span class="nav-text">deviceToken</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ¨é€æ¶ˆæ¯-Payload"><span class="nav-number">1.3.</span> <span class="nav-text">æ¨é€æ¶ˆæ¯ Payload</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ€»ç»“"><span class="nav-number">1.4.</span> <span class="nav-text">æ€»ç»“</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®‰è£…æ’ä»¶"><span class="nav-number">2.</span> <span class="nav-text">å®‰è£…æ’ä»¶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä½¿ç”¨æ’ä»¶"><span class="nav-number">3.</span> <span class="nav-text">ä½¿ç”¨æ’ä»¶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#PushNotification-init-options"><span class="nav-number">3.1.</span> <span class="nav-text">PushNotification.init(options)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#äº‹ä»¶ç›‘å¬-push-on-event-callback"><span class="nav-number">3.2.</span> <span class="nav-text">äº‹ä»¶ç›‘å¬ push.on(event, callback)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PushNotification-hasPermission"><span class="nav-number">3.3.</span> <span class="nav-text">PushNotification.hasPermission</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#get-setApplicationIconBadgeNumber"><span class="nav-number">3.4.</span> <span class="nav-text">get/setApplicationIconBadgeNumber</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#badge-è‡ªå¢é—®é¢˜-ğŸ¤–"><span class="nav-number">3.5.</span> <span class="nav-text">badge è‡ªå¢é—®é¢˜ ğŸ¤–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¨é€è¯ä¹¦"><span class="nav-number">4.</span> <span class="nav-text">æ¨é€è¯ä¹¦</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯¼å‡ºæ¨é€è¯ä¹¦"><span class="nav-number">4.1.</span> <span class="nav-text">å¯¼å‡ºæ¨é€è¯ä¹¦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Xcode-çœŸæœºè°ƒè¯•æ¨é€é…ç½®"><span class="nav-number">4.2.</span> <span class="nav-text">Xcode çœŸæœºè°ƒè¯•æ¨é€é…ç½®</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒé“¾æ¥"><span class="nav-number">5.</span> <span class="nav-text">å‚è€ƒé“¾æ¥</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å°é‚“</span>
</div>

<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'objcer';
      var disqus_identifier = '2017/06/04/cordova-register-and-receive-push-notifications-iOS/';
      var disqus_title = "Cordova è¿œç¨‹æ¨é€ - iOSç¯‡";
      var disqus_url = 'http://objcer.com/2017/06/04/cordova-register-and-receive-push-notifications-iOS/';

      function run_disqus_script(disqus_script){
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');
      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      
    </script>
  




  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("UaIz9QT8AVdqAXxUgypgPsTN-gzGzoHsz", "ONQFdHGRNex5wb5Aa64623Dw");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
